import{j as f,b1 as y,eP as w,ae as S,e as I,a as C,cZ as P,bK as _,aJ as v}from"./citrwydz0bgriwlc.js";import{r as m,j as i,C as b}from"./b8ijctzpgh0s7wpx.js";import{m as h}from"./nc6572sivljsjb83.js";import{R}from"./bdclq6pa102whxi1.js";import{C as T}from"./jncxxxf8x7thpqvw.js";import{P as j}from"./pfex3j43xcablmav.js";import{P as M,a as W}from"./cb2t82g498wwhuc2.js";import{c as O}from"./jiivqgraescpsgb3.js";import{u as E,W as F}from"./iq1x6sz8bwtm6i1f.js";import{e as l}from"./omp8ie1vzl40ti1z.js";import"./krbmwir12ubt4od1.js";import"./be0n9593bbjhdouz.js";import"./nvghija6qp2cunds.js";import"./ku4zsoy6w4wkp690.js";import"./k1h56nx2kjoqc52m.js";import"./exvo283q5zxd2q6r.js";import"./jekpe1ukp5thtucq.js";import"./djd85tifm57yisqi.js";import"./gbxx25eoj7wtyna0.js";import"./bzsolvz1ulyrc61b.js";import"./pc2givv05uuq8g6l.js";import"./ju91cj9mp2lx2yuz.js";import"./ndqm17bbs5ambnrw.js";import"./megablgldkh4lap1.js";import"./hbpbckirom363mgh.js";import"./dbalwdodzoo02ru2.js";import"./ji5qoh13hkjncrxd.js";import"./mtbwfu1a5yslb3p2.js";import"./jr954f5murhu609u.js";import"./gaxh4csbc95s5l26.js";import"./e74336rl4x47z2ei.js";import"./h3axfhhn58bmthc9.js";import"./eg629yaevviy8e7x.js";import"./k5qjx4jdow04k7d2.js";import"./o6iizogkfybkxcpa.js";import"./ct6yhczwft8t5t9k.js";import"./etmxhiuvgu79utu0.js";import"./by1c2a5hsj4exnt8.js";import"./l4etgojhnqjuqlgi.js";import"./belvvj76e8q0tm6q.js";import"./eobw6ahe02v4g6se.js";import"./k6ccgr4wxcppeg93.js";import"./me9hhl03j9gxv6g7.js";import"./jkznwfhp8ahnvlot.js";import"./izdon3syh095bs23.js";import"./dweroubxngal4vlb.js";import"./i7jya7stlyvnzya0.js";import"./dcml6fn13vfm1zv2.js";import"./o0ebhsapkoy5qkg1.js";import"./k7nub2yuxq70se07.js";import"./b4v20hsjdnh8a64d.js";import"./h3krx8dg2s8o2yh5.js";import"./cfe0bfy5asp94vp2.js";import"./c2d9eukr2hh7n3q0.js";import"./jy1hvpbwecfrhxw6.js";import"./otl51en3t0ec5n7s.js";import"./eigi8l95ddhoqirr.js";import"./bzpm2hv3f3hhm416.js";import"./oyzab3j7hun2568h.js";import"./dera5bljhpg5ja89.js";import"./hs2fsda156wfk7fz.js";import"./nhujhl3wh6ze4xx0.js";import"./m4qet7ipn6ha09it.js";import"./cjgrwe6bv9n1lytg.js";import"./pc9qsszhmtx9pu7o.js";import"./ndwtlsjk3xm27wkq.js";import"./n3fqqr9zf79bnmr6.js";import"./eeyp7d7oqudhas3m.js";import"./nfkxdwnvdjy1s4sn.js";import"./cwi4lsxreiklxbjv.js";import"./c23qlyb7rng4ydyc.js";import"./jmanj1myc9r62cus.js";import"./eeruhkv4a43aueaw.js";import"./k00srulxk3kjmgxy.js";import"./iki1bxy2syl3zwuv.js";import"./gvs1s366o5iglka3.js";import"./eprrfci9x6sa3hga.js";import"./n0ud0ko19kosxgev.js";import"./lik51q5yy8pdcusl.js";import"./he8ni3xt3ac4tebf.js";import"./n4yg932g6pqv5x7h.js";function G(t){if(t.post.attachments[0].kind!=="codex")return{task:void 0,turns:void 0};const r=t.post.attachments[0];return{task:r.task,fetchedTurns:r.turns,current_user_turn:r.current_user_turn,current_assistant_turn:r.current_assistant_turn,current_diff_task_turn:r.current_diff_task_turn}}function A({postWithProfile:t}){const r=l(d=>d.addTurnToTaskMap),{task:e,fetchedTurns:o,current_user_turn:n,current_assistant_turn:a,current_diff_task_turn:s}=G(t),c=f(),p=y(c,"2818336692"),{focusedAssistantTurn:u,setFocusedAssistantTurnId:x}=E({taskId:e?.id,task:e,currentDiffTaskTurn:s??null,currentUserTurn:n??null,currentAssistantTurn:a??null});m.useEffect(()=>{Object.values(o?.turn_mapping??{}).forEach(d=>{r(e?.id??"",d.turn)})},[o,r,e]);const g=l(({getTurnsForTask:d})=>e?d(e.id):[]);return!e||!g?null:i.jsx(F,{permissions:"read",taskId:e.id,turnId:a?.id??"",task:e,focusedAssistantTurn:u,pastTurns:g,setFocusedAssistantTurnId:x,canFollowUp:!1,lastTurnWithDiffId:s?.id??"",showForkButton:p})}const fe=w(function(){const r=b();return r.kind==="forbidden"?i.jsx(U,{chatPageProps:r.chatPageProps,reason:"workspace"}):i.jsx(z,{loaderData:r})});function z({loaderData:t}){m.useEffect(()=>{I.logEventWithStatsig("Share Post: Shared Post Page Viewed","chatgpt_share_post_page_viewed",{post_id:t.postWithProfile.post.id,primary_attachment_type:t.postWithProfile.post.attachments?.[0]?.kind,referrer:t.referrer})},[t]);const{session:r}=C(),e=m.useMemo(()=>{const o=P();return _.initThread({clientThreadId:o,conversationMode:{kind:v.PrimaryAssistant},userId:r?.user?.id,accountId:r?.account?.id}),o},[r?.account?.id,r?.user?.id]);return t.postWithProfile.post.attachments?.[0]?.kind==="deep_research"&&t.postWithProfile.post.attachments[0].tags?.includes("deep_research")?i.jsx(R,{postWithProfile:t.postWithProfile,threadId:e}):t.postWithProfile.post.attachments?.[0]?.kind==="codex"?i.jsx(A,{postWithProfile:t.postWithProfile}):i.jsx(K,{postWithProfile:t.postWithProfile,chatPageProps:t.chatPageProps})}function k(t){return{url:`https://ogimg.chatgpt.com/?postId=${t}`,size:[1200,630]}}function $(t,r){if(!t.attachments||t.attachments.length===0)return{url:h.src};const e=t.attachments[0];switch(e.kind){case"media_generation":{const o=e.encodings?.md?.path?{url:e.encodings.md.path,size:[e.width,e.height]}:void 0,n=e.encodings?.unfurl?.path?{url:e.encodings.unfurl.path,size:[1200,630]}:void 0,a=e.encodings?.thumbnail?.path?{url:e.encodings.thumbnail.path}:void 0,s={url:e.url,size:[e.width,e.height]};return r&&o!=null?o:n??a??s}case"message_slice":return k(t.id);default:return{url:h.src}}}function L(t){const r=t.text?.trim();if(r)return r;const e=t.attachments?.[0];return e?.kind==="media_generation"&&e.title?.trim()?e.title.trim():"Shared Content"}const Pe=({data:t})=>{const r=t,e={name:"robots",content:"noindex,nofollow"};if(!r||r.kind==="forbidden"){const u="Privately Shared Content";return[{title:`ChatGPT - ${u}`},e,{property:"og:site_name",content:"ChatGPT"},{property:"og:title",content:u},{property:"og:type",content:"website"},{property:"og:image",content:h.src},{name:"twitter:card",content:"summary_large_image"},{name:"twitter:image",content:h.src},{name:"twitter:site",content:"@ChatGPTapp"},{name:"twitter:title",content:u}]}const{post:o}=r.postWithProfile,n=r.enforceRenderedOgImg?k(o.id):$(o,r.preferIntrinsicAspectRatioForOgImage),a=L(o),s=o.permalink,c=new Date(o.posted_at*1e3).toISOString();return[{title:`ChatGPT - ${a}`},e,{property:"og:site_name",content:"ChatGPT"},{property:"og:type",content:"article"},{property:"og:url",content:s},{property:"og:title",content:a},{property:"og:locale",content:"en_US"},{property:"og:image",content:n.url},{property:"og:image:secure_url",content:n.url},...n.size?[{property:"og:image:width",content:n.size[0]},{property:"og:image:height",content:n.size[1]}]:[],{property:"og:image:alt",content:"Preview of shared ChatGPT content"},{property:"article:published_time",content:c},{name:"twitter:card",content:"summary_large_image"},{name:"twitter:site",content:"@ChatGPTapp"},{name:"twitter:title",content:a},{name:"twitter:image",content:n.url},{name:"twitter:image:alt",content:"Preview of shared ChatGPT content"}]};function U({chatPageProps:t,reason:r}){const e=f();return m.useEffect(()=>{S(e,M,{reason:r})},[]),i.jsx(T,{...t})}function K({postWithProfile:t,chatPageProps:r}){const[e,o]=m.useState(!1),[n]=m.useState(()=>P());if(t.post.attachments&&t.post.attachments.every(s=>s.kind==="message_slice"||s.kind==="deep_research")){const s=t.post.attachments?.filter(p=>p.kind==="message_slice"||p.kind==="deep_research").flatMap(p=>p.messages??[])??[],{threadResponse:c}=O(s);_.updateThreadFromServer(n,c,{skipIfExisting:!0,continuingFromSharedPostId:t.post.id,forkFromSharedPost:!0})}return i.jsxs(W.Provider,{value:{postWithProfile:t,setIsReportModalOpen:o},children:[e&&i.jsx(j,{post:t.post,onClose:()=>o(!1)}),i.jsx(T,{...r,clientThreadId:n})]})}export{fe as default,Pe as meta};
//# sourceMappingURL=j0kclbaqnxmbqtid.js.map
