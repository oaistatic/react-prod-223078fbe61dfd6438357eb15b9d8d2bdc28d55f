import{R as T,i as A,u as L,r as n,e as v,j as e,M as m,a5 as U,b as W}from"./b8ijctzpgh0s7wpx.js";import{f as G,af as O,ad as N,ak as q,ab as H,ac as j,B as S,c as K,b as I,j as X,e as D,ae as z}from"./citrwydz0bgriwlc.js";import{en as Q,eo as V,c3 as Y,ep as J,c2 as Z,eq as P,er as $,aK as ee,aX as te,es as se,et as ae,U as re}from"./krbmwir12ubt4od1.js";import{u as ne}from"./dweroubxngal4vlb.js";const oe="https://help.openai.com/en/articles/11481834",ie=({closeModal:t})=>{const[s,p]=T.useState(2500),[r,C]=T.useState(!1),{prepareCheckoutSession:y,navigateToCheckout:b}=Q(),h=G(),{initialBillingDetails:g}=ne(h,!0),k=h?.mustGetSubscriptionBillingCurrency("CreditPurchaseModal")??"USD",c=O(),u=N(),_=A(),{data:R}=L({queryKey:["creditPurchaseRateCard"],queryFn:()=>I.safeGet("/subscriptions/credit-purchase-rate-card"),refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1}),E=n.useCallback(async()=>{if(!r){C(!0);try{const d=h?.id;if(!d)throw new Error("No account_id found");const F=await y({credit_purchase_data:{quantity:s,unit:"credit",account_id:d},billing_details:g},"TeamsDirectWorkspacePurchaseModal",c);await b(F)}catch(d){q.addError(d),u.warning(_.formatMessage(l.paymentErrorWarning),{hasCloseButton:!0})}finally{C(!1)}}},[c,g,_,r,b,s,y,u,h]),B=V(s,300),w=d=>!R||!R[d].price?"N/A":Math.round(B/parseFloat(R[d].price)).toLocaleString();return e.jsxs(H,{isOpen:!0,onClose:()=>t(),type:"success",size:"custom",noPadding:!0,className:"max-w-xl",showCloseButton:!0,testId:"modal-credit-purchase-modal",children:[e.jsx(j.Header,{title:e.jsx(m,{...l.title}),type:"success",withSeparator:!1}),e.jsxs("div",{className:"flex flex-col px-6",children:[e.jsx("div",{className:"text-token-text-secondary text-sm",children:e.jsx(m,{...l.description,values:{link:d=>e.jsx(Y,{href:oe,target:"_blank",children:d})}})}),e.jsx("div",{className:"mt-6",children:e.jsx(ce,{minCredits:500,maxCredits:1e5,increment:250,centsPerCredit:4,currency:k,numCredits:s,setNumCredits:p})}),R&&e.jsxs(U.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-token-bg-tertiary text-token-text-secondary mt-4 flex w-full gap-2 rounded-lg p-3 text-sm",children:[e.jsx(J,{}),e.jsx(m,{...l.amountToAddDescription,values:{deepResearchCount:w("deep_research_completion"),gpto3ChatCount:w("chat_completion_o3"),gpt45ChatCount:w("chat_completion_4_5")}})]})]}),e.jsx(j.Actions,{className:"sm:p-2 md:p-6",secondaryButton:e.jsx(S,{disabled:r,onClick:()=>t(),color:"secondary",children:e.jsx(m,{...l.cancel})}),primaryButton:e.jsx(S,{loading:r,onClick:()=>E(),color:"primary",children:e.jsx(m,{...l.next})})})]})};function ce({numCredits:t,minCredits:a,maxCredits:i,increment:o,centsPerCredit:f,currency:x,setNumCredits:s}){const p=n.useRef(null);n.useEffect(()=>{p.current?.focus()},[p]);const r=n.useRef(null),C=n.useRef(0),y=n.useCallback(c=>{s(u=>Z(u+c,a,i))},[i,a,s]),b=n.useCallback(c=>{const E=300-c*50;return E>25?E:25},[]),h=n.useCallback(c=>{y(c),C.current=0;const u=()=>{C.current+=1,y(c);const _=b(C.current);r.current=setTimeout(u,_)};r.current=setTimeout(u,b(C.current))},[y,b]),g=n.useCallback(()=>{r.current&&(clearTimeout(r.current),r.current=null)},[]),k=t*f/100;return e.jsxs("div",{className:"mb-3 flex w-full flex-col",children:[e.jsx("label",{className:"mb-1 flex text-base font-medium",htmlFor:"Credits",children:e.jsx(m,{...l.amountToAdd})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative w-full",children:[e.jsx("span",{className:"text-token-text-secondary pointer-events-none absolute end-3 top-1/2 -translate-y-1/2 text-sm",children:e.jsx(m,{...l.numCredits,values:{numCredits:t}})}),e.jsx("input",{ref:p,name:"Credits",value:k.toLocaleString("en-US",{style:"currency",currency:x,maximumFractionDigits:2}),disabled:!0,autoFocus:!0,tabIndex:0,className:"bg-token-bg-primary text-token-text-primary m-0 h-12 w-full appearance-none rounded-lg border border-gray-200 px-2 py-0 ps-5 text-start text-sm shadow-none ring-transparent outline-hidden focus:border-black focus:ring-black dark:border-gray-700 dark:focus:border-white dark:focus:ring-white"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(P,{disabled:t<=a,onMouseDown:()=>h(-o),onMouseUp:g,onMouseLeave:g,children:e.jsx($,{className:K("icon-md-heavy",t<=a&&"text-token-text-tertiary")})}),e.jsx(P,{disabled:t>=i,onMouseDown:()=>h(o),onMouseUp:g,onMouseLeave:g,children:e.jsx(ee,{className:"icon-md-heavy"})})]})]})]})}const l=v({title:{id:"components.business.CreditPurchaseModal.title",defaultMessage:"Buy more credits for your team"},description:{id:"components.business.CreditPurchaseModal.description",defaultMessage:"Give your team continued access to advanced features after hitting plan limits. Credits valid for 12 months. Advanced voice mode excluded. <link>View rate card</link>."},amountToAdd:{id:"components.business.CreditPurchaseModal.amountToAdd",defaultMessage:"Amount to add"},amountToAddDescription:{id:"components.business.CreditPurchaseModal.amountToAddDescription",defaultMessage:"Equal to {deepResearchCount} deep research tasks, {gpto3ChatCount} o3 messages, or {gpt45ChatCount} GPT-4.5 messages."},numCredits:{id:"components.business.CreditPurchaseModal.numCredits",defaultMessage:"{numCredits, plural, one {# credit} other {# credits}}"},paymentErrorWarning:{id:"components.business.CreditPurchaseModal.paymentErrorWarning",defaultMessage:"The payments page encountered an error. Please try again. If the problem continues, please visit help.openai.com."},cancel:{id:"components.business.CreditPurchaseModal.cancel",defaultMessage:"Cancel"},next:{id:"components.business.CreditPurchaseModal.next",defaultMessage:"Next"}}),Ce=t=>{switch(t){case"wham":return"wham";case"deep_research":return"deep_research";case"image_gen":return"image_gen";case"gpt-4-5":return"gpt-4-5";default:return null}},de=()=>{const t=N(),a=A(),[i,o]=n.useState(se()),{mutate:f,isPending:x}=W({mutationFn:s=>I.safePost("/credits/pleas",{requestBody:{product:s}}),onError:s=>{q.addError(new Error("Error occurred while submitting credit plea request",{cause:s})),t.danger(a.formatMessage(M.errorRequestCredits))},onSuccess:()=>{o(!0),t.success(a.formatMessage(M.successRequestCredits)),ae(),re.setThreadModelPickerAlertDot(!1)}});return{submitCreditPleaRequest:f,isComplete:i,isPending:x}},he=({trigger:t,...a})=>{const i=X();n.useEffect(()=>{D.logEventWithStatsig("ChatGPT Credits: Add Credits Button Shown","chatgpt_credits_add_credits_button_shown",{trigger:t})},[t]);const o=()=>{D.logEventWithStatsig("ChatGPT Credits: Add Credits Clicked","chatgpt_credits_add_credits_clicked"),z(i,ie)};return e.jsx(S,{color:"primary",onClick:o,...a,children:e.jsx(m,{...M.addCredits})})},ge=({creditConsumingProduct:t,trigger:a,...i})=>{const o=A(),{submitCreditPleaRequest:f,isPending:x,isComplete:s}=de();n.useEffect(()=>{D.logEventWithStatsig("ChatGPT Credits: Notify Admin Button Shown","chatgpt_credits_notify_admin_button_shown",{trigger:a,creditConsumingProduct:t})},[t,a]);const p=()=>{s||(f(t),D.logEventWithStatsig("ChatGPT Credits: Notify Admin Clicked","chatgpt_credits_notify_admin_clicked"))},r=e.jsx(S,{loading:x,color:s?"secondary":"primary",disabled:s,onClick:p,...i,children:s?o.formatMessage(M.requested):o.formatMessage(M.notifyAdmin)});return s?e.jsx(te,{className:"w-auto whitespace-nowrap",withArrow:!0,labelTextAlign:"left",contentClassName:"w-[180px]",side:"right",label:o.formatMessage(M.alreadyRequested),children:r}):r},M=v({notifyAdmin:{id:"prompt-textarea.teamsCreditRequestBanner.notifyAdmin",defaultMessage:"Notify admin"},addCredits:{id:"prompt-textarea.teamsCreditRequestBanner.addCredits",defaultMessage:"Add credits"},requested:{id:"prompt-textarea.teamsCreditRequestBanner.requested",defaultMessage:"Requested"},errorRequestCredits:{id:"prompt-textarea.teamsCreditRequestBanner.error",defaultMessage:"Error occurred while submitting credit request"},successRequestCredits:{id:"prompt-textarea.teamsCreditRequestBanner.success",defaultMessage:"Request sent to your admin"},alreadyRequested:{id:"prompt-textarea.teamsCreditRequestBanner.alreadyRequested",defaultMessage:"Youâ€™ve already notified your admin"}});export{he as A,ge as C,ie as a,Ce as g};
//# sourceMappingURL=i7jya7stlyvnzya0.js.map
