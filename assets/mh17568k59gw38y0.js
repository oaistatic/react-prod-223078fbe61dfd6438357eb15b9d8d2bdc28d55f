import{r as p,j as f,i as T}from"./b8ijctzpgh0s7wpx.js";import{bS as d,s as g,N as l,l as M,ch as C}from"./citrwydz0bgriwlc.js";import{CoTChunks as x}from"./d21oqy6xqa35jhn3.js";import{C as u}from"./cn5tk4t34ulr2va8.js";import"./k5qjx4jdow04k7d2.js";import"./krbmwir12ubt4od1.js";import"./e1z6gbtwznbmtc6u.js";import"./h3axfhhn58bmthc9.js";import"./ku4zsoy6w4wkp690.js";import"./k1h56nx2kjoqc52m.js";import"./exvo283q5zxd2q6r.js";import"./jekpe1ukp5thtucq.js";import"./eg629yaevviy8e7x.js";import"./bdclq6pa102whxi1.js";import"./be0n9593bbjhdouz.js";import"./nvghija6qp2cunds.js";import"./djd85tifm57yisqi.js";import"./gbxx25eoj7wtyna0.js";import"./bzsolvz1ulyrc61b.js";import"./pc2givv05uuq8g6l.js";import"./ju91cj9mp2lx2yuz.js";import"./ndqm17bbs5ambnrw.js";import"./megablgldkh4lap1.js";import"./hbpbckirom363mgh.js";import"./dbalwdodzoo02ru2.js";import"./omp8ie1vzl40ti1z.js";import"./ji5qoh13hkjncrxd.js";import"./mtbwfu1a5yslb3p2.js";import"./jr954f5murhu609u.js";import"./gaxh4csbc95s5l26.js";import"./e74336rl4x47z2ei.js";import"./o6iizogkfybkxcpa.js";import"./ct6yhczwft8t5t9k.js";import"./etmxhiuvgu79utu0.js";import"./by1c2a5hsj4exnt8.js";import"./l4etgojhnqjuqlgi.js";import"./belvvj76e8q0tm6q.js";import"./eobw6ahe02v4g6se.js";const _=(e,t)=>{if(t<=1)return e.formatMessage({id:"ZxhUq1",defaultMessage:"a second"});if(t<3)return e.formatMessage({id:"4GD7tD",defaultMessage:"a couple of seconds"});if(t<4)return e.formatMessage({id:"jx5V1u",defaultMessage:"a few seconds"});if(t>=60){const n=Math.floor(t/60),s=t%60;return`${n}m ${s}s`}return e.formatMessage({id:"p4/pTg",defaultMessage:"{seconds} seconds"},{seconds:t})},k=e=>{let t=0;for(const n of e)t+=n.metadata?.finished_duration_sec??0;return t},y=(e,t,n)=>t.length>1?e.formatMessage({id:"sdDgmZ",defaultMessage:"Thought for {timing}"},{timing:_(e,n)}):d(t)?.metadata?.finished_text??"",E=(e,t,n=!1)=>{const s=[];let o={type:u.Thought,thought:{summary:"",content:""}};const c=()=>{o.thought.content.trim()&&(s.push(o),o={type:u.Thought,thought:{summary:o.thought.summary,content:""}})},m=e.split(/( {2}\n)|(\n\n)/).filter(i=>i!=null&&i.trim());if(!n&&m.length<2)return s;let a=!1;for(let i=0;i<m.length;i++){const r=m[i].trim();if(r.toLowerCase()==="none"){g.count(l.COT_SUMMARIZER,"num_none_chunks");continue}const h=r.match(/^\*\*(.*)\*\*$/);if(h)c(),o.thought.summary=h[1]??"";else if(r){if(r.startsWith("```")){if(a){o.thought.content+=o.thought.content?`
${r}`:r,c(),a=!1;continue}c(),a=!0}o.thought.content.trim()&&!r.startsWith("\\[")&&!r.startsWith("\\(")&&!a&&c(),o.thought.content+=o.thought.content?`
${r}`:r}}return o?.thought.content.trim()&&s.push(o),n&&t&&s.push({type:u.Recap,content:t}),s},R=(e,t,n)=>{const s=!n,o=p.useMemo(()=>E(e,t,s),[e,t,s]);return p.useEffect(()=>{s&&g.hist(l.COT_SUMMARIZER,"num_cot_chunks",void 0,o.length)},[s]),o},I=({isStreaming:e,finishedText:t,summaryText:n,isFinalTurn:s})=>{const o=R(n,t,e);return f.jsx(x,{isStreaming:e,isFinalTurn:s,chunks:o})},N=8,S=`

`,gt=({messages:e,isStreaming:t,isFinalTurn:n})=>{const s=T(),{value:o}=M("1214379119"),c=k(e);let m="";return e.forEach(a=>{const i=C(a);m+=m?S+i:i}),o&&!t&&!m&&c<N?null:f.jsx(I,{finishedText:y(s,e,c),summaryText:m,isStreaming:t,isFinalTurn:n})};export{I as LegacyCoT,gt as LegacyCoTMessage};
//# sourceMappingURL=mh17568k59gw38y0.js.map
