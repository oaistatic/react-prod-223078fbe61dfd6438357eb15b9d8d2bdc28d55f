import{l as P,F as C,c as f,O as q,c7 as j,a7 as Y,dp as K,gR as Q,ab as X,B as R,eP as ee,aq as te,fH as se}from"./citrwydz0bgriwlc.js";import{r as x,j as e,i as B,M as c,ac as F,a6 as ae,f as L,a5 as H,u as ne,D as ie}from"./b8ijctzpgh0s7wpx.js";import{N as oe}from"./jy1u8exw8iz2slve.js";import{aX as k,l4 as re,l5 as le,X as de,l6 as ce,l7 as ue,l8 as A,gA as me,dr as xe,l9 as p,la as h,lb as I,lc as ge,ih as fe,ld as Ce,le as pe,f8 as he,r as je,e7 as ye}from"./krbmwir12ubt4od1.js";import{G as ve}from"./dcml6fn13vfm1zv2.js";import{G as be}from"./ga473l12pn4idd7t.js";const we=a=>x.createElement("svg",{width:20,height:20,viewBox:"0 0 20 20",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...a},x.createElement("path",{d:"M8.50195 17.5V16.498H6.5C5.81091 16.498 5.25395 16.4987 4.80371 16.4619C4.40303 16.4292 4.04237 16.364 3.70606 16.2197L3.56348 16.1533C3.04236 15.8878 2.60586 15.4841 2.30176 14.9883L2.17969 14.7705C1.98772 14.3937 1.90851 13.9873 1.87109 13.5293C1.83432 13.0791 1.83496 12.522 1.83496 11.833V8.16699C1.83496 7.478 1.83432 6.92091 1.87109 6.4707C1.90851 6.0127 1.98772 5.60625 2.17969 5.22949L2.30176 5.01172C2.60586 4.5159 3.04236 4.1122 3.56348 3.84668L3.70606 3.78027C4.04237 3.636 4.40303 3.57083 4.80371 3.53809C5.25395 3.5013 5.81091 3.50195 6.5 3.50195H8.50195V2.5C8.50195 2.13273 8.79972 1.83496 9.16699 1.83496C9.53411 1.83514 9.83203 2.13284 9.83203 2.5V17.5C9.83203 17.8672 9.53411 18.1649 9.16699 18.165C8.79972 18.165 8.50195 17.8673 8.50195 17.5ZM16.835 11.833V8.16699C16.835 7.4561 16.8341 6.96259 16.8027 6.5791C16.7797 6.29739 16.7428 6.1076 16.6914 5.96387L16.6348 5.83398C16.4808 5.53176 16.2466 5.27886 15.959 5.10254L15.833 5.03125C15.675 4.9508 15.4635 4.89397 15.0879 4.86328C14.7044 4.83195 14.211 4.83203 13.5 4.83203H12.5C12.1328 4.83203 11.8351 4.53411 11.835 4.16699C11.835 3.79972 12.1327 3.50195 12.5 3.50195H13.5C14.1891 3.50195 14.746 3.5013 15.1963 3.53809C15.6541 3.5755 16.0599 3.65483 16.4365 3.84668L16.6553 3.96875C17.1509 4.27282 17.5549 4.70856 17.8203 5.22949L17.8867 5.37207C18.0311 5.70855 18.0961 6.06979 18.1289 6.4707C18.1657 6.92091 18.165 7.478 18.165 8.16699V11.833C18.165 12.522 18.1657 13.0791 18.1289 13.5293C18.0961 13.9302 18.0311 14.2914 17.8867 14.6279L17.8203 14.7705C17.5549 15.2914 17.1509 15.7272 16.6553 16.0312L16.4365 16.1533C16.0599 16.3452 15.6541 16.4245 15.1963 16.4619C14.746 16.4987 14.1891 16.498 13.5 16.498H12.5C12.1327 16.498 11.835 16.2003 11.835 15.833C11.8351 15.4659 12.1328 15.168 12.5 15.168H13.5C14.211 15.168 14.7044 15.1681 15.0879 15.1367C15.4635 15.106 15.675 15.0492 15.833 14.9688L15.959 14.8975C16.2466 14.7211 16.4808 14.4682 16.6348 14.166L16.6914 14.0361C16.7428 13.8924 16.7797 13.7026 16.8027 13.4209C16.8341 13.0374 16.835 12.5439 16.835 11.833Z"})),ze=a=>x.createElement("svg",{width:20,height:20,viewBox:"0 0 20 20",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...a},x.createElement("path",{d:"M8.50195 17.5V16.498H6.5C5.81091 16.498 5.25395 16.4987 4.80371 16.4619C4.40303 16.4292 4.04237 16.364 3.70606 16.2197L3.56348 16.1533C3.04236 15.8878 2.60586 15.4841 2.30176 14.9883L2.17969 14.7705C1.98772 14.3937 1.90851 13.9873 1.87109 13.5293C1.83432 13.0791 1.83496 12.522 1.83496 11.833V8.16699C1.83496 7.478 1.83432 6.92091 1.87109 6.4707C1.90851 6.0127 1.98772 5.60625 2.17969 5.22949L2.30176 5.01172C2.60586 4.5159 3.04236 4.1122 3.56348 3.84668L3.70606 3.78027C4.04237 3.636 4.40303 3.57083 4.80371 3.53809C5.25395 3.5013 5.81091 3.50195 6.5 3.50195H8.50195V2.5C8.50195 2.13273 8.79972 1.83496 9.16699 1.83496C9.53411 1.83514 9.83203 2.13284 9.83203 2.5V17.5C9.83203 17.8672 9.53411 18.1649 9.16699 18.165C8.79972 18.165 8.50195 17.8673 8.50195 17.5ZM16.835 11.833V8.16699C16.835 7.4561 16.8341 6.96259 16.8027 6.5791C16.7797 6.29739 16.7428 6.1076 16.6914 5.96387L16.6348 5.83398C16.4808 5.53176 16.2466 5.27886 15.959 5.10254L15.833 5.03125C15.675 4.9508 15.4635 4.89397 15.0879 4.86328C14.7044 4.83195 14.211 4.83203 13.5 4.83203H12.5C12.1328 4.83203 11.8351 4.53411 11.835 4.16699C11.835 3.79972 12.1327 3.50195 12.5 3.50195H13.5C14.1891 3.50195 14.746 3.5013 15.1963 3.53809C15.6541 3.5755 16.0599 3.65483 16.4365 3.84668L16.6553 3.96875C17.1509 4.27282 17.5549 4.70856 17.8203 5.22949L17.8867 5.37207C18.0311 5.70855 18.0961 6.06979 18.1289 6.4707C18.1657 6.92091 18.165 7.478 18.165 8.16699V11.833C18.165 12.522 18.1657 13.0791 18.1289 13.5293C18.0961 13.9302 18.0311 14.2914 17.8867 14.6279L17.8203 14.7705C17.5549 15.2914 17.1509 15.7272 16.6553 16.0312L16.4365 16.1533C16.0599 16.3452 15.6541 16.4245 15.1963 16.4619C14.746 16.4987 14.1891 16.498 13.5 16.498H12.5C12.1327 16.498 11.835 16.2003 11.835 15.833C11.8351 15.4659 12.1328 15.168 12.5 15.168H13.5C14.211 15.168 14.7044 15.1681 15.0879 15.1367C15.4635 15.106 15.675 15.0492 15.833 14.9688L15.959 14.8975C16.2466 14.7211 16.4808 14.4682 16.6348 14.166L16.6914 14.0361C16.7428 13.8924 16.7797 13.7026 16.8027 13.4209C16.8341 13.0374 16.835 12.5439 16.835 11.833ZM3.16504 11.833C3.16504 12.5439 3.16595 13.0374 3.19727 13.4209C3.22795 13.7965 3.28478 14.008 3.36524 14.166L3.43555 14.293C3.61186 14.5804 3.86488 14.8148 4.16699 14.9688L4.29688 15.0244C4.44065 15.0759 4.63016 15.1137 4.91211 15.1367C5.29563 15.1681 5.78896 15.168 6.5 15.168H8.50195V4.83203H6.5C5.78896 4.83203 5.29563 4.83195 4.91211 4.86328C4.63016 4.88632 4.44065 4.92413 4.29688 4.97559L4.16699 5.03125C3.86488 5.18518 3.61186 5.41959 3.43555 5.70703L3.36524 5.83398C3.28478 5.99198 3.22795 6.20352 3.19727 6.5791C3.16595 6.96259 3.16504 7.4561 3.16504 8.16699V11.833Z"})),Le=x.memo(function({onSelectVersion:t,selectedVersion:s,currentVersion:o,gizmoVersions:i}){const{value:n}=P("3645668434");return n?e.jsx(Ne,{selectedVersion:s,onSelectVersion:t,currentVersion:o,gizmoVersions:i}):null}),_e=C.div`flex h-full w-full max-w-3xs flex-col overflow-y-scroll bg-token-sidebar-surface-primary px-2 py-6`;function Ne({onSelectVersion:a,selectedVersion:t,currentVersion:s,gizmoVersions:o}){const i=o?.items.reduce((n,l)=>{const d=new Date(l.updated_at),m=`${d.getFullYear()}-${d.getMonth()+1}-${d.getDate()}`;return n[m]||(n[m]=[]),n[m].push(l),n},{});return i?e.jsx(_e,{children:Object.keys(i).map((n,l)=>e.jsx(ke,{date:n,entries:i[n],selectedVersion:t,onSelectVersion:a,currentVersion:s},l))}):null}const T=({name:a,userId:t,showName:s=!1})=>e.jsxs("div",{className:"flex items-center gap-1.5",children:[s&&e.jsx(k,{delayDuration:2e3,label:a,className:"text-token-text-secondary max-w-[100px] truncate text-xs",children:a}),e.jsx("div",{className:f("icon flex items-center justify-center rounded-full text-[8px] text-white",le(t)),children:re(a)})]}),Me=C.div`flex w-full flex-col rounded-lg px-3 py-2 text-base hover:cursor-pointer hover:bg-token-sidebar-surface-tertiary`,Ie=C.div`px-3 text-xs font-medium text-token-text-secondary`,Se=C.div`flex flex-col space-y-1`,Ve=C.div`mb-8 flex flex-col space-y-2`;function U(a,t){const s=new Date(t),o=new Date,i=new Date(o);i.setDate(o.getDate()-1);const n=a.locale||"en-US";return s.toDateString()===o.toDateString()?"Today":s.toDateString()===i.toDateString()?"Yesterday":new Intl.DateTimeFormat(n,{dateStyle:"medium"}).format(s)}const ke=({date:a,entries:t,onSelectVersion:s,selectedVersion:o,currentVersion:i})=>{const n=B(),l=d=>d===i;return e.jsxs(Ve,{children:[e.jsx(Ie,{children:U(n,a)}),e.jsx(Se,{children:t.map((d,m)=>e.jsx(Ae,{item:d,isCurrentVersion:l,selectedVersion:o,onSelectVersion:s},m))})]})},Ae=({item:a,isCurrentVersion:t,selectedVersion:s,onSelectVersion:o})=>{const[i,n]=x.useState(!1),{version:l,updated_at:d,author:m}=a;return e.jsx(Me,{className:f(s===l&&"bg-token-sidebar-surface-tertiary"),onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1),onClick:()=>o(l),children:e.jsxs("div",{className:"flex w-full items-center justify-between",children:[e.jsx("div",{className:"text-base",children:t(l)?e.jsx(c,{id:"gizmo.version.current",defaultMessage:"Current version"}):e.jsx(F,{value:d,timeStyle:"short"})}),e.jsx(ae,{children:!t(l)&&m&&e.jsx(T,{showName:s===l||i,name:m.user_name,userId:m.user_id})})]})})},De=({gizmoId:a,version:t,skip:s=!1})=>ne({queryFn:async()=>he.getVersion({gizmoId:a,version:t}),queryKey:["gizmo","version",{gizmoId:a,version:t}],enabled:!s}),O=(a,t)=>`/gpts/editor/${a}?version=${t}`,G=C.div`flex h-screen w-full flex-col items-center`,$=C.div`flex w-full grow overflow-hidden`,J=C.div`flex h-full grow flex-wrap items-start justify-between gap-4 overflow-auto`,W=C.div`sticky top-0 flex h-16 w-full items-center justify-between gap-2 border-b border-token-border-medium bg-token-main-surface-primary px-3 py-3`;function Ee({gizmoId:a}){const{data:t,isLoading:s,refetch:o}=de(a),i=t?.gizmo?.current_user_permission,n=i?.can_write??!1,l=i?.can_view_config??!1;return!t||s?null:n?e.jsx(He,{gizmoResource:t,refetchGizmo:o}):l?e.jsx(Re,{gizmoResource:t}):null}const Z=({children:a})=>{const t=L();return e.jsxs("div",{className:"flex cursor-pointer items-center gap-1.5",onClick:()=>t(-1),children:[e.jsx(xe,{className:"icon"}),e.jsx("div",{children:a})]})},Re=({gizmoResource:a})=>{const t=L(),s=ue(),o=a.gizmo.id,i=async()=>{const n=await s.mutateAsync({gizmoId:o});n.gizmo.id&&t(`/gpts/editor/${n.gizmo.id}`)};return e.jsxs(G,{children:[e.jsxs(W,{children:[e.jsx(Z,{children:e.jsx(c,{id:"gizmoReadOnly.configurationTitle",defaultMessage:"Configuration"})}),e.jsx("div",{className:"me-4 flex gap-2",children:e.jsx(A,{color:"secondary",loading:s.isPending,onClick:i,children:e.jsx(c,{id:"gizmo.readonly.duplicate",defaultMessage:"Duplicate"})})})]}),e.jsx($,{children:e.jsx(J,{children:e.jsx(D,{displayGizmo:a})})})]})},He=({gizmoResource:a,refetchGizmo:t})=>{const s=a.gizmo.id,{data:o,refetch:i}=ce({gizmoId:s});x.useEffect(()=>{t(),i()},[t,i]);const n=a?.gizmo.live_version;return n==null||!o?null:e.jsx(Oe,{gizmoResource:a,currentVersion:n,gizmoVersions:o})};function Oe({gizmoResource:a,currentVersion:t,gizmoVersions:s}){const o=L(),i=a.gizmo.id,[n,l]=x.useState(t),[d,m]=x.useState(!1),[u,b]=x.useState(!1),w=()=>{o(n?O(i,n):Ce(i))},z=()=>{if(n!==t&&a.tools.find(v=>v.type===j.JIT_PLUGIN&&v.metadata.auth?.type!==Q.None)){b(!0);return}o(O(i,n))},_=()=>{n===t&&t>1&&l(t-1),d&&l(t),m(!d)},y=t>1;x.useEffect(()=>{n===t&&m(!1)},[n,t]);const{data:r,isLoading:g}=De({gizmoId:i,version:n});return e.jsxs(G,{children:[e.jsxs(W,{children:[e.jsx(Z,{children:e.jsx(c,{id:"gizmoReadOnly.versionHistoryTitle",defaultMessage:"Version History"})}),e.jsxs("div",{className:"me-4 flex gap-2",children:[y&&e.jsx(k,{label:e.jsx(c,{id:"gizmo.readonly.compareTooltip",defaultMessage:"Compare to the previous version"}),disabled:!y||d,triggerAs:null,children:e.jsx(A,{color:d?"primary":"secondary",className:f("btn rounded-full border transition-colors",d?f(oe,"border-transparent"):"border-token-border-default hover:bg-token-surface-hover bg-transparent"),onClick:_,icon:d?we:ze,children:d?e.jsx(c,{id:"gizmo.readonly.comparing",defaultMessage:"Comparing changes"}):e.jsx(c,{id:"gizmo.readonly.compare",defaultMessage:"Compare changes"})})}),e.jsx(k,{label:e.jsx(c,{id:"gizmo.readonly.restoreVersionTooltip",defaultMessage:"You will be able to edit before publishing"}),disabled:n===t,triggerAs:null,children:e.jsx(A,{color:"secondary",disabled:n===t,icon:me,onClick:z,children:e.jsx(c,{id:"gizmo.readonly.restoreVersion",defaultMessage:"Restore this version"})})})]})]}),e.jsxs($,{children:[e.jsx(Le,{selectedVersion:n,currentVersion:t,onSelectVersion:l,gizmoVersions:s}),g&&e.jsx("div",{className:"flex h-full w-full grow flex-col items-center justify-center",children:e.jsx(q,{})}),r&&e.jsxs(J,{children:[e.jsx(D,{displayGizmo:r,isComparing:d,gizmoVersions:s}),d&&e.jsx(D,{displayGizmo:a,compareToGizmo:r,setIsComparing:m,isComparing:!0,gizmoVersions:s})]})]}),u&&e.jsx(Fe,{onClose:()=>b(!1),onContinue:w})]})}const S=(a,t=[],s=[],o)=>a?[...s,...t.filter(o)]:t,V=(a,t)=>f(a&&t?"bg-blue-400/10":"bg-token-main-surface-secondary");function D({isComparing:a,displayGizmo:t,compareToGizmo:s,setIsComparing:o,gizmoVersions:i}){const n=B(),l=t.gizmo.display.name!==s?.gizmo.display.name,d=t.gizmo.display.description!==s?.gizmo.display.description,m=t.gizmo.instructions!==s?.gizmo.instructions,u=a&&!!s,b=S(u,t.gizmo.display.prompt_starters??[],s?.gizmo.display.prompt_starters??[],r=>!s?.gizmo.display.prompt_starters?.includes(r)),w=S(u,t.files??[],s?.files??[],r=>!s?.files?.find(g=>g.id===r.id)),z=S(u,t.tools?.filter(r=>r.type===j.JIT_PLUGIN)??[],s?.tools?.filter(r=>r.type===j.JIT_PLUGIN)??[],r=>r.type===j.JIT_PLUGIN&&!s?.tools.find(g=>g.type===j.JIT_PLUGIN&&g.metadata.action_id===r.metadata.action_id)),_=t.gizmo.display.profile_picture_url!==s?.gizmo.display.profile_picture_url,y=i?.items.find(r=>r.version===t.gizmo.version)?.author;return e.jsx(H.div,{initial:{opacity:0,x:10},animate:{opacity:1,x:0},exit:{opacity:0,x:10},transition:{duration:.2},className:f("relative flex min-w-0 flex-1 grow justify-center overflow-auto",u&&"border-s"),children:e.jsxs("div",{className:"flex w-full max-w-2xl flex-col px-4 py-8 text-sm",children:[e.jsxs(H.div,{initial:{opacity:0},animate:{opacity:a?1:0},transition:{duration:a?.2:0},className:"mb-4 flex w-full items-center justify-between",children:[e.jsx("div",{className:"text-token-text-tertiary text-base",children:s?e.jsx(c,{id:"gizmo.readonly.currentVersion",defaultMessage:"Current"}):e.jsx(c,{id:"gizmo.readonly.previous",defaultMessage:"Previous"})}),e.jsxs("div",{className:"flex items-center gap-2",children:[t.gizmo.version_updated_at&&e.jsx("div",{className:"text-token-text-tertiary text-xs",children:e.jsx(c,{id:"gizmo.readonly.updatedAt",defaultMessage:"{date} at {time}",values:{date:U(n,t.gizmo.version_updated_at),time:e.jsx(F,{value:new Date(t.gizmo.version_updated_at),hour:"numeric",minute:"numeric"})}})}),y&&e.jsx(T,{name:y.user_name,userId:y.user_id}),s&&o&&e.jsx(Y,{onClick:()=>o(!1)})]})]}),e.jsx(p,{className:"self-center",children:e.jsx(ve,{src:t.gizmo.display.profile_picture_url,isFirstParty:!1,className:f("h-20 w-20",_&&s&&"border-opacity-10 rounded-full border-4 border-blue-400"),showLoading:!0})}),e.jsxs(p,{children:[e.jsx(h,{label:e.jsx(c,{id:"gizmo.readonly.nameLabel",defaultMessage:"Name"})}),e.jsx(I,{type:"text",value:t.gizmo.display.name??"",disabled:!0,className:V(u,l)})]}),e.jsxs(p,{children:[e.jsx(h,{label:e.jsx(c,{id:"gizmo.readonly.descriptionLabel",defaultMessage:"Description"})}),e.jsx(I,{type:"text",value:t.gizmo.display.description??"",disabled:!0,className:V(u,d)})]}),e.jsxs(p,{children:[e.jsx(h,{label:e.jsx(c,{id:"gizmo.readonly.instructionsLabel",defaultMessage:"Instructions"})}),e.jsx(ge,{rows:8,value:t.gizmo.instructions??"",disabled:!0,className:f("resize-none",V(u,m))})]}),b.length>0&&e.jsxs(p,{children:[e.jsx(h,{label:e.jsx(c,{id:"gizmo.readonly.conversationStartersLabel",defaultMessage:"Conversation starters"})}),b.map((r,g)=>{const v=!s?.gizmo.display.prompt_starters?.includes(r),N=!t.gizmo.display.prompt_starters?.includes(r);return e.jsx(I,{type:"text",value:r,disabled:!0,className:f("bg-token-main-surface-secondary mb-2 resize-none",E(u,v,N))},g)})]}),w.length>0&&e.jsxs(p,{children:[e.jsx(h,{label:e.jsx(c,{id:"gizmo.readonly.knowledgeLabel",defaultMessage:"Knowledge"})}),e.jsx("div",{className:"flex flex-wrap gap-1",children:w.map((r,g)=>{const v=!s?.files?.find(M=>M.id===r.id),N=!t.files?.find(M=>M.id===r.id);return e.jsx(fe,{file:r.name,fileId:r.id,className:E(u,v,N)},g)})})]}),e.jsxs(p,{children:[e.jsx(h,{label:e.jsx(c,{id:"gizmo.readonly.capabilitiesLabel",defaultMessage:"Capabilities"})}),e.jsx(be,{enabledTools:t.tools,diffedEnabledTools:s?.tools,onEnabledToolsChange:K})]}),!!z.length&&e.jsxs(p,{children:[e.jsx(h,{label:e.jsx(c,{id:"gizmo.readonly.actionsLabel",defaultMessage:"Actions"})}),e.jsx("div",{className:"flex flex-col gap-1",children:z.map((r,g)=>e.jsx(Be,{tool:r,isDiffed:u,compareToGizmo:s,displayGizmo:t},g))})]})]})})}const Pe=C.textarea`mb-8 rounded-lg block h-96 w-full border-token-main-surface-tertiary bg-transparent p-2 font-mono text-xs text-token-text-primary`,Be=({tool:a,compareToGizmo:t,displayGizmo:s,isDiffed:o})=>{const i=a,[n,l]=x.useState(!1),d=!t?.tools?.find(u=>u.type===j.JIT_PLUGIN&&u.metadata.action_id===i.metadata.action_id),m=!s.tools.find(u=>u.type===j.JIT_PLUGIN&&u.metadata.action_id===i.metadata.action_id);return e.jsxs(e.Fragment,{children:[e.jsx(pe,{isDisabled:!1,actionTool:i,className:E(o,d,m),onShowActionsEditor:()=>l(u=>!u)}),n&&e.jsx(Pe,{readOnly:!0,value:i.metadata.raw_spec??""})]})},E=(a,t,s)=>f(a&&t&&"bg-blue-400/10!",a&&s&&"bg-blue-400/10! text-token-text-secondary line-through opacity-50");function Fe({onClose:a,onContinue:t}){const[s,o]=x.useState(!1);return e.jsx(X,{testId:"modal-gizmo-auth-restore",isOpen:!0,onClose:a,type:"warning",showCloseButton:!0,title:e.jsx(c,{id:"gizmoReadOnly.authModalWarningTitle",defaultMessage:"Reset Authentication for Custom Actions"}),primaryButton:e.jsx(R,{onClick:()=>{o(!0),t()},loading:s,color:"secondary",children:e.jsx(c,{id:"gizmoReadOnly.authModalContinueButton",defaultMessage:"Continue"})}),secondaryButton:e.jsx(R,{onClick:a,color:"secondary",children:e.jsx(c,{id:"gizmoReadOnly.authModalCancelButton",defaultMessage:"Cancel"})}),size:"normal",children:e.jsx(c,{id:"gizmoReadOnly.authModalWarningBody",defaultMessage:"Restoring this version will reset authentication of your custom actions. You may need to reconfigure each custom action afterwards."})})}const Ze=()=>(je(),null),qe=ee(function(){const t=te(),s=L(),i=ie().gizmoId??"",n=se(i),{value:l}=P("3645668434");return x.useEffect(()=>{t!=null&&t.isFree()&&s("/")},[t,s]),x.useEffect(()=>{n&&ye(n)&&s(`/g/${i}/project`)},[n,s,i]),l?e.jsx(Ee,{gizmoId:n}):null});export{Ze as clientLoader,qe as default};
//# sourceMappingURL=e520sltrct4hm40z.js.map
