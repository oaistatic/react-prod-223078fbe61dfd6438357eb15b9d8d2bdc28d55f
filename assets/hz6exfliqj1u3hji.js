import{r as x,i as u,o as _,j as e,M as o,e as C}from"./b8ijctzpgh0s7wpx.js";import{bJ as E,cW as T,aH as L,dN as R,ds as I,dO as m,dP as O,dQ as v,dR as M,aI as n,aK as D}from"./krbmwir12ubt4od1.js";import{I as F}from"./mtbwfu1a5yslb3p2.js";import{W as H}from"./omp8ie1vzl40ti1z.js";import{c as w,B}from"./citrwydz0bgriwlc.js";import{S as V}from"./kdg6x58wvl6ya91l.js";function G({repository:s,isSelected:a,className:t,isDisabled:r,disablePill:i}){const c=u(),d=s.visibility==="private"?c.formatMessage({id:"wham.repositorySection.private",defaultMessage:"Private"}):c.formatMessage({id:"wham.repositorySection.public",defaultMessage:"Public"});return e.jsxs("div",{className:w("flex items-center justify-between gap-2",t),children:[e.jsx("div",{className:w("flex items-start gap-3",r&&"opacity-50"),children:e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex flex-row items-center gap-2",children:[e.jsx("p",{className:"text-token-text-primary text-start text-sm font-medium",children:s.name}),e.jsx("a",{href:`https://github.com/${s.repository_full_name}`,target:"_blank",rel:"noopener noreferrer",className:"text-token-text-secondary opacity-0 group-hover:opacity-100",onClick:f=>{f.stopPropagation()},children:e.jsx(R,{className:"icon-sm"})})]}),e.jsx("div",{className:"text-token-text-secondary text-start text-sm leading-tight font-normal",children:[s.language,d].filter(Boolean).map((f,h)=>e.jsx("span",{className:"after:mx-1 after:content-['\\u00b7'] last:after:content-[none]",children:f},h))})]})}),r&&i?i:a?e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(I,{className:"icon-sm"})}):null]})}function W({repository:s,isSelected:a,onClick:t,shouldDisableRow:r,disablePill:i}){const c=r?.(s);return e.jsx("button",{className:w("group flex w-full items-center justify-between gap-2 rounded-md p-3",c?"cursor-default select-none":"hover:bg-token-bg-tertiary cursor-pointer"),disabled:c,onClick:t,type:"button",children:e.jsx(G,{repository:s,isSelected:a,className:"w-full",isDisabled:c,disablePill:i})})}function p(){return e.jsx("div",{className:"flex w-full items-center justify-between gap-2 rounded-md",children:e.jsx(L,{className:"h-14 w-full"})})}const y=100;function q({selectedRepository:s,onSelect:a,installationId:t,shouldDisableRow:r,disablePill:i}){const c=u(),[d,f]=x.useState(""),{data:h,isLoading:k,fetchNextPage:N,hasNextPage:j,isFetchingNextPage:S,error:P}=_({queryKey:["repositories",t],enabled:!!t,initialPageParam:1,queryFn:({pageParam:l})=>H.getRepositoriesByInstallationId(t??0,l,y),getNextPageParam:(l,A)=>{if(!((l?.repositories??[]).length<y))return A.length+1},refetchOnWindowFocus:!0}),b=x.useMemo(()=>h?.pages.flatMap(l=>l.repositories??[])??[],[h]).filter(l=>l.name.toLowerCase().includes(d.toLowerCase()));return e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("p",{className:"text-token-text-primary text-sm font-medium",children:e.jsx(o,{id:"wham.createEnvironments.repository",defaultMessage:"Repository"})}),e.jsx("div",{className:"flex justify-between",children:e.jsx(E,{color:"search",iconPosition:"left",icon:T,className:"text-token-text-tertiary flex h-8 w-full items-center rounded-md!",inputClassName:"text-token-text-primary w-full",containerInputClassName:"w-full",name:"search-repos",type:"text",value:d,onChange:l=>f(l.target.value),placeholder:c.formatMessage({id:"wham.repositorySection.searchPlaceholder",defaultMessage:"Search"}),ariaLabel:c.formatMessage({id:"wham.repositorySection.searchAria",defaultMessage:"Search"})})}),e.jsxs("div",{className:"border-token-border-heavy bg-token-bg-primary flex flex-col gap-2 rounded-lg border p-3",children:[e.jsx("div",{className:"flex max-h-56 flex-col overflow-y-auto",children:!t||k?e.jsxs("div",{className:"flex h-full flex-col gap-2",children:[e.jsx(p,{}),e.jsx(p,{}),e.jsx(p,{}),e.jsx(p,{})]}):P?e.jsx("div",{className:"text-token-text-primary flex h-full items-center justify-center text-sm",children:e.jsx(o,{id:"wham.createEnvironments.repositorySection.error",defaultMessage:"Failed to load repositories. Please ensure you have connected your GitHub account."})}):e.jsxs(e.Fragment,{children:[b.length===0&&!j?e.jsx("div",{className:"text-token-text-secondary text-md flex h-24 w-full items-center justify-center",children:e.jsx(o,{id:"wham.createEnvironments.repositorySection.noRepositories.short",defaultMessage:"No repositories found"})}):b.map(l=>e.jsxs("div",{children:[e.jsx(W,{repository:l,isSelected:s===l.id,onClick:()=>a(l.id,l.repository_full_name,l.name),shouldDisableRow:r,disablePill:i}),e.jsx("div",{className:"border-token-border-light border-t"})]},l.id)),e.jsx(F,{isFetchingNextPage:S,hasNextPage:j??!1,fetchNextPage:N,bgColor:"dark:bg-token-bg-secondary"})]})}),t&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-token-text-secondary pt-3 text-start text-xs leading-none",children:e.jsx(o,{id:"wham.createEnvironments.repositorySection.access",defaultMessage:"This list only includes repositories that you have access to in GitHub and can use with Codex."})}),e.jsx("p",{className:"text-token-text-secondary text-start text-xs leading-none",children:t?e.jsx(o,{id:"wham.createEnvironments.repositorySection.noRepositories",defaultMessage:"Missing a repo? <link>Configure repository access</link>.",values:{link:l=>e.jsx("a",{href:`https://github.com/apps/chatgpt-connector/installations/${t}`,target:"_blank",rel:"noopener noreferrer",className:"underline",children:l})}}):e.jsx(o,{id:"wham.createEnvironments.repositorySection.selectAccount",defaultMessage:"Select an account to connect to"})})]})]})]})}const oe=x.memo(q),g=C({toggleOffLabel:{id:"wham.networkAccessToggle.off",defaultMessage:"Off"},toggleOnLabel:{id:"wham.networkAccessToggle.on",defaultMessage:"On"}});function le({className:s}){return e.jsxs("div",{className:w("border-token-border-light flex flex-col items-start justify-start gap-1 self-stretch rounded-lg border bg-orange-600/10 p-3",s),children:[e.jsx("div",{className:"text-token-text-status-warning justify-start self-stretch text-xs leading-none font-medium",children:e.jsx(o,{id:"wham.createEnvironments.networkAccessAlert.title",defaultMessage:"Enabling internet access exposes your environment to security risks"})}),e.jsx("div",{className:"text-token-text-primary justify-start self-stretch text-xs",children:e.jsx(o,{id:"wham.createEnvironments.networkAccessAlert.description",defaultMessage:"These include prompt injection, exfiltration of code or secrets, inclusion of malware or vulnerabilities, or use of content with license restrictions. <docsLink>See the docs</docsLink> for an example exfiltration attack.{br}{br}To mitigate risks, only allow necessary domains and methods, and always review Codex's outputs and work log.",values:{br:e.jsx("br",{}),docsLink:a=>e.jsx("a",{href:"https://platform.openai.com/docs/codex/agent-network#preset-domain-lists",target:"_blank",rel:"noopener noreferrer",className:"underline",children:a})}})})]})}function z({accessSettings:s,onAccessSettingsChange:a}){return e.jsx(V,{className:"max-w-32",ariaLabel:{id:"wham.networkAccessToggle.label",defaultMessage:"Internet access",description:"Label for the agent network access toggle"},value:s?.mode??"off",onChange:t=>{a(t==="off"?{mode:"off"}:{mode:"on",preset_allowlist:M})},leftItem:{ariaLabel:g.toggleOffLabel,label:g.toggleOffLabel,value:"off"},rightItem:{ariaLabel:g.toggleOnLabel,label:g.toggleOnLabel,value:"on"}})}function Q({value:s,onValueChange:a}){const t=u();return e.jsxs(n.Root,{value:s,onValueChange:r=>{r&&a(r)},children:[e.jsx(n.Trigger,{className:"border-token-border-default! bg-token-bg-primary! w-fit min-w-64 rounded-md! border","aria-label":t.formatMessage({id:"wham.presetAllowlistSelectorPopover.openPresetAllowlist",defaultMessage:"Open preset allowlist menu"}),children:e.jsxs("div",{className:"flex w-full items-center justify-between",children:[e.jsx(n.Value,{placeholder:t.formatMessage({id:"wham.presetAllowlistSelectorPopover.selectPresetAllowlist",defaultMessage:"Select preset allowlist option"})}),e.jsx(n.Icon,{})]})}),e.jsx(n.Portal,{children:e.jsxs(n.Content,{align:"start",className:"bg-token-bg-primary min-w-64",children:[e.jsx(n.Item,{value:m,children:e.jsx("div",{className:"flex w-full justify-start pe-2 text-start",children:e.jsx(o,{id:"wham.presetAllowlistSelectorPopover.none",defaultMessage:"None"})})}),e.jsx(n.Item,{value:M,children:e.jsx("div",{className:"flex w-full justify-start pe-2 text-start",children:e.jsx(o,{id:"wham.presetAllowlistSelectorPopover.codex",defaultMessage:"Common dependencies"})})}),e.jsx(n.Item,{value:v,children:e.jsx("div",{className:"flex w-full justify-start pe-2 text-start",children:e.jsx(o,{id:"wham.presetAllowlistSelectorPopover.all",defaultMessage:"All (unrestricted)"})})})]})})]})}function K({value:s,onValueChange:a}){const t=u();return e.jsxs(n.Root,{value:s?"on":"off",onValueChange:r=>a(r==="on"),children:[e.jsx(n.Trigger,{className:"border-token-border-default! bg-token-bg-primary! w-fit min-w-64 rounded-md! border","aria-label":t.formatMessage({id:"wham.networkAccess.safeMethodsMenu.openSafeMethodsMenu",defaultMessage:"Open safe HTTP methods menu"}),children:e.jsxs("div",{className:"flex w-full items-center justify-between",children:[e.jsx(n.Value,{placeholder:t.formatMessage({id:"wham.networkAccess.safeMethodsMenu.selectSafeMethodsOption",defaultMessage:"Select safe HTTP methods option"})}),e.jsx(n.Icon,{})]})}),e.jsx(n.Portal,{children:e.jsxs(n.Content,{align:"start",className:"bg-token-bg-primary",children:[e.jsx(n.Item,{value:"off",children:e.jsx("div",{className:"flex w-full justify-start pe-2 text-start",children:e.jsx(o,{id:"wham.networkAccess.safeMethodsMenu.off",defaultMessage:"All methods"})})}),e.jsx(n.Item,{value:"on",children:e.jsx("div",{className:"flex w-full justify-start pe-2 text-start",children:e.jsx(o,{id:"wham.networkAccess.safeMethodsMenu.on",defaultMessage:"GET, HEAD, and OPTIONS"})})})]})})]})}function $({value:s,onChange:a,preset:t}){const r=u(),[i,c]=x.useState(t!==m&&s.length===0);return i&&t!==m?e.jsx(B,{icon:D,color:"secondary",size:"medium",type:"button",className:"ms-auto",onClick:()=>c(!1),children:e.jsx(o,{id:"wham.networkAccess.additionalAllowedDomainsButton",defaultMessage:"Add domains"})}):e.jsxs(e.Fragment,{children:[e.jsx("textarea",{name:"allowlistDomains",className:"border-token-border-default focus-within:border-token-border-heavy focus-within:ring-token-text-secondary bg-token-bg-primary w-full resize-y rounded-md border px-3 py-2 font-mono text-xs shadow-none focus-within:ring-1",value:s,rows:3,onChange:d=>{a(d.target.value)},placeholder:r.formatMessage({id:"wham.networkAccess.allowlistAdditionalDomainsPlaceholder",defaultMessage:"domain1, domain2, domain3"}),"aria-label":r.formatMessage({id:"wham.networkAccess.allowlistDomains",defaultMessage:"Additional allowed domains"})}),e.jsx("p",{className:"text-token-text-tertiary text-xs",children:e.jsx(o,{id:"wham.networkAccess.allowlistDomainsDescription",defaultMessage:"Enter domains, separated by commas"})})]})}function J({agentNetworkAccess:s,onChange:a}){const[t,r]=x.useState(()=>({[s?.preset_allowlist??m]:s?.allowlist_domains??""}));return e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("p",{className:"text-token-text-primary text-sm font-medium",children:e.jsx(o,{id:"wham.createEnvironments.internetAccessSection.label",defaultMessage:"Agent internet access"})}),e.jsx(z,{accessSettings:s,onAccessSettingsChange:a}),s==null||s.mode==="off"?e.jsx("p",{className:"text-token-text-tertiary mb-2 text-xs",children:e.jsx(o,{id:"wham.networkAccess.offDescription",defaultMessage:"Internet access will be disabled after setup. Codex will only be able to use dependencies installed by the setup script."})}):e.jsx(e.Fragment,{children:e.jsx("div",{className:"py-2",children:e.jsxs("div",{className:"flex flex-col gap-4 border-s-3 ps-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-token-text-primary text-sm font-medium",children:e.jsx(o,{id:"wham.networkAccess.allowlist",defaultMessage:"Domain allowlist"})}),e.jsxs("div",{className:"flex flex-row items-center gap-3",children:[e.jsx(Q,{value:s.preset_allowlist??m,onValueChange:i=>{const c=s.preset_allowlist??m,d={...t,[c]:s.allowlist_domains??""};r(d),a({...s,preset_allowlist:i,allowlist_domains:d[i]??""})}}),e.jsxs("a",{href:"https://platform.openai.com/docs/codex/agent-network#preset-domain-lists",target:"_blank",rel:"noopener noreferrer",className:"text-token-text-tertiary flex items-center gap-1 text-xs",children:[e.jsx(O,{className:"icon-sm"}),e.jsx(o,{id:"wham.networkTab.allowlist.readList",defaultMessage:"Domain details"})]})]})]}),s.preset_allowlist!==v&&e.jsxs("div",{children:[e.jsx("p",{className:"text-token-text-primary pb-2 text-sm font-medium",children:e.jsx(o,{id:"wham.networkAccess.additionalAllowedDomains",defaultMessage:"Additional allowed domains"})}),e.jsx($,{value:s.allowlist_domains??"",onChange:i=>{const c=s.preset_allowlist??m;r(d=>({...d,[c]:i})),a({...s,allowlist_domains:i})},preset:s.preset_allowlist??m})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-token-text-primary text-sm font-medium",children:e.jsx(o,{id:"wham.networkAccess.allowedHttpMethods",defaultMessage:"Allowed HTTP Methods"})}),e.jsx(K,{value:!!s.safe_methods_only,onValueChange:i=>a({...s,safe_methods_only:i})})]})]})})})]})}const re=x.memo(J);export{re as N,oe as R,le as a,G as b};
//# sourceMappingURL=hz6exfliqj1u3hji.js.map
