import{j as t,a5 as N,d as F,r as k,i as V}from"./b8ijctzpgh0s7wpx.js";import{T as U,m as L}from"./by50z05oxjtbvc0n.js";import{aX as z,jn as P,jq as I,c as O,eE as _,jr as tt,js as et,jt as at,s as ot,C as rt}from"./krbmwir12ubt4od1.js";import{c as p,gI as nt,bS as st}from"./citrwydz0bgriwlc.js";import{u as lt,D as dt,c as ct}from"./grmx1v2b0e1c1pfw.js";import{C as H,T as it}from"./h1czb0j29h0ikcgh.js";import{S as mt}from"./mw39pbo6szk09iqp.js";import{S as ft}from"./np33g8fhvh96dq0i.js";import{P as q}from"./hbpbckirom363mgh.js";import{g as xt}from"./btagl6w1gub4aw61.js";import"./jy1u8exw8iz2slve.js";import"./eq7m7kpdgo83dcz8.js";import"./m4qet7ipn6ha09it.js";const A=({label:r,Icon:s,isCanvasHovered:l=!1,onClick:i,isDisabled:d})=>t.jsx(z,{label:r,children:t.jsx(N.button,{disabled:d,onClick:h=>{h.stopPropagation(),i?.(h)},animate:{opacity:l?1:.64},whileHover:{opacity:1},transition:{type:"tween",duration:.18},className:p("text-token-text-secondary hover:bg-token-surface-hover focus-visible:bg-token-surface-hover rounded-lg p-1 transition-colors focus-visible:outline-0",{"cursor-not-allowed":d}),children:t.jsx(s,{className:"icon-md"})})});var S,W;function ut(){if(W)return S;W=1;var r=I(),s=P(),l=nt(),i=parseFloat,d=Math.min,h=Math.random;function b(e,o,c){if(c&&typeof c!="boolean"&&s(e,o,c)&&(o=c=void 0),c===void 0&&(typeof o=="boolean"?(c=o,o=void 0):typeof e=="boolean"&&(c=e,e=void 0)),e===void 0&&o===void 0?(e=0,o=1):(e=l(e),o===void 0?(o=e,e=0):o=l(o)),e>o){var a=e;e=o,o=a}if(c||e%1||o%1){var f=h();return d(e+f*(o-e+i("1e-"+((f+"").length-1))),o)}return r(e,o)}return S=b,S}var ht=ut();const bt=F(ht),gt=({isCanvasHovered:r=!1,onClick:s})=>{const l=V();return t.jsx(A,{label:l.formatMessage({id:"KMbgyZ",defaultMessage:"Open in canvas"}),Icon:mt,onClick:s,isCanvasHovered:r})},pt=({textdocVersion:r,clientThreadId:s})=>{const{handleCopy:l,Icon:i,copyLabel:d}=ct({textdocVersion:r,clientThreadId:s});return t.jsx(A,{label:d,Icon:i,onClick:l})},jt=({isCodePreviewable:r,onClick:s,isDisabled:l})=>{const i=V();return t.jsx(A,{label:i.formatMessage(r?L.previewCode:L.runCode),Icon:ft,onClick:s,isDisabled:l})},yt=({isCanvasOpen:r,isFocused:s,isCanvasHovered:l,isInlinePreview:i,size:d})=>r?s?"0px 2px 6px 0px rgba(0, 0, 0, 0.06)":"0px 2px 6px 0px rgba(0, 0, 0, 0)":i?l||s?`0px ${d==="large"?12:4}px ${d==="large"?32:10}px 0px rgba(0, 0, 0, 0.064)`:`0px ${d==="large"?6:4}px ${d==="large"?14:4}px 0px rgba(0, 0, 0, 0.04)`:"0px 2px 6px 0px rgba(0, 0, 0, 0)",vt=({textdocId:r,clientThreadId:s,name:l,tag:i,icon:d,iconSelected:h,marginBottom:b,size:e="large",height:o=e==="large"?"22rem":"10rem",minHeight:c,isCanvasOpen:a=!1,isDisabled:f=!1,isFocused:m=!1,isInferring:j=!1,isInlinePreview:n=!1,isStreaming:x=!1,isUserMessage:g=!1,onClick:y,children:C})=>{const E=k.useRef(null),[u,B]=k.useState(!1),[$]=k.useState(()=>bt(100,180,!1)),T=st(O(r)?.versions),M=_(),v=!M,{isCodePreviewable:w,isCodeExecutable:D,hasCanvasCodeExecution:G}=lt(T),K=x||!G,X=w||D,R=m&&a?h??d:d,Z=R?t.jsx("span",{className:p("shrink-0 transition-[filter]",{grayscale:!m&&!u}),children:R}):t.jsx("div",{className:"icon flex items-center overflow-hidden",children:t.jsx(q,{lines:1,size:"base",width:100,widthVariance:0})}),J=!l||j?t.jsx("div",{className:"flex h-6 grow items-center overflow-hidden",style:{width:$},children:t.jsx(q,{lines:1,size:"base",width:100,widthVariance:0})}):t.jsx("span",{className:"min-w-0 truncate",children:l}),Q=()=>{!E.current||f||(tt.logButtonClick(et.MESSAGE_ATTACHMENT,{type:i}),at(E.current),y?.())},Y=()=>{r&&ot({type:rt.Textdoc,textdocId:r,shouldRunCodeOnOpen:!0})};return t.jsxs(N.div,{role:v?"button":void 0,id:xt(r),initial:{opacity:x?0:1,scale:x?.9:1},animate:{opacity:1,scale:1},transition:{type:"spring",bounce:0,duration:.72},className:p("popover bg-token-main-surface-primary relative z-0 flex flex-col overflow-hidden border transition-shadow duration-500",f?"cursor-default":v?"cursor-pointer":"cursor-text",{"select-none":v,"border-token-text-tertiary font-medium dark:border-gray-600":m&&a,"font-regular":!m,"border-token-border-default":!u&&!m,"border-token-border-medium":u&&!m,"flex min-w-0 shrink grow-0 items-center justify-between self-start rounded-xl":a||!n,"rounded-2xl":!a&&n,"max-w-full":!g&&(a||!n),"max-w-[var(--user-chat-width,70%)]":g&&(a||!n),"w-full":!g&&!a&&n,"w-[var(--user-chat-width,70%)]":g&&!a&&n}),onMouseEnter:()=>!f&&B(!0),onMouseLeave:()=>B(!1),onClick:()=>v?Q():void 0,ref:E,style:{marginBottom:b,height:n&&!a?o:void 0,minHeight:n&&!a?c:void 0,width:e==="small"?"300px":void 0,boxShadow:yt({isCanvasOpen:a,isFocused:m,isCanvasHovered:u,isInlinePreview:n,size:e})},children:[t.jsxs("div",{className:p("border-token-border-default flex w-full min-w-0 items-center justify-between gap-2 self-start px-4 transition-colors duration-700",{"border-token-border-default":!u&&!m,"border-token-border-medium":u&&!m,"text-token-text-primary text-sm font-medium":!a&&u&&n,"py-2":a||!n,"py-3":!a&&n,"text-token-text-secondary text-sm font-medium":!a&&!u&&n}),children:[t.jsxs("div",{className:p("flex min-w-0 items-center",{"gap-2":a||!n,"gap-3.5":!a&&n}),children:[Z,J]}),a?t.jsx(N.span,{animate:x?"show":"initial",variants:{initial:{opacity:0,paddingLeft:0,width:"0"},show:{opacity:1,paddingLeft:2,width:"24px"}},transition:{type:"tween",duration:.18},children:x&&t.jsx(U,{gap:1,padding:0})}):n&&!f?t.jsxs("div",{className:"flex gap-2",children:[M&&s&&t.jsx(pt,{clientThreadId:s,textdocVersion:T??null}),M&&X&&t.jsx(jt,{isCodePreviewable:w,onClick:Y,isDisabled:K}),t.jsx(gt,{isCanvasHovered:u,onClick:y})]}):null]}),t.jsxs("div",{className:"relative flex min-h-0 w-full flex-1 flex-col self-end",children:[!a&&C,n&&!a&&t.jsx(H,{size:e,position:"bottom"}),n&&e==="small"&&!a&&t.jsx(H,{size:e,position:"right"})]})]})},qt=({textdocId:r,clientThreadId:s,name:l,tag:i,icon:d,iconSelected:h,isCanvasOpen:b=!1,isFetching:e=!1,isFocused:o=!1,isInlinePreview:c=!1,isStreaming:a=!1,isUserMessage:f=!1,onClick:m})=>{const[j,n]=k.useState(!1),x=_(),g=C=>{n(C>0)},y=c&&!b?16:12;return t.jsx(vt,{textdocId:r,name:l,tag:i,icon:d,height:x?"auto":void 0,minHeight:x?"22rem":void 0,iconSelected:h,marginBottom:y,isCanvasOpen:b,isFocused:o,isInlinePreview:c,isStreaming:a,isUserMessage:f,onClick:m,clientThreadId:s,children:c&&t.jsx("div",{className:p("relative flex min-h-0 flex-auto flex-col overflow-hidden border-t transition-colors",{"border-token-border-default":j,"border-transparent":!j}),children:e?t.jsx(dt,{}):!!r&&t.jsx(it,{disableScroll:x,onScroll:g,textdocId:r,clientThreadId:s})})})};export{qt as CanvasMessageAttachment,vt as CanvasMessageAttachmentWrapper};
//# sourceMappingURL=ffthvcv2ywaxfivg.js.map
