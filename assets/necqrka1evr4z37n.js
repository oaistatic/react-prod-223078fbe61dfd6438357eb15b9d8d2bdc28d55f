import{r,j as e,i as Se,M as a,e as Me}from"./b8ijctzpgh0s7wpx.js";import{aZ as je,aY as Le,a_ as W,n as _,gT as De,b as Q,de as ee,ad as Ne,m as we,aL as Ie,ab as $,dp as Ee,O as J,ac as Pe,c as K,e as P,aQ as A,aN as G}from"./citrwydz0bgriwlc.js";import{ll as Ae,U as z,bL as Re,bM as Te,V as Ue,id as Be,aL as He,B as Fe,cs as qe,ey as ze,ez as Oe,ex as Ze,O as X,fW as Ve}from"./krbmwir12ubt4od1.js";import{i as Ye}from"./by1c2a5hsj4exnt8.js";const We=t=>r.createElement("svg",{width:20,height:20,viewBox:"0 0 20 20",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...t},r.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.7012 2.5C13.3719 2.49999 13.926 2.50026 14.377 2.53711C14.8451 2.57539 15.2754 2.65736 15.6797 2.86328C16.3069 3.18286 16.8171 3.69311 17.1367 4.32031C17.3426 4.72456 17.4246 5.1549 17.4629 5.62305C17.4997 6.07402 17.5 6.62806 17.5 7.29883V12.7012C17.5 13.3719 17.4997 13.926 17.4629 14.377C17.4246 14.8451 17.3426 15.2754 17.1367 15.6797C16.8171 16.3069 16.3069 16.8171 15.6797 17.1367C15.2754 17.3426 14.8451 17.4246 14.377 17.4629C13.926 17.4997 13.3719 17.5 12.7012 17.5H7.29883C6.62806 17.5 6.07402 17.4997 5.62305 17.4629C5.1549 17.4246 4.72456 17.3426 4.32031 17.1367C3.69311 16.8171 3.18286 16.3069 2.86328 15.6797C2.65736 15.2754 2.57539 14.8451 2.53711 14.377C2.50026 13.926 2.49999 13.3719 2.5 12.7012V7.29883C2.49999 6.62806 2.50026 6.07402 2.53711 5.62305C2.57539 5.1549 2.65736 4.72456 2.86328 4.32031C3.18286 3.69311 3.69311 3.18286 4.32031 2.86328C4.72456 2.65736 5.1549 2.57539 5.62305 2.53711C6.07402 2.50026 6.62807 2.49999 7.29883 2.5H12.7012ZM13.4248 6.74805C13.1245 6.53673 12.7094 6.60897 12.498 6.90918L9.0166 11.8545L7.49219 10.1777L7.3916 10.0879C7.14198 9.90561 6.79045 9.91693 6.55273 10.1328C6.31499 10.3491 6.26959 10.6989 6.42773 10.9648L6.50781 11.0723L8.59082 13.3643L8.64453 13.417C8.77581 13.5321 8.94871 13.592 9.125 13.5811C9.3262 13.5684 9.51083 13.4646 9.62695 13.2998L13.5859 7.6748C13.7971 7.37459 13.7248 6.95946 13.4248 6.74805Z"})),$e=t=>r.createElement("svg",{width:20,height:20,viewBox:"0 0 20 20",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...t},r.createElement("path",{d:"M16.0012 7.33331C16.0012 6.62228 16.0013 6.12894 15.97 5.74542C15.9469 5.46347 15.9091 5.27396 15.8577 5.13019L15.802 5.00031C15.6481 4.6982 15.4137 4.44517 15.1262 4.26886L14.9993 4.19855C14.8413 4.11809 14.6297 4.06127 14.2542 4.03058C13.8707 3.99926 13.3771 3.99835 12.6663 3.99835H7.33325C6.62221 3.99835 6.12888 3.99924 5.74536 4.03058C5.36966 4.06128 5.15825 4.11804 5.00024 4.19855C4.655 4.37447 4.37441 4.65506 4.19849 5.00031C4.11798 5.15831 4.06122 5.36972 4.03052 5.74542C3.99918 6.12894 3.99829 6.62228 3.99829 7.33331V12.6663C3.99829 13.3772 3.9992 13.8707 4.03052 14.2542C4.0612 14.6298 4.11803 14.8413 4.19849 14.9993L4.2688 15.1263C4.44511 15.4137 4.69813 15.6481 5.00024 15.8021L5.13013 15.8577C5.2739 15.9092 5.46341 15.947 5.74536 15.97C6.12888 16.0014 6.62222 16.0013 7.33325 16.0013H12.6663C13.3771 16.0013 13.8707 16.0013 14.2542 15.97C14.6295 15.9394 14.8413 15.8824 14.9993 15.8021C15.3445 15.6261 15.6261 15.3446 15.802 14.9993L15.8577 14.8694C15.9091 14.7257 15.9469 14.536 15.97 14.2542C16.0013 13.8707 16.0012 13.3772 16.0012 12.6663V7.33331ZM17.3313 12.6663C17.3313 13.3553 17.3319 13.9124 17.2952 14.3626C17.2624 14.7636 17.1974 15.1247 17.053 15.4612L16.9866 15.6038C16.6832 16.1992 16.1991 16.6832 15.6038 16.9866C15.227 17.1786 14.8206 17.2578 14.3625 17.2952C13.9123 17.332 13.3553 17.3314 12.6663 17.3314H7.33325C6.64416 17.3314 6.0872 17.332 5.63696 17.2952C5.23628 17.2625 4.87563 17.1973 4.53931 17.053L4.39673 16.9866C3.87561 16.7211 3.43911 16.3174 3.13501 15.8216L3.01294 15.6038C2.82097 15.2271 2.74177 14.8206 2.70435 14.3626C2.66758 13.9124 2.66821 13.3553 2.66821 12.6663V7.33331C2.66821 6.64422 2.66756 6.08727 2.70435 5.63702C2.74176 5.17923 2.82113 4.77341 3.01294 4.39679C3.31638 3.80126 3.8012 3.31644 4.39673 3.013C4.77334 2.8212 5.17917 2.74182 5.63696 2.70441C6.0872 2.66762 6.64416 2.66827 7.33325 2.66827H12.6663C13.3553 2.66827 13.9123 2.66764 14.3625 2.70441C14.8206 2.74183 15.227 2.82103 15.6038 3.013L15.8215 3.13507C16.3174 3.43917 16.7211 3.87567 16.9866 4.39679L17.053 4.53937C17.1973 4.87569 17.2624 5.23634 17.2952 5.63702C17.332 6.08727 17.3313 6.64422 17.3313 7.33331V12.6663Z"})),Je=()=>je((t,d)=>({title:void 0,highlightedMessageId:void 0,initiallyHighlightedMessageId:void 0,currentNodeId:void 0,shareLinkId:void 0,shareLinkUrl:void 0,isPublic:!1,isDeleted:!1,isAnonymous:!0,isDiscoverable:!1,canDisableDiscoverability:!1,linkAlreadyExisted:!1,linkAlreadyPublic:!1,linkError:void 0,moderationState:void 0,piiDetected:!1})),O=r.createContext(),m=t=>Le(r.useContext(O),t),Ke=()=>m(t=>t.shareLinkId),Ge=()=>m(t=>t.shareLinkUrl),Xe=()=>m(t=>t.currentNodeId),Qe=()=>m(t=>t.linkAlreadyPublic),et=()=>m(t=>t.isDiscoverable),tt=()=>m(t=>t.canDisableDiscoverability);function st(t){return t.metadata?.aggregate_result?.messages?.some(Ye)===!0}function at(t){const d=t.content;return("parts"in d?d.parts.join(""):"").includes("sandbox:")}function it(t){return st(t)||at(t)}const g=Me({moderationBlocked:{id:"sharingModal.moderationBlocked",defaultMessage:"This shared link has been disabled by moderation."},confirmDeleteLink:{id:"sharingModal.confirmDeleteLink",defaultMessage:"Are you sure you want to delete the share link?"},advancedDataAnalysisSupportDisclaimer:{id:"sharingModal.advancedDataAnalysisSupportDisclaimer",defaultMessage:"Recipients won’t be able to view Advanced Data Analysis images or download files."},copying:{id:"thread.sharingModal.copying",defaultMessage:"Copying..."},failedToCopyLink:{id:"thread.sharingModal.failedToCopyLink",defaultMessage:"Failed to copy link to clipboard"},failedToDeleteSharedLink:{id:"thread.sharingModal.failedToDeleteSharedLink",defaultMessage:"Failed to delete shared link"},plusProjectDescription:{id:"sharingModal.plusProjectDescription",defaultMessage:"Your name, uploaded files, custom instructions, and any messages you add after sharing stay private."},enterpriseProjectDescription:{id:"sharingModal.enterpriseProjectDescription",defaultMessage:"Any messages you add after sharing will be visible to members of your workspace. Project files and custom instructions won’t be accessible via the shared link."}}),nt=e.jsx(a,{id:"HuCdJn",defaultMessage:"This conversation may include personal information."}),rt=e.jsx(a,{id:"AEHBcL",defaultMessage:"Take a moment to check the content before sharing the link."});function xt({serverThreadId:t}){const d=Ae(t),c=W(t)!=null?_.getCurrentNode(W(t)).message.id:d?.current_node,[x]=r.useState(()=>Je()),S=!De()&&c,[b,D]=r.useState(!0),N=r.useRef(!1);return r.useEffect(()=>{S&&(N.current||(N.current=!0,Q.safePost("/share/create",{requestBody:{current_node_id:c,conversation_id:t,is_anonymous:!0}}).then(i=>{x.setState({shareLinkId:i.share_id,shareLinkUrl:i.share_url,isPublic:i.is_public,isDeleted:!i.is_visible,title:i.title,highlightedMessageId:i.highlighted_message_id??void 0,initiallyHighlightedMessageId:i.highlighted_message_id??void 0,currentNodeId:i.current_node_id,linkAlreadyExisted:i.already_exists,linkAlreadyPublic:i.is_public,isAnonymous:i.is_anonymous,isDiscoverable:i.is_discoverable,canDisableDiscoverability:i.can_disable_discoverability,moderationState:i.moderation_state??void 0,piiDetected:i.pii_detected??!1})}).catch(i=>{const o=ee(i);o?x.setState({linkError:o}):z.closeSharingModal()}).finally(()=>{D(!1)})))},[S]),e.jsx(O.Provider,{value:x,children:e.jsx(dt,{serverThreadId:t,isLoading:b})})}function q(t){return t.has_been_auto_blocked===!0||t.has_been_auto_moderated===!0||t.has_been_blocked===!0}const ot="https://help.openai.com/en/articles/7925741-chatgpt-shared-links-faq",lt="https://help.openai.com/en/articles/8474715-chatgpt-enterprise-shared-links-faq";function dt({serverThreadId:t,isLoading:d}){const c=Se(),[x,L]=r.useState(!1),[S,b]=r.useState(!1),[D,N]=r.useState(!1),i=Ne(),o=r.useContext(O),f=Ke(),p=Ge(),te=Xe(),y=Qe(),w=et(),se=tt(),Z=m(s=>s.linkError),M=m(s=>s.moderationState),ae=M!=null&&q(M),ie=m(s=>s.piiDetected),j=Re(Te.isBusinessWorkspace),[R,ne,re,oe,le]=we(t,s=>[_.getCurrentNode(s),_.hasUserContextPrompt(s),_.hasModelEditableContext(s),_.findNode(s,n=>it(n.message))!=null,_.getGizmoId(s)]),de=R?.message.id,T=Ue(le),[ce,V]=r.useState(!1),{layer:ue}=Ie("1547743984"),he=ue.get("show_copylink_state_if_no_updates",!1),Y=ne||re;if(d)return e.jsx($,{isOpen:!0,testId:"modal-sharing",onClose:Ee,size:"custom",className:"max-w-[550px]",type:"success",showCloseButton:!0,children:e.jsx("div",{className:"flex h-full items-center justify-center py-4",children:e.jsx(J,{className:"icon-md text-token-text-secondary"})})});const ge=async(s,n,u)=>{const{highlightedMessageId:H,title:C,isDeleted:v,isAnonymous:F}=o.getState();try{X(n,i,u)}catch{i.danger(c.formatMessage(g.failedToCopyLink)),L(!1);return}if(D){try{X(n,i,u)}catch{i.danger(c.formatMessage(g.failedToCopyLink));return}b(!0),setTimeout(()=>{b(!1)},1500);return}L(!0);try{const{moderation_state:h,is_discoverable:E,can_disable_discoverability:_e}=await G.updateShareLink({share_id:s,highlighted_message_id:H,title:C??void 0,is_public:!v,is_visible:!v,is_anonymous:F,current_node_id:R?.message.id});if(q(h)){o.setState({moderationState:h});return}o.setState({isPublic:!0,moderationState:h,isDiscoverable:E??void 0,canDisableDiscoverability:_e}),b(!0),setTimeout(()=>{b(!1)},1500)}catch(h){const E=ee(h);E&&o.setState({linkError:E})}finally{L(!1)}N(!0)},me=async()=>{V(!0);const{highlightedMessageId:s,title:n,isDeleted:u,isAnonymous:H}=o.getState();if(f)try{const{moderation_state:C,is_discoverable:v,can_disable_discoverability:F}=await G.updateShareLink({share_id:f,highlighted_message_id:s,title:n??void 0,is_public:!u,is_visible:!u,is_anonymous:H,is_discoverable:!w,current_node_id:R?.message.id});if(q(C)){o.setState({moderationState:C});return}o.setState({isDiscoverable:v??void 0,canDisableDiscoverability:F,moderationState:C});const h=v?"Share Public Chat: Discoverability Enabled":"Share Public Chat: Discoverability Disabled";P.logEvent(h,{shareLinkId:f}),A.logEvent("chatgpt_conversation_share_link_discoverability_toggled",v?"enabled":"disabled")}catch{i.danger("Failed to update this chat's discoverability")}finally{V(!1)}},fe=async()=>{await Q.safeDelete("/share/{shared_conversation_id}",{parameters:{path:{shared_conversation_id:o.getState().shareLinkId}}}).catch(s=>{i.danger(c.formatMessage(g.failedToDeleteSharedLink))}).then(()=>{z.closeSharingModal()})},l=D||j&&y||y&&te===de&&he;function xe(){z.closeSharingModal()}const pe=()=>{let s,n;return j?(s=e.jsx(a,{id:"IR+p6G",defaultMessage:"Share link to chat"}),n=T?c.formatMessage(g.enterpriseProjectDescription):e.jsx(a,{id:"ZKoPTp",defaultMessage:"Any messages you add after sharing will be visible to members of your workspace."}),l&&(s=e.jsx(a,{id:"AX5quN",defaultMessage:"Link created"}),n=e.jsx(a,{id:"OmpNr/",defaultMessage:"A link to your chat has been created. Manage previously shared chats at any time via <settingsLink>Settings</settingsLink>.",values:{settingsLink:u=>e.jsx("a",{href:"#settings/DataControls",target:"_blank",rel:"noreferrer",className:"underline",children:u})}})),{modalTitle:s,modalDescription:n}):(l?y?(s=e.jsx(a,{id:"DD6oDE",defaultMessage:"Public link updated"}),n=e.jsx(a,{id:"sJl/nl",defaultMessage:"The public link to your chat has been updated. Manage previously shared chats via <settingsLink>Settings</settingsLink>.",values:{settingsLink:u=>e.jsx("a",{href:"#settings/DataControls",target:"_blank",rel:"noreferrer",className:"underline",children:u})}})):(s=e.jsx(a,{id:"7xzg3Y",defaultMessage:"Public link created"}),n=e.jsx(a,{id:"LZ5EAo",defaultMessage:"A public link to your chat has been created. Manage previously shared chats at any time via <settingsLink>Settings</settingsLink>.",values:{settingsLink:u=>e.jsx("a",{href:"#settings/DataControls",target:"_blank",rel:"noreferrer",className:"underline",children:u})}})):y?(s=e.jsx(a,{id:"FyIlHR",defaultMessage:"Update public link to chat"}),n=T?c.formatMessage(g.plusProjectDescription):Y?e.jsx(a,{id:"091Z/H",defaultMessage:"Your name, custom instructions, and any messages you add after sharing stay private."}):e.jsx(a,{id:"U7wOdx",defaultMessage:"Your name and any messages you add after sharing stay private."})):(s=e.jsx(a,{id:"xgkjrq",defaultMessage:"Share public link to chat"}),n=T?c.formatMessage(g.plusProjectDescription):Y?e.jsx(a,{id:"091Z/H",defaultMessage:"Your name, custom instructions, and any messages you add after sharing stay private."}):e.jsx(a,{id:"U7wOdx",defaultMessage:"Your name and any messages you add after sharing stay private."})),{modalTitle:s,modalDescription:n})},be=()=>x?e.jsx(a,{...g.copying}):S?e.jsx(a,{id:"zMndTF",defaultMessage:"Copied"}):l?e.jsx(a,{id:"F+gzqW",defaultMessage:"Copy link"}):y?e.jsx(a,{id:"SviHx3",defaultMessage:"Update link"}):e.jsx(a,{id:"Ns/mpl",defaultMessage:"Create link"}),{modalTitle:ye,modalDescription:ke}=pe(),U=be(),Ce=e.jsx(Pe.Button,{onClick:s=>ge(f,p,s),color:"primary",disabled:x||S||f==null||p==null||Z!=null||ae,className:"ms-4 me-0 mt-0 rounded-full px-4 py-1 text-base font-bold sm:py-3",loading:x,icon:l?Be:He,"data-testid":U.props.defaultMessage==="Create link"?"create-link-shared-chat-button":U.props.defaultMessage==="Copied"?"copied-shared-chat-button":void 0,children:U});let I=Z;I==null&&(M?.has_been_auto_blocked||M?.has_been_auto_moderated||M?.has_been_blocked)&&(I=e.jsx(a,{...g.moderationBlocked}));const ve=l?p:window.location.origin+"/share/…",B=o.getState().title??"My ChatGPT conversation",k=!w||se;return e.jsxs($,{isOpen:!0,testId:"modal-sharing",onClose:()=>{xe()},size:"custom",className:"max-w-[550px]",type:"success",title:ye,showCloseButton:!0,children:[ie&&e.jsx("div",{className:"mb-4",children:e.jsx(Fe,{title:nt,content:rt,icon:e.jsx(qe,{"aria-hidden":!0}),type:"info"})}),I!=null&&e.jsx("div",{className:"mb-4 rounded-md bg-red-500 p-4 text-white",children:I}),e.jsx("div",{className:"w-full",children:e.jsx("p",{className:"text-token-text-secondary mb-6",children:e.jsxs("span",{children:[ke," ",!l&&e.jsx("a",{href:j?lt:ot,className:"text-token-text-secondary hover:text-token-text-tertiary inline-flex items-center gap-2 underline",target:"_blank",rel:"noreferrer",children:e.jsx(a,{id:"TKNIin",defaultMessage:"Learn more"})})]})})}),!l&&e.jsx(ct,{shouldShowCodeInterpreterDisclaimer:oe}),l&&!j&&e.jsx("div",{className:"mb-7",onClick:k?me:void 0,role:"checkbox","aria-checked":w,"aria-disabled":!k,tabIndex:0,children:e.jsxs("label",{className:K("flex items-start",{"cursor-pointer":k}),children:[e.jsx("div",{className:"flex h-5 w-5 items-center justify-center",children:ce?e.jsx(J,{className:"icon-md text-token-text-secondary"}):w?e.jsx(We,{className:k?"text-token-text-primary":"text-token-text-secondary"}):e.jsx($e,{})}),e.jsxs("div",{className:"ms-2 leading-tight",children:[e.jsx("div",{className:k?"text-token-text-primary":"text-token-text-secondary",children:e.jsx(a,{id:"Ll7cH+",defaultMessage:"Make this chat discoverable"})}),e.jsx("div",{className:"text-token-text-secondary text-xs",children:k?e.jsx(a,{id:"0Qtyx3",defaultMessage:"Allows it to be shown in web searches"}):e.jsx(a,{id:"NZCrSB",defaultMessage:"<deleteLink>Delete the link</deleteLink> to turn off chat discoverability",values:{deleteLink:s=>e.jsx("a",{href:"#",onClick:n=>{n.preventDefault(),window.confirm(c.formatMessage(g.confirmDeleteLink))&&fe()},className:"underline",children:s})}})})]})]})}),e.jsxs("div",{className:"border-token-border-medium bg-token-main-surface-primary text-token-text-secondary has-focus-visible:border-token-border-xheavy mb-2 flex items-center justify-between rounded-full border p-1.5 last:mb-2 sm:p-2",children:[e.jsxs("div",{className:"relative ms-1 grow",children:[e.jsx("input",{type:"text",readOnly:!0,value:ve,disabled:!l,className:K("bg-token-main-surface-primary w-full rounded-xl border-0 px-2 py-1 text-lg focus:ring-0 sm:py-2.5",l?"text-token-text-primary":"text-token-text-tertiary")}),e.jsx("div",{className:"from-token-main-surface-primary pointer-events-none absolute end-0 top-0 bottom-0 w-12 bg-linear-to-l"})]}),Ce]}),y&&!l&&e.jsx("div",{className:"w-full",children:e.jsx("p",{className:"text-token-text-tertiary mb-3 text-sm",children:e.jsx(a,{id:"A9Jgr5",defaultMessage:"A past version of this chat has already been shared. Manage previously shared chats via <settingsLink>Settings</settingsLink>.",values:{settingsLink:s=>e.jsx("a",{href:"#settings/DataControls",target:"_blank",rel:"noreferrer",className:"hover:text-token-text-quaternary underline",children:s})}})})}),!j&&l&&p&&e.jsxs("div",{className:"mt-6 flex justify-center space-x-14",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("a",{href:`https://www.linkedin.com/shareArticle?url=${encodeURIComponent(p)}&text=${encodeURIComponent(B)}`,target:"_blank",rel:"noopener noreferrer",onClick:()=>{P.logEvent("Share Public Chat: LinkedIn Social Clicked",{shareLinkId:f}),A.logEvent("chatgpt_conversation_share_link_social_clicked","linkedin")},children:e.jsx(ze,{initialBackgroundColor:"var(--main-surface-secondary)",initialFillColor:"var(--text-secondary)"})}),e.jsx("span",{className:"text-token-text-secondary mt-1 text-xs font-semibold",children:e.jsx(a,{id:"YtW6Uh",defaultMessage:"LinkedIn"})})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("a",{href:`https://www.reddit.com/submit?url=${encodeURIComponent(p)}&title=${encodeURIComponent(B)}`,target:"_blank",rel:"noopener noreferrer",onClick:()=>{P.logEvent("Share Public Chat: Reddit Social Clicked",{shareLinkId:f}),A.logEvent("chatgpt_conversation_share_link_social_clicked","reddit")},children:e.jsx(Oe,{initialBackgroundColor:"var(--main-surface-secondary)",initialFillColor:"var(--text-secondary)"})}),e.jsx("span",{className:"text-token-text-secondary mt-1 text-xs font-semibold",children:e.jsx(a,{id:"VLrIK1",defaultMessage:"Reddit"})})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("a",{href:`https://twitter.com/intent/tweet?url=${encodeURIComponent(p)}&text=${encodeURIComponent(B)}`,target:"_blank",rel:"noopener noreferrer",onClick:()=>{P.logEvent("Share Public Chat: X Social Clicked",{shareLinkId:f}),A.logEvent("chatgpt_conversation_share_link_social_clicked","x")},children:e.jsx(Ze,{initialBackgroundColor:"var(--main-surface-secondary)",initialFillColor:"var(--text-secondary)"})}),e.jsx("span",{className:"text-token-text-secondary mt-1 text-xs font-semibold",children:e.jsx(a,{id:"CgECe/",defaultMessage:"X"})})]})]})]})}const ct=({shouldShowCodeInterpreterDisclaimer:t})=>e.jsx(e.Fragment,{children:t&&e.jsx(ut,{icon:Ve,children:e.jsx(a,{id:"iEl3pV",defaultMessage:"Images and files in this chat won't be shown in the public link."})})}),ut=({children:t,icon:d})=>e.jsxs("div",{className:"bg-token-main-surface-secondary text-token-text-secondary mb-4 flex items-center justify-between rounded-2xl p-4 last:mb-0",children:[t,d!=null&&e.jsx(d,{className:"icon-sm mt-1 shrink-0"})]});export{ot as SHARED_LINKS_HELP_URL,xt as default};
//# sourceMappingURL=necqrka1evr4z37n.js.map
