import{fW as S,ad as y,O as b,eP as _}from"./citrwydz0bgriwlc.js";import{D as M,j as e,a9 as N,i as k,f as C,a as F,b as W,M as l}from"./b8ijctzpgh0s7wpx.js";import{dK as A}from"./krbmwir12ubt4od1.js";import{R as P,I as o,S as u}from"./mtu1vp4lzjnp5m0h.js";import{E as R,R as U,g as D}from"./bzuvxfofkq5v3qxn.js";import{u as O}from"./oyi299mxc9s11w2r.js";import{b as T,W as B,i as I,c as L}from"./omp8ie1vzl40ti1z.js";import{W as $}from"./gw319re0na8zpsh7.js";import"./nduxp30o3uqcxibn.js";import"./hz6exfliqj1u3hji.js";import"./mtbwfu1a5yslb3p2.js";import"./kdg6x58wvl6ya91l.js";import"./ftxrqc0rwihsh5tn.js";import"./c4nkx1d9qfqo4ctl.js";import"./jr954f5murhu609u.js";import"./eq7m7kpdgo83dcz8.js";import"./eeyp7d7oqudhas3m.js";import"./nfkxdwnvdjy1s4sn.js";import"./cwi4lsxreiklxbjv.js";import"./fkpvp4h0mv7mwrx3.js";import"./ndqm17bbs5ambnrw.js";import"./megablgldkh4lap1.js";import"./hbpbckirom363mgh.js";import"./jekpe1ukp5thtucq.js";import"./b4v20hsjdnh8a64d.js";import"./ku4zsoy6w4wkp690.js";import"./k1h56nx2kjoqc52m.js";import"./exvo283q5zxd2q6r.js";import"./dcml6fn13vfm1zv2.js";import"./nvghija6qp2cunds.js";import"./djd85tifm57yisqi.js";import"./h3krx8dg2s8o2yh5.js";import"./cfe0bfy5asp94vp2.js";import"./jkznwfhp8ahnvlot.js";import"./izdon3syh095bs23.js";import"./dweroubxngal4vlb.js";import"./i7jya7stlyvnzya0.js";import"./cb2t82g498wwhuc2.js";import"./ndwtlsjk3xm27wkq.js";import"./o0ebhsapkoy5qkg1.js";import"./k7nub2yuxq70se07.js";import"./k6ccgr4wxcppeg93.js";import"./dbalwdodzoo02ru2.js";import"./c2d9eukr2hh7n3q0.js";import"./nnffynscsbaol5fb.js";function q(){const{environmentId:s}=M(),{eligible:i}=A();return i?e.jsx(N,{to:"/codex/onboarding"}):s?e.jsx(z,{environmentId:s}):e.jsx(S,{})}function z({environmentId:s}){const i=k(),a=y(),g=C(),m=F(),{data:n,isLoading:v,isError:h}=T(s),d=n?.secrets??{},x=O()?"workspace":"private",{mutate:f,isPending:E}=W({mutationFn:t=>B.updateEnvironment(s,t),onSuccess:async t=>{await I(m,s),L(m,s,t),a.success(i.formatMessage({id:"wham.editEnvironment.environmentUpdatedSuccessfully",defaultMessage:"Environment updated successfully"})),g(`/codex/settings/environment/${s}`)},onError:()=>{a.danger(i.formatMessage({id:"wham.editEnvironment.failedToUpdateEnvironment",defaultMessage:"Failed to update environment"}))}});function j(t){const r=D(t.secrets,d),w=t.envVars.reduce((c,p)=>(c[p.key]=p.value,c),{});f({label:t.label,repos:[t.repositoryId],machine_id:t.machine,setup:t.setupCommands,workspace_dir:t.workspaceDirectory,agent_network_access:t.agentNetworkAccess,description:t.description,share_settings:t.share_settings,secrets:r,env_vars:w})}return e.jsx($,{flex:!0,hideBorder:!0,showSidebar:!1,maxWidth:"w-full",children:v?e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx(b,{})}):h?e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx(l,{id:"wham.editEnvironment.errorLoadingEnvironment",defaultMessage:"Error loading environment"})}):n?e.jsxs(e.Fragment,{children:[e.jsxs(P,{className:"sticky top-0 px-4",children:[e.jsx(o,{label:i.formatMessage({id:"wham.editEnvironment.environments",defaultMessage:"Environments"}),url:"/codex/settings/environments",className:"text-token-text-tertiary"}),e.jsx(u,{}),e.jsx(o,{label:n.label,url:`/codex/settings/environment/${s}`,className:"font-medium"}),e.jsx(u,{}),e.jsx(o,{label:i.formatMessage({id:"wham.editEnvironment.edit",defaultMessage:"edit"}),className:"text-token-text-tertiary"})]}),e.jsx(R,{initialEnvironmentId:s,existingEnvironment:n,initialValues:{label:n?.label,description:n?.description??"",share_settings:n?.share_settings??x,machine:n?.machine_id,repositoryId:n?.repos[0],workspaceDirectory:n?.workspace_dir??"",agentNetworkAccess:n?.agent_network_access,setupCommands:n?.setup?Array.isArray(n?.setup)?n.setup.join(`
`):n.setup:"",envVars:Object.entries(n?.env_vars??{}).map(([t,r])=>({key:t,value:r})),secrets:Object.keys(d).map(t=>({key:t,value:U,isEditing:!1}))},primaryButtonText:i.formatMessage({id:"wham.editEnvironment.saveEnvironment",defaultMessage:"Save environment"}),onSubmit:j,isPending:E})]}):e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx(l,{id:"wham.editEnvironment.environmentNotFound",defaultMessage:"Environment not found"})})})}const Oe=()=>[{title:"Codex"}],Te=_(function(){return e.jsx(q,{})});export{Te as default,Oe as meta};
//# sourceMappingURL=fy5wxdptqdqrcule.js.map
