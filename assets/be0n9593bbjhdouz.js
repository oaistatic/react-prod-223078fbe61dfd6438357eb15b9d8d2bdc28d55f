import{eQ as q,be as V,lL as J,au as j,lM as Q,lN as Z,lO as ee,lP as O,eg as A,g6 as te,lQ as ne,iz as se,lR as P,lS as oe,lT as re,lU as ae,lV as ie,lW as ce,lX as le,bf as S,lY as ue,lZ as w,l_ as W,l$ as pe,m0 as de,m1 as fe,bj as _e,aW as me}from"./krbmwir12ubt4od1.js";import{eH as E,e as d,ab as ge,ac as he,B as ke,ak as xe,j as L,dr as Ce,k as ye,c as ve,ae as be,s as v,N as b,b1 as B,aJ as Se,db as Ee,gY as we,aM as Le,eX as H,gZ as Me}from"./citrwydz0bgriwlc.js";import{r as k,i as Re,j as l,M as R,R as M}from"./b8ijctzpgh0s7wpx.js";import{d as Ne,e as De,u as Te}from"./nvghija6qp2cunds.js";import{r as Ue}from"./gbxx25eoj7wtyna0.js";import{u as I,d as Fe}from"./ku4zsoy6w4wkp690.js";import{u as je}from"./exvo283q5zxd2q6r.js";import{k as N}from"./pc2givv05uuq8g6l.js";function Oe({closeModal:t,url:e,onAction:n,onActionAborted:a}){const s=k.useRef(!1),r=Re(),{clientThreadId:i}=Ne(),c={...E({clientThreadId:i}),url:e,link_type:"text",section:"safe-link-modal"};k.useEffect(()=>{d.logEventWithStatsig("Safe Link Warning Modal Shown","chatgpt_safe_link_warning_modal_shown")},[]);const u=async()=>{s.current=!0;try{await navigator.clipboard.writeText(e),d.logEventWithStatsig("Safe Link Warning Modal Copy Clicked","chatgpt_safe_link_warning_modal_copy_clicked"),d.logEventWithStatsig("link_action","link_action",{...c,action:"copy"})}catch(x){xe.addError(x)}n?.("copy"),t()},g=()=>{s.current=!0,d.logEventWithStatsig("Safe Link Warning Modal Open Clicked","chatgpt_safe_link_warning_modal_open_clicked"),d.logEventWithStatsig("link_action","link_action",{...c,action:"click"}),n?.("open"),t()},f=()=>{s.current||(d.logEventWithStatsig("Safe Link Warning Modal Canceled","chatgpt_safe_link_warning_modal_canceled"),a?.()),s.current=!1,t()};let h="",m=e,p="";try{m=new URL(e).hostname;const _=e.indexOf(m);_!==-1&&(h=e.substring(0,_),p=e.substring(_+m.length))}catch{}return l.jsxs(ge,{testId:"modal-safe-link-warning",isOpen:!0,hideSeparator:!0,onClose:f,showCloseButton:!0,type:"warning",title:l.jsx("div",{className:"flex items-center gap-2",children:r.formatMessage({id:"KXMlta",defaultMessage:"This link isn't verified"})}),primaryButton:l.jsx(ke,{as:"link",openNewTab:!0,rel:"noopener noreferer",color:"primary",onClick:g,to:e,children:r.formatMessage({id:"gMzmDW",defaultMessage:"Open link"})}),secondaryButton:l.jsx(he.Button,{title:r.formatMessage({id:"YGLt71",defaultMessage:"Copy link"}),color:"secondary",onClick:u}),children:[l.jsxs("p",{className:"text-token-text-secondary -mt-4 mb-6 text-sm text-pretty sm:-mt-7",children:[l.jsx(R,{defaultMessage:"Make sure you trust this link before proceeding. If you don't recognize the URL, don't open the link to access the site.",id:"safe-link-warning-modal-description"}),l.jsx("a",{className:"can-hover:hover:text-token-link-hover ps-1 underline underline-offset-1",href:"https://help.openai.com/en/articles/10984597-chatgpt-generated-links",target:"_blank",rel:"noopener noreferrer",children:l.jsx(R,{id:"xNvPsR",defaultMessage:"Learn more"})})]}),l.jsxs("div",{className:"mb-2 text-sm break-all",children:[l.jsx("span",{className:"text-token-text-secondary",children:h}),l.jsx("span",{className:"text-token-text-primary font-medium",children:m}),l.jsx("span",{className:"text-token-text-secondary",children:p})]})]})}const D={},T={},U={};function F(t,e){return`${t}::${e}`}function Ae({node:t,onClick:e,children:n,clientThreadId:a,messageId:s,href:r,disableSafeURLs:i,...o}){let c=e;const u=t?.properties?.href,g=q(),f=k.useContext(V),h=L(),m=Ce(a),p=J(m,r,f?.useSafeUrls&&!i),x=ye(h,"387775177"),_=!i&&p===void 0&&x.get("enable-copy-and-open",!1);return s!=null&&typeof u=="string"&&u.includes("/bing/redirect")&&(D[s]||(d.logEvent("Browsing Show Bing Link",{id:s,content:u}),D[s]=!0),c=C=>{T[s]||(d.logEvent("Browsing Click Bing Link",{id:s,content:u}),T[s]=!0),e?.(C)}),c=C=>{const y=""+u;if(s&&!U[F(s,y)]){const $=p||_?"URL Clicked Allowed":"URL Clicked Blocked";d.logEvent($,{id:s,content:y}),U[F(s,y)]=!0}e?.(C),_&&r&&be(h,Oe,{url:r})},l.jsx(l.Fragment,{children:l.jsx("a",{onClick:c,...o,className:ve(o.className,_&&"cursor-pointer"),href:p,rel:g?"noopener noreferrer":"noopener",children:n})})}const lt="w";function Pe({messageId:t,clientThreadId:e,text:n,children:a,...s}){const i=`${window.location.origin}?q=${encodeURIComponent(n)}`,o=De(),c=k.useCallback(async u=>{u.preventDefault(),v.count(b.DEFAULT,"instant_follow_up_anchor_clicked"),d.logEventWithStatsig("Instant Follow Up Anchor Clicked","chatgpt_instant_follow_up_anchor_clicked",{clientThreadId:e,messageId:t}),o(u,{text:n,type:j.Reply},[],0)},[e,t,n,o]);return l.jsx(Ae,{...s,href:i,disableSafeURLs:!0,clientThreadId:e,messageId:t,className:"cursor-pointer",onClick:c,children:a})}const ut=M.memo(Pe),We={},Be=[];function G(t){const e=t||We;return function(n,a){Q(n,"element",function(s,r){const i=Array.isArray(s.properties.className)?s.properties.className:Be,o=i.includes("language-math"),c=i.includes("math-display"),u=i.includes("math-inline");let g=c;if(!o&&!c&&!u)return;let f=r[r.length-1],h=s;if(s.tagName==="code"&&o&&f&&f.type==="element"&&f.tagName==="pre"&&(h=f,f=r[r.length-2],g=!0),!f)return;const m=Z(h,{whitespace:"pre"});let p;try{p=N.renderToString(m,{...e,displayMode:g,throwOnError:!0})}catch(_){const C=_,y=C.name.toLowerCase();a.message("Could not render math with KaTeX",{ancestors:[...r,s],cause:C,place:s.position,ruleId:y,source:"rehype-katex"}),y==="parseerror"?p=N.renderToString(m,{...e,displayMode:g,strict:"ignore",throwOnError:!1}):p=[{type:"element",tagName:"span",properties:{className:["katex-error"],style:"color:"+(e.errorColor||"#cc0000"),title:String(_)},children:[{type:"text",value:m}]}]}typeof p=="string"&&(p=ee(p).children);const x=f.children.indexOf(h);return f.children.splice(x,1,...p),O})}}const pt="f",dt="dr",K=(t,e,n=!1)=>{const a=k.useRef(!1);k.useEffect(()=>{a.current||(a.current=!0,v.count(b.DEFAULT,"clickable_follow_up_text_shown"),n&&v.count(b.DEFAULT,"clickable_follow_up_deep_research_text_shown"),d.logEventWithStatsig("Clickable Follow Up Text Shown","chatgpt_clickable_follow_up_text_shown",{...E({clientThreadId:t,messageId:e})}))},[t,e,n])},Y=({messageId:t,clientThreadId:e,text:n})=>{const a=I(e),s=je(),r=A(e);K(e,t,!1);const i=k.useCallback(o=>{o.preventDefault(),v.count(b.DEFAULT,"clickable_follow_up_text_clicked"),d.logEventWithStatsig("Clickable Follow Up Text Clicked","chatgpt_clickable_follow_up_text_clicked",E({clientThreadId:e,messageId:t})),a({sourceEvent:o,promptMessage:Ee(n.toLowerCase(),{suggestion_type:j.Reply}),completionMetadata:{systemHints:[...s],conversationMode:r??{kind:Se.PrimaryAssistant}}})},[e,r,t,s,a,n]);return l.jsx("span",{className:"decoration-token-text-secondary hover:text-token-text-secondary cursor-pointer underline decoration-dotted decoration-[12%] underline-offset-4 transition-colors duration-200 ease-in-out",onClick:i,children:n})},He=({messageId:t,clientThreadId:e,text:n})=>{const a=L();return B(a,"2723331665")?l.jsx(Y,{messageId:t,clientThreadId:e,text:n}):l.jsx("span",{children:n})},ft=M.memo(He),Ie=({messageId:t,clientThreadId:e,text:n})=>{const a=Te(),{setThreadSystemHintMode:s}=Fe(),r=!!we(),i=I(e),o=A(e);K(e,t,!0);const c=k.useCallback(u=>{u.preventDefault(),v.count(b.DEFAULT,"clickable_follow_up_text_clicked"),v.count(b.DEFAULT,"clickable_follow_up_deep_research_text_clicked"),d.logEventWithStatsig("Clickable Follow Up Text Clicked","chatgpt_clickable_follow_up_text_clicked",E({clientThreadId:e,messageId:t}));const g={clientThreadId:e};s(Le.Research,!0,g),a.focus(),a.setText(n)},[e,t,n,a,s,o,i]);return r?l.jsx(Y,{messageId:t,clientThreadId:e,text:n}):l.jsxs("span",{className:"decoration-token-text-secondary hover:text-token-text-secondary cursor-pointer underline decoration-dotted decoration-[12%] underline-offset-4 transition-colors duration-200 ease-in-out",onClick:c,children:[l.jsx(te,{className:"icon me-1 inline-block"}),n]})},Ge=({messageId:t,clientThreadId:e,text:n})=>{const a=L();return B(a,"2723331665")?l.jsx(Ie,{messageId:t,clientThreadId:e,text:n}):l.jsx("span",{children:n})},_t=M.memo(Ge),mt=t=>(t.startsWith(ue),t);function Ke(){return t=>{S(t,"list",e=>{for(const n of e.children)n.spread=!0})}}function gt(t){return e=>{S(e,n=>{Object.defineProperties(n,{markdownSource:{get(){return t.slice(this.position.start.offset,this.position.end.offset)}}})})}}const z=[oe,re,Ke,[ae,{singleDollarTextMath:!1}],ie,ce,Ue,le,Ye,Xe];function Ye(){return t=>{S(t,"textDirective",e=>{e.name!==H&&(e.type="text",e.value=`:${e.name}`)})}}const ze=/\u200b/g;function Xe(){return t=>{S(t,"text",e=>{e.value=e.value.replace(ze,"")})}}function $e(){return t=>{const e=t.position?.end.offset;S(t,"element",(n,a)=>{const{position:s}=n;if(!s)return;const{start:r,end:i}=s,o=r.offset,c=i.offset;n.properties??={},o!=null&&(n.properties["data-start"]=o),c!=null&&(n.properties["data-end"]=c,e===c&&(n.properties["data-is-last-node"]=""),a===t.children.length-1&&(n.properties["data-is-only-node"]=""))})}}const ht=[G,$e,ne,[se,{target:"_new",rel:"noopener noreferrer"}],P],qe=[[G,{output:"mathml"}],P];function Ve(t,e){const n=Me(t,e);return X(n,e)}function X(t,e){const n=w().use(W).use(z).use([[Ze,e??[]]]).use(pe,{rule:"-",tightDefinitions:!0,handlers:{break:()=>`
`,link:Je}}),a=w().use(de).use(qe).use(fe),s=n.runSync(n.parse(t)),r=n.stringify(s),i=a.stringify(a.runSync(s));return{"text/plain":r,"text/html":i}}const Je=(t,e,n,a)=>{const s=n.createTracker(a),r=n.enter("link"),i=n.enter("label");let o=s.move("[");return o+=s.move(n.containerPhrasing(t,{before:o,after:"](",...s.current()})),o+=s.move("]("),i(),o+=s.move(t.url.replace(/[\x00-\x1F\x7F-\x9F()"]/g,Qe)),t.title&&(o+=s.move(" "+JSON.stringify(t.title))),o+=s.move(")"),r(),o};function Qe(t){return"%"+t.charCodeAt(0).toString(16).toUpperCase().padStart(2,"0")}function Ze(t){return e=>{const n={},a=(s,r)=>{switch(r.type){case"grouped_webpages":{const i=[];for(const o of r.items)if(o.url&&o.title){let c=n[o.url];c||(c=n[o.url]={type:"definition",identifier:String(Object.keys(n).length+1),url:o.url,title:o.title}),i.push({type:"linkReference",referenceType:"shortcut",identifier:c.identifier,children:[{type:"text",value:o.attribution??me(o.url)}]})}return i.length===0?[]:[{type:"text",value:"("},...i.flatMap((o,c,u)=>c<u.length-1?[o,{type:"text",value:", "}]:[o]),{type:"text",value:")"}]}case"title_citation":case"location_search":case"time":case"image_v2":case"nav_list":case"file_navlist":case"file":case"grouped_webpages_model_predicted_fallback":case"tldr":case"navigation":case"stock":case"calculator":case"code_execution":case"forecast":case"businesses_map":case"video":case"sources_footnote":case"sports_standings":case"sports_schedule":case"attribution":case"webpage_extended":case"image_inline":case"product_entity":case"products":case"alt_text":case"product_reviews":case"product_rationale":if(r.alt){const i=w().use(W).use(z).parse(r.alt);if(s.type!=="textDirective")return i.children;const o=i.children[0];if(o.type==="paragraph")return o.children}return[];case"hidden":case"status":case"optimistic_image_citation":case"webpage":case"optimistic_image_inline":case"invalid":case"attribution_footer":case"sports":case"grouped_webpages_v2":return[]}};S(e,_e,(s,r,i)=>{if(i==null||r==null)return;const o=et(s,t),c=o?a(s,o)??[s]:[];return i.children.splice(r,1,...c),[O,r+c.length]}),e.children.push(...Object.values(n))}}function et(t,e){if(t.name===H){const n=t.attributes?.index;if(n)return e[parseInt(n,10)]}}const kt=Object.freeze(Object.defineProperty({__proto__:null,markdownToClipboardContent:X,messageTextToClipboardContent:Ve},Symbol.toStringTag,{value:"Module"}));export{pt as C,lt as I,Ae as M,z as R,ht as a,X as b,ut as c,ft as d,dt as e,_t as f,kt as g,Ve as m,gt as r,mt as u};
//# sourceMappingURL=be0n9593bbjhdouz.js.map
