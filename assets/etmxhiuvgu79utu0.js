import{j as t,r as u,a5 as N}from"./b8ijctzpgh0s7wpx.js";import{aT as H,aU as $,aV as Y,E as V,aW as z,aX as Z,aY as J,aZ as Q,a_ as I,a$ as ee}from"./krbmwir12ubt4od1.js";import{u as te,c as b,aD as ne,ah as se,bh as ae}from"./citrwydz0bgriwlc.js";function xe(e){return H(),null}function he(e){if(H()){if(e.webpageRef.fallback_items){const n={...e,webpageRef:{...e.webpageRef,items:e.webpageRef.fallback_items,fallback_items:void 0}};return t.jsx(P,{...n})}return null}return t.jsx(P,{...e})}function P({webpageRef:e,trackContentReferenceEvent:s,messageId:n,index:i}){const[a,o]=u.useState(null);switch(e.status){case"loading":return null;default:return t.jsx(t.Fragment,{children:e.items.map((d,l)=>{const m=a===l;return t.jsx(ie,{webpageItem:d,trackContentReferenceEvent:s,onMouseEnter:()=>{o(l)},isLastHovered:m,messageId:n,analyticsMetadata:{section:"inline",section_location:"response",section_index:d.section_index},index:i},`${l}-${d.url}`)})})}}const E={prev:{x:"0%",opacity:0,pointerEvents:"none",transition:{duration:.1,ease:"easeOut"}},cur:{x:"0",opacity:1,pointerEvents:"auto",transition:{duration:.15,ease:"easeOut"}},next:{x:"5%",opacity:0,pointerEvents:"none",transition:{duration:.1,ease:"easeOut"}}};function ie({webpageItem:e,className:s,trackContentReferenceEvent:n,onMouseEnter:i,isLastHovered:a,messageId:o,analyticsMetadata:d,index:l,noMarginStart:m}){const p=c=>({url:c.url,title:c.title,pub_date:Y(c.pub_date),sub_pill_index:c.sub_pill_index,link_type:"pill",...d}),g=e.supporting_websites?.length??0,[v,j]=u.useState(!1),[F,q]=u.useState(!1),r=(v||F)&&a,_=u.useRef(r);r||(_.current=!1);const C=!r||!_.current,k=u.useRef(null),[w,A]=u.useState(null);u.useEffect(()=>{k.current=null,A(null)},[e]),te(()=>{if(k.current){const{offsetWidth:c}=k.current;A(c+1)}},[]),u.useEffect(()=>{a&&(r?$.setHighlightBySource(o,e):$.clearHighlights())},[r,a,o,e]);const x=[e,...e.supporting_websites??[]],[f,B]=u.useState(0),M=c=>{c!==f&&r&&(_.current=r),B(c)},y=x[f]??e,L=h(f-1,x.length),O=h(f+1,x.length),R={url:y.url,title:y.title,pub_date:y.pub_date,sub_pill_index:f};u.useEffect(()=>{r||M(0)},[r]);const T=ce(o,l??0,f);u.useEffect(()=>{T||(n("link_action","link_action","webpage",{...p(R),action:"show"}),ue(o,l??0,f))},[T]);const D=()=>{n("link_action","link_action","webpage",{...p(R),action:"click"})},K=c=>{c&&n("link_action","link_action","webpage",{...p(R),action:"hover"}),q(c)},X=t.jsx("span",{ref:k,className:b(!m&&"ms-1","inline-flex max-w-full items-center","relative top-[-0.094rem]","animate-[show_150ms_ease-in]"),style:w?{width:w}:void 0,children:t.jsx(V,{href:y.url,className:b("flex h-4.5 overflow-hidden rounded-xl px-2 text-[0.5625em] font-medium",r?"bg-token-text-primary! text-token-main-surface-primary!":"text-token-text-secondary! bg-[#F4F4F4]! dark:bg-[#303030]!","transition-colors duration-150 ease-in-out",s),style:w?{maxWidth:w}:void 0,onClick:D,onMouseEnter:()=>{i?.(),j(!0)},onMouseLeave:()=>{j(!1)},children:t.jsxs("span",{className:"relative start-0 bottom-0 flex h-full w-full items-center",children:[x.length>2&&t.jsx(W,{variant:"prev",item:x[L],numAdditionalSupportingWebsites:g,isActive:r??!1,shouldShowSupportingCount:C,className:"absolute"},L),t.jsx(W,{variant:"cur",item:x[f],numAdditionalSupportingWebsites:g,isActive:r??!1,shouldShowSupportingCount:C},f),x.length>1&&t.jsx(W,{variant:"next",item:x[O],numAdditionalSupportingWebsites:g,isActive:r??!1,shouldShowSupportingCount:C,className:"absolute"},O)]})})});return t.jsx(oe,{webpageItem:e,open:F&&a,onOpenChange:K,onClick:D,currentItemIndex:f,setCurrentItemIndex:M,children:X})}function W({className:e,variant:s,item:n,numAdditionalSupportingWebsites:i,isActive:a,shouldShowSupportingCount:o,...d}){const l=o&&i>0;return t.jsxs(N.span,{variants:{prev:{x:"0%",opacity:0,transition:{duration:.1,ease:"easeOut"}},cur:{x:"0",opacity:1,transition:{duration:.1,ease:"easeOut"}},next:{x:"10%",opacity:0}},animate:s,initial:s,className:b("flex h-4 w-full items-center justify-between",!l&&"overflow-hidden",e),...d,children:[t.jsx("span",{className:"max-w-full grow truncate overflow-hidden text-center",children:n.attribution??z(n.url)}),l&&t.jsxs("span",{className:b("-me-1 flex h-full items-center rounded-full px-1 text-[#8F8F8F]",a&&"text-token-main-surface-tertiary"),children:["+",i]})]})}function oe({webpageItem:e,onClick:s,open:n,onOpenChange:i,children:a,currentItemIndex:o,setCurrentItemIndex:d,className:l}){const m=se(),p=t.jsx(le,{webpageItem:e,onClick:s,currentItemIndex:o,setCurrentItemIndex:d});return t.jsx(Z,{label:p,onOpenChange:i,open:n,side:"bottom",delayDuration:150,theme:m?"default":"white",align:"start",customPaddingClassName:"p-0",cornerRadius:"xl",customBorderClassName:"border-token-border-default border",contentClassName:"animate-show",className:l,wide:!0,interactive:!0,children:a})}function S({item:e,onClick:s}){if(!e)return null;const n=e.pub_date!=null?new Date(e.pub_date*1e3):null;return t.jsxs(V,{className:"flex flex-col gap-2 p-3",href:e.url,onClick:s,children:[t.jsxs("div",{className:"flex gap-1.5",children:[t.jsx("div",{className:"h-4 w-4 shrink-0 overflow-hidden rounded-full",children:t.jsx(I,{url:e.url,size:"xsmall",className:"icon-sm",connectorSource:e.attribution?.toLowerCase(),fallback:t.jsx(ee,{url:e.url,size:32,minSize:16,className:"icon-sm"})})}),t.jsx("div",{className:"text-token-text-primary truncate",children:e.attribution??z(e.url)})]}),t.jsx("div",{className:"line-clamp-2 text-sm font-medium",children:e.title}),t.jsxs("div",{className:"text-token-text-secondary line-clamp-2 text-sm",children:[re(n),n&&e.snippet&&" â€” ",e.snippet]})]})}function le({webpageItem:e,onClick:s,currentItemIndex:n,setCurrentItemIndex:i}){const a=[e,...e.supporting_websites??[]],o=a[n??0],d=n!=null&&`${n+1}/${a.length}`,l=n?a[h(n+1,a.length)]:void 0,m=n?a[h(n-1,a.length)]:void 0,p=()=>{n!=null&&i?.(h(n+1,a.length))},g=()=>{n!=null&&i?.(h(n-1,a.length))};u.useEffect(()=>ae(document,{keydown:j=>{j.key==="ArrowRight"?p():j.key==="ArrowLeft"&&g()}}));const v=b("flex flex-col dark:bg-token-main-surface-secondary");return t.jsxs("span",{className:"text-token-text-primary flex flex-col text-start text-xs font-normal no-underline!",children:[n!=null&&a.length>1&&t.jsxs("div",{className:"bg-token-main-surface-secondary dark:bg-token-main-surface-tertiary flex h-9 items-center justify-between gap-1.5",children:[t.jsxs("div",{className:"text-token-text-secondary mx-1.5 flex gap-1",children:[t.jsx("button",{onClick:g,className:"hover:bg-token-border-xlight disabled:text-token-text-quaternary h-6 w-6 rounded-md disabled:hover:bg-transparent",children:t.jsx(J,{className:"icon-sm m-auto"})}),t.jsx("button",{onClick:p,className:"hover:bg-token-border-xlight disabled:text-token-text-quaternary h-6 w-6 rounded-md disabled:hover:bg-transparent",children:t.jsx(Q,{className:"icon-sm m-auto"})})]}),t.jsx("span",{className:"text-token-text-tertiary mx-3.5",children:d})]}),n!=null&&a.length>1?t.jsxs("div",{className:"flex overflow-hidden",children:[a.length>2&&t.jsx(N.span,{className:b(v,"absolute"),variants:E,animate:"prev",initial:"prev",children:t.jsx(S,{item:m,onClick:s})},h(n-1,a.length)),t.jsx(N.span,{className:v,variants:E,animate:"cur",initial:"cur",children:t.jsx(S,{item:o,onClick:s})},n),a.length>1&&t.jsx(N.span,{className:b(v,"absolute"),variants:E,animate:"next",initial:"next",children:t.jsx(S,{item:l,onClick:s})},h(n+1,a.length))]}):t.jsx("div",{className:v,children:t.jsx(S,{item:o,onClick:s})})]})}function re(e){return e&&e.toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric"})}function h(e,s){return(e%s+s)%s}const G=ne(()=>({}));function U(e,s,n){return`${e}-${s}-${n}`}function ce(e,s,n){return G(i=>i[U(e,s,n)])}function ue(e,s,n){G.setState(i=>({...i,[U(e,s,n)]:1}))}export{ie as W,he as a,oe as b,xe as c};
//# sourceMappingURL=etmxhiuvgu79utu0.js.map
