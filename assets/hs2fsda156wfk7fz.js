import{i as U,r,j as e,a6 as L,a5 as F,M as i}from"./b8ijctzpgh0s7wpx.js";import{am as z,al as D,d as $,U as J,P as K,bJ as R}from"./krbmwir12ubt4od1.js";import{aQ as q,e as Q,S as V,ab as W,B as Z,F as H}from"./citrwydz0bgriwlc.js";const O=5,X="Default";function Y(n){const o={};return n.forEach(c=>{const l=c.group??X;o[l]||(o[l]=[]),o[l].push(c)}),o}function ae({tagOptions:n,onSubmit:o,onMoreClicked:c,onCancel:l,maxInlineTags:E=O,modalOnly:u=!1,modalTitle:_,multiple:w,children:P,allowEmptySubmit:A=!1}){const v=U(),[m,d]=r.useState(u?"modal":"inline"),[a,j]=r.useState([]),[f,B]=r.useState(void 0),{eligible:x,markAsViewed:y}=z(D.hasSeenInlineFeedbackCustomInstrMessage),T=x?4e3:1500,[b,G]=r.useState(!1),p=r.useCallback(s=>{o(s),d("submitted");const t=["Too chatty or casual","Don't like the style"];G(s.tags.some(g=>t.includes(g))),setTimeout(()=>{d("closed"),x&&b&&y()},T)},[o,T,x,y,b]),k=r.useMemo(()=>$(p,500),[p]),C=s=>{let t=[];return w?t=a.includes(s)?a.filter(g=>g!==s):[...a,s]:t=[s],j(t),t},M=()=>{p({tags:a,textFeedback:f,tagChoices:I,source:"modal"})},I=n.map(s=>s.value),N=Y(n),S=Object.keys(N);return e.jsxs(e.Fragment,{children:[!u&&e.jsx(L,{children:m!=="closed"&&e.jsxs(F.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"min-h-[96px] w-full",children:[m==="submitted"&&e.jsx(F.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:"text-center",children:e.jsx("div",{className:"border-token-border-default inline-flex rounded-lg border p-4",children:e.jsx("div",{className:"text-sm",children:x&&b?e.jsx(e.Fragment,{children:e.jsx(i,{id:"ConversationTurnInlineMessageFeedback.customInstructions",defaultMessage:"Thanks! If ChatGPT's style isn't quite right, you can also <link>customize its responses</link>.",values:{link:s=>e.jsx("span",{onClick:()=>{J.openModal(K.UserContext),q.logEvent("chatgpt_user_context_inline_feedback_message_clicked"),Q.logEvent("User Context Inline Feedback Message Clicked")},className:"text-token-text-primary cursor-pointer font-semibold",children:s})}})}):e.jsx(i,{id:"ConversationTurnInlineMessageFeedback.submitted",defaultMessage:"Thanks for your feedback!"})})})}),["inline","modal"].includes(m)&&e.jsxs("div",{className:"border-token-border-default relative mt-2 flex w-full flex-col gap-3 rounded-lg border p-4",children:[e.jsx("button",{className:"absolute end-4 top-4 text-sm font-bold",onClick:()=>{d("closed"),k.cancel(),l?.()},children:e.jsx(V,{className:"icon-md text-token-text-secondary hover:text-token-text-primary"})}),e.jsx("div",{className:"text-token-text-secondary text-sm",children:e.jsx(i,{id:"ConversationTurnInlineMessageFeedback.inlineTitle",defaultMessage:"Tell us more:"})}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[n.slice(0,E).map(s=>e.jsx(h,{"aria-pressed":a.includes(s.value),"aria-selected":a.includes(s.value),$selected:a.includes(s.value),onClick:()=>{const t=C(s.value);k({tags:t,tagChoices:I,source:"inline"})},children:s.label},s.value)),e.jsx(h,{onClick:()=>{c?.(),k.cancel(),d("modal")},children:e.jsx(i,{id:"ConversationTurnInlineMessageFeedback.moreOptions.1",defaultMessage:"More..."})})]})]})]},"main")}),m==="modal"&&e.jsxs(W,{type:"success",testId:"modal-inline-feedback",isOpen:!0,className:"max-w-xl",size:"custom",title:_??e.jsx(i,{id:"ConversationTurnInlineMessageFeedback.modalTitle",defaultMessage:"Provide additional feedback"}),onClose:()=>{j([]),d(u?"closed":"inline"),u&&l?.()},showCloseButton:!0,primaryButton:e.jsx(Z,{color:"primary",disabled:a.length===0&&!f&&!A,onClick:M,children:e.jsx(i,{id:"ConversationTurnInlineMessageFeedback.submit",defaultMessage:"Submit"})}),rootClassName:"z-50",children:[e.jsx("div",{className:"flex flex-col gap-6",children:S.map(s=>e.jsxs("div",{children:[S.length>1&&e.jsx("div",{className:"mb-3 text-sm font-semibold",children:s}),e.jsx("div",{className:"flex flex-wrap gap-3",children:N[s].map(t=>e.jsx(h,{$selected:a.includes(t.value),onClick:()=>C(t.value),children:t.label},t.value))},s)]},s))}),e.jsx(R,{ariaLabel:v.formatMessage({id:"Z3Ja/T",defaultMessage:"Additional feedback"}),name:"feedback",type:"text",className:"mt-6",placeholder:v.formatMessage({id:"ConversationTurnInlineMessageFeedback.feedbackPlaceholder.1",defaultMessage:"(Optional) Feel free to add specific details"}),value:f??"",onChange:s=>B(s.target.value),onPressEnter:M}),e.jsx("div",{className:"bg-token-main-surface-secondary text-token-text-secondary mt-4 rounded-lg p-3 text-xs",children:e.jsx(i,{id:"n8n3KW",defaultMessage:"Submitting feedback will include this full conversation to help improve ChatGPT, even if 'Improve the model for everyone' is turned off. <link>Learn more</link>",values:{link:s=>e.jsx("a",{href:"https://help.openai.com/en/articles/5722486-how-your-data-is-used-to-improve-model-performance",target:"_blank",rel:"noopener noreferrer",className:"text-token-text-secondary underline",children:s})}})}),P]})]})}const h=H.button`
  rounded-lg border border-token-border-default px-3 py-1 text-sm text-token-text-secondary hover:text-token-text-primary hover:bg-token-main-surface-secondary
  ${({$selected:n})=>n&&"bg-token-text-primary! text-token-main-surface-primary!"}
`;export{ae as I,h as T};
//# sourceMappingURL=hs2fsda156wfk7fz.js.map
