import{j as e,e as ie,r as u,M as c,L as Z,i as q,b as Re,a as la,u as Pe,f as Fe,p as ra,k as ca,ar as da}from"./b8ijctzpgh0s7wpx.js";import{e as m,B as I,b8 as ua,ba as y,aq as Xe,aQ as X,bX as Mt,aN as Oe,aU as Be,j as ma,ad as pe,b as Ke,hq as pa,ab as ce,O as Ce,S as xt,an as ga,ac as dt,hr as We,dz as _t,dA as bt,dB as Ct,dC as Pt,dD as St,aD as fa,f as ha,aI as Ve,aF as Ge,am as me,au as ya,aL as He,dS as Ye,l as ut,ak as vt,s as Ma,N as xa,c as mt,hs as _a}from"./citrwydz0bgriwlc.js";import{S as ba}from"./kdg6x58wvl6ya91l.js";import{tP as Ca,tQ as Se,tR as W,tS as Et,tT as wt,tU as Pa,tV as Qe,tW as Sa,ln as va,qB as jt,tX as ue,ar as qe,aq as $e,as as ze,qz as Ea,mL as wa,qD as kt,tY as Tt,tZ as _e,t_ as Le,pq as ja,ap as ka,en as At,t$ as ee,u0 as Ta,u1 as Nt,u2 as Ft,aX as be,u3 as Aa,ao as Na,mG as Fa,mH as Oa,u4 as Je,u5 as Ia,fB as Da,fF as Ua,u6 as Ot,U as La,dT as Ra,u7 as It,u8 as Ba,jd as Wa,i0 as Va,u9 as Ga,ua as Ha}from"./krbmwir12ubt4od1.js";import{I as Dt}from"./jp8vfu1j2k44ihab.js";import{C as pt}from"./kiu8mnh8zq7ap0rb.js";import{u as Ya,a as qa}from"./5zi2blh3j6mzx1uc.js";import{a as $a,b as za,M as Za}from"./dweroubxngal4vlb.js";function Xa({value:t,onChange:a}){return e.jsx(ba,{value:t,onChange:a,ariaLabel:ye.toggleArialabel,leftItem:{ariaLabel:ye.togglePersonalArialabel,label:ye.togglePersonalLabel,value:"personal"},rightItem:{ariaLabel:ye.toggleBusinessArialabel,label:ye.toggleBusinessLabel,value:"business"}})}const ye=ie({toggleArialabel:{id:"U4v2Gf",defaultMessage:"Toggle for switching between Personal and Business plans"},togglePersonalArialabel:{id:"6Wikht",defaultMessage:"Toggle for switching to Personal plans"},toggleBusinessArialabel:{id:"uzlEV0",defaultMessage:"Toggle for switching to Business plans"},togglePersonalLabel:{id:"cGDsaD",defaultMessage:"Personal"},toggleBusinessLabel:{id:"sgisa2",defaultMessage:"Business"}}),Ut=t=>u.createElement("svg",{width:21,height:20,viewBox:"0 0 21 20",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...t},u.createElement("path",{d:"M10.2441 10.7759C12.7597 10.8965 14.8838 12.8648 14.8838 15.0601C14.8838 15.4273 14.586 15.7251 14.2188 15.7251H5.78125C5.41399 15.7251 5.11623 15.4273 5.11621 15.0601C5.11621 12.7959 7.37906 10.77 10 10.77L10.2441 10.7759Z"}),u.createElement("path",{d:"M0 14.436C0 11.5616 3.13043 10.5652 5.2998 11.4478C4.37179 12.4185 3.78619 13.6736 3.78613 15.0601L3.78809 15.1011H0.665039C0.298096 15.1011 0.000527744 14.8029 0 14.436Z"}),u.createElement("path",{d:"M14.7988 11.5532C16.969 10.4969 20.3301 11.4561 20.3301 14.436C20.3295 14.8029 20.032 15.1011 19.665 15.1011H16.2119L16.2139 15.0601C16.2138 13.7223 15.6689 12.5079 14.7988 11.5532Z"}),u.createElement("path",{d:"M3.4248 5.00146C4.85516 5.00146 6.01454 6.16098 6.01465 7.59131C6.01454 9.02164 4.85516 10.1812 3.4248 10.1812C1.99454 10.181 0.835068 9.02157 0.834961 7.59131C0.835066 6.16105 1.99454 5.00157 3.4248 5.00146Z"}),u.createElement("path",{d:"M16.5703 5.00146C18.0006 5.00157 19.1601 6.16105 19.1602 7.59131C19.16 9.02157 18.0006 10.181 16.5703 10.1812C15.14 10.1812 13.9806 9.02164 13.9805 7.59131C13.9806 6.16098 15.14 5.00146 16.5703 5.00146Z"}),u.createElement("path",{d:"M10 4.27002C11.6099 4.27002 12.915 5.57515 12.915 7.18506C12.915 8.79497 11.6099 10.1001 10 10.1001C8.39009 10.1001 7.08496 8.79497 7.08496 7.18506C7.08496 5.57515 8.39009 4.27002 10 4.27002Z"})),et=()=>{m.logEvent("Account Portal: Click Get Help")};function Ka(t){if(ua(t))return"secondary";switch(t){case y.FREE:return"green";case y.PLUS:return"green";case y.TEAM:return"primary";case y.PRO:return"primary";default:throw new Error(`Invalid plan type: ${t}`)}}function Ae({isCurrentPlan:t,planType:a,disabled:s,loading:o=!1,onClick:l,children:i,testId:n,activeColor:g,...p}){return e.jsx(I,{fullWidth:!0,size:"large",color:t?"secondary":g||Ka(a),disabled:s,loading:o,onClick:l,"data-testid":n,className:s?"bg-token-sidebar-surface-tertiary text-token-text-primary hover:bg-token-sidebar-surface-tertiary dark:bg-token-text-tertiary border-none font-semibold":"font-semibold",...p,children:i})}function tt(t,a){const[s,o]=u.useState(!1);u.useEffect(()=>{if(!s){o(!0);return}t?m.logEventWithStatsig("Email Verify Popup Shown","chatgpt_email_verify_popup_shown",a):m.logEventWithStatsig("Email Verify Popup Hidden","chatgpt_email_verify_popup_hidden",a)},[t])}const gt=y.DEPRECATED_ENTERPRISE,Qa=({billingDetails:t})=>{const s=Xe()?.isEnterprisey(),o=Ca();return e.jsx(Se,{icon:e.jsx(Ut,{className:"icon-md text-brand-purple"}),planName:"enterprise",pricingPlan:o,showForLine:!0,callToActionButton:s?e.jsx(I,{color:"secondary",disabled:!0,size:"large",className:"bg-token-sidebar-surface-tertiary text-token-text-primary hover:bg-token-sidebar-surface-tertiary dark:bg-token-text-tertiary dark:text-token-text-primary dark:hover:bg-token-text-tertiary border-none font-semibold",children:e.jsx(c,{...W.free.callToAction.inactive})}):e.jsx(Ae,{planType:gt,as:"link",to:Et,openNewTab:!0,onClick:()=>{m.logEvent("Account Pay: Click Enterprise Contact Sales Button"),X.logEvent("chatgpt_account_payment_modal_enterprise_sales_button_clicked",gt)},isCurrentPlan:!1,testId:"select-plan-button-enterprise",children:e.jsx("div",{className:"flex items-center gap-1",children:e.jsx(c,{...W.enterprise.callToAction.inactive})})}),billingDetails:t})},Ja=({billingDetails:t})=>{const{data:a}=Mt(),s=wt(a),o=Pa();return e.jsx(Se,{planName:"free",pricingPlan:o,icon:e.jsx(Sa,{className:"icon-md"}),showForLine:!s,callToActionButton:e.jsx(I,{color:"secondary",disabled:!0,size:"large",className:"bg-token-sidebar-surface-tertiary text-token-text-primary hover:bg-token-sidebar-surface-tertiary dark:bg-token-text-tertiary dark:text-token-text-primary dark:hover:bg-token-text-tertiary border-none font-semibold",children:e.jsx(c,{...W.free.callToAction.inactive})}),additionalLinks:[e.jsx(c,{...es.haveExistingPlan,values:{link:l=>e.jsx(Z,{target:"_blank",to:Qe,onClick:et,className:"underline",children:l},"row-plus-plan-help-link")}},"existing-plan-help")],billingDetails:t})},es=ie({haveExistingPlan:{id:"FreeColumn.haveExistingPlan",defaultMessage:"Have an existing plan? See <link>billing help</link>"}}),ts=t=>u.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...t},u.createElement("path",{d:"M6.394 4.444c.188-.592 1.024-.592 1.212 0C8.4 8.9 9.1 9.6 13.556 10.394c.592.188.592 1.024 0 1.212C9.1 12.4 8.4 13.1 7.606 17.556c-.188.592-1.024.592-1.212 0C5.6 13.1 4.9 12.4.444 11.606c-.592-.188-.592-1.024 0-1.212C4.9 9.6 5.6 8.9 6.394 4.444Zm8.716 9.841a.41.41 0 0 1 .78 0c.51 2.865.96 3.315 3.825 3.826.38.12.38.658 0 .778-2.865.511-3.315.961-3.826 3.826a.408.408 0 0 1-.778 0c-.511-2.865-.961-3.315-3.826-3.826a.408.408 0 0 1 0-.778c2.865-.511 3.315-.961 3.826-3.826Zm2.457-12.968a.454.454 0 0 1 .866 0C19 4.5 19.5 5 22.683 5.567a.454.454 0 0 1 0 .866C19.5 7 19 7.5 18.433 10.683a.454.454 0 0 1-.866 0C17 7.5 16.5 7 13.317 6.433a.454.454 0 0 1 0-.866C16.5 5 17 4.5 17.567 1.317Z",fill:"currentColor"})),H=ie({sendEmailFailure:{id:"emailVerify.sendEmailFailure",defaultMessage:"Could not send email verification code, please try again later."},sendEmailFailureInvalidEmail:{id:"emailVerify.invalidEmail",defaultMessage:'The email address "{email}" is not formatted correctly.'},sendEmailFailureInvalidEmailEmpty:{id:"emailVerify.invalidEmailEmpty",defaultMessage:"Please enter a valid email address to continue."},sendEmailFailureRateLimited:{id:"emailVerify.sendEmailFailure.rateLimited",defaultMessage:"You've sent too many requests. Please try again later."},verifyOtpFailure:{id:"emailVerify.verifyOtpFailure",defaultMessage:"Something went wrong, please try again later."},verifyOtpFailureInvalidOtp:{id:"emailVerify.verifyOtpFailure.invalidOtp",defaultMessage:"The code you entered is invalid. Please try again."},verifyOtpFailureInvalidFormat:{id:"emailVerify.verifyOtpFailure.invalidFormat",defaultMessage:"The code you entered is formatted incorrectly."},verifyOtpFailureEmailAlreadyLinked:{id:"emailVerify.verifyOtpFailure.emailAlreadyLinked",defaultMessage:'{branch, select, email {"{emailValue}"} other {Your email}} is already linked to another account.'},verifyOtpFailureRateLimited:{id:"emailVerify.verifyOtpFailure.rateLimited",defaultMessage:"You've sent too many requests. Please try again later."},verifyOtpSuccess:{id:"emailVerify.verifyOtpSuccess",defaultMessage:"Email confirmed."}});class ft extends Error{constructor(a){super(a),this.name="EmailValidationError"}}const as=(t,a)=>a.trim()===""?t.formatMessage(H.sendEmailFailureInvalidEmailEmpty):/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|.(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(a)?null:t.formatMessage(H.sendEmailFailureInvalidEmail,{email:a}),Lt=(t,a,s)=>{switch(s.status){case 429:throw new Error(t.formatMessage(H.sendEmailFailureRateLimited));case 403:throw new Error(t.formatMessage(H.verifyOtpFailureEmailAlreadyLinked,{branch:a?"email":"other",emailValue:a}));default:return}};function ss(t){const a=q(),[s,o]=u.useState(null),l=Re({mutationFn:async i=>{try{const n=as(a,i);if(n)throw new ft(n);return await Oe.addEmailBegin(i)}catch(n){throw n instanceof ft?n:(n instanceof Be&&Lt(a,i,n),new Error(a.formatMessage(H.sendEmailFailure)))}},onSuccess:()=>{t.setStep("verifyOtp")},onError:i=>{o(i.message),m.logEventWithStatsig("Email Verify Enter Email Step - Error Sending Verification Email","chatgpt_email_verify_enter_email_step_error",{error:i.message})}});return u.useEffect(()=>{m.logEventWithStatsig("Email Verify Enter Email Step - Shown","chatgpt_email_verify_enter_email_step_shown")},[]),e.jsx("form",{onSubmit:i=>{i.preventDefault(),l.mutate(t.email),m.logEventWithStatsig("Email Verify Enter Email Step - Attempted Continue","chatgpt_email_verify_enter_email_step_continue")},noValidate:!0,children:e.jsxs("div",{className:"flex w-full flex-col items-center gap-3",children:[e.jsx("p",{className:"text-3xl font-semibold",children:t.title?t.title:e.jsx(c,{id:"emailVerify.enterEmailTitle",defaultMessage:"Add your email"})}),t.description&&e.jsx("p",{className:"text-token-text-primary text-center text-base",children:t.description}),e.jsx(Dt,{ariaLabel:a.formatMessage({id:"emailVerify.emailAddress",defaultMessage:"Email Address"}),placeholder:a.formatMessage({id:"emailVerify.emailAddressPlaceholder",defaultMessage:"Email Address"}),name:"email",type:"email",className:"mt-6 w-full",value:t.email,onChange:i=>{o(null),t.onEmailChange(i.target.value),m.logEventWithStatsig("Email Verify Enter Email Step - Typed","chatgpt_email_verify_enter_email_step_type")},autoFocus:!0,autoComplete:"email",error:s??void 0}),e.jsx(I,{className:"w-full rounded-md",color:"green",type:"submit",loading:l.isPending,disabled:l.isPending,children:e.jsx(c,{id:"emailVerify.continue",defaultMessage:"Continue"})}),t.cancelFlowButton]})})}class ht extends Error{constructor(a){super(a),this.name="OtpValidationError"}}const ns=(t,a)=>{if(a.length!==6)return t.formatMessage(H.verifyOtpFailureInvalidFormat);try{parseInt(a)}catch{return t.formatMessage(H.verifyOtpFailureInvalidFormat)}return null},is=(t,a,s)=>{switch(s.status){case 403:throw new Error(t.formatMessage(H.verifyOtpFailureEmailAlreadyLinked,{branch:a?"email":"other",emailValue:a}));case 429:throw new Error(t.formatMessage(H.verifyOtpFailureRateLimited));case 422:throw new Error(t.formatMessage(H.verifyOtpFailureInvalidOtp));default:return}};function os(t){const a=ma(),s=q(),o=pe(),[l,i]=u.useState(null),n=u.useCallback(d=>{const r=d.target.value.trim();if(typeof r=="string"){if(r.match(/\D/)){d.preventDefault();return}t.onOtpChange(r.substring(0,6))}},[t]),g=Re({mutationFn:async d=>{try{return await Oe.addEmailBegin(d)}catch(r){throw r instanceof Be&&Lt(s,d,r),new Error(s.formatMessage(H.sendEmailFailure))}},onSuccess:()=>{t.setStep("verifyOtp")},onError:d=>{i(d.message),m.logEventWithStatsig("Email Verify Verify OTP Step - Error Resending OTP","chatgpt_email_verify_verify_otp_step_resend_error",{error:d.message})}}),p=Re({mutationFn:async d=>{try{const r=ns(s,d.code);if(r)throw new ht(r);await Ke.safePost("/accounts/add_email/verify",{requestBody:d}),await pa(a,{reason:"verify_otp"})}catch(r){throw r instanceof ht?r:(r instanceof Be&&is(s,t.email,r),new Error(s.formatMessage(H.verifyOtpFailure)))}},onSuccess:()=>{o.success(s.formatMessage(H.verifyOtpSuccess)),t.onVerified?.()},onError:d=>{i(d.message),m.logEventWithStatsig("Email Verify Verify OTP Step - Error Verifying OTP","chatgpt_email_verify_verify_otp_step_error",{error:d.message})}});return u.useEffect(()=>{m.logEventWithStatsig("Email Verify Verify OTP Step - Shown","chatgpt_email_verify_verify_otp_step_shown")},[]),e.jsxs("div",{className:"flex w-full flex-col items-center gap-3",children:[e.jsx("p",{className:"text-3xl font-semibold",children:e.jsx(c,{id:"verifyOtp.title",defaultMessage:"Check your email"})}),e.jsxs("p",{className:"text-center",children:[e.jsx("span",{className:"text-token-text-primary text-base",children:e.jsx(c,{id:"verifyOtp.description",defaultMessage:"Enter the verification code we just sent to"})}),t.email&&e.jsx("br",{}),e.jsx("span",{className:`text-token-text-primary text-base leading-snug ${t.email&&"font-semibold"}`,children:e.jsx(c,{id:"verifyOtp.email",defaultMessage:"{branch, select, email {{emailValue}} other { your email.}}",values:{branch:t.email?"email":"other",emailValue:t.email}})})]}),e.jsxs("form",{onSubmit:d=>{d.preventDefault(),p.mutate({code:t.otp,email:t.email??""}),m.logEventWithStatsig("Email Verify Verify OTP Step - Attempted Continue","chatgpt_email_verify_verify_otp_step_continue")},className:"flex w-full flex-col items-center gap-3",children:[e.jsx(Dt,{error:l??void 0,ariaLabel:s.formatMessage({id:"emailVerify.otpAriaLabel",defaultMessage:"OTP"}),value:t.otp,onChange:d=>{i(null),n(d),m.logEventWithStatsig("Email Verify Verify OTP Step - Typed","chatgpt_email_verify_verify_otp_step_type")},name:"otp",type:"text",placeholder:"XXXXXX",className:"mt-6 w-full",autoComplete:"off",autoFocus:!0}),e.jsx(I,{className:"w-full rounded-md",color:"green",type:"submit",loading:p.isPending,disabled:p.isPending,children:e.jsx(c,{id:"verifyOtp.continue",defaultMessage:"Continue"})}),t.cancelFlowButton]}),e.jsxs("div",{className:"mt-6 flex w-full flex-col items-center gap-3",children:[e.jsx("p",{className:"text-token-text-primary text-sm",children:e.jsx(c,{id:"verifyOtp.resendMessage",defaultMessage:"Didn’t receive the code?"})}),e.jsx(I,{className:"w-full rounded-md",color:"secondary",onClick:()=>{g.mutate(t.email??""),m.logEventWithStatsig("Email Verify Verify OTP Step - Resend","chatgpt_email_verify_verify_otp_step_resend")},loading:g.isPending,disabled:g.isPending,children:e.jsx(c,{id:"verifyOtp.resend",defaultMessage:"Resend code"})}),e.jsx(I,{className:"w-full rounded-md",color:"secondary",onClick:()=>{t.setStep("enterEmail"),m.logEventWithStatsig("Email Verify Verify OTP Step - Back to Enter Email Step","chatgpt_email_verify_verify_otp_step_change_email")},children:e.jsx(c,{id:"verifyOtp.changeEmail",defaultMessage:"Change email"})})]})]})}function at(t){const[a,s]=u.useState(t.initialStep??"enterEmail"),[o,l]=u.useState(""),[i,n]=u.useState(""),g=t.email?{email:t.email,onEmailChange:t.onEmailChange}:{email:o,onEmailChange:l},p=t.otp?{otp:t.otp,onOtpChange:t.onOtpChange}:{otp:i,onOtpChange:n};return a==="enterEmail"?e.jsx(ss,{title:t.enterEmailTitle,description:t.enterEmailDescription,cancelFlowButton:t.cancelFlowButton,step:a,setStep:s,...g}):e.jsx(os,{email:g.email,onVerified:t.onVerified,cancelFlowButton:t.cancelFlowButton,step:a,setStep:s,...p})}const ls=y.PLUS;function rs({isOpen:t,onClose:a,onCancelationComplete:s,analyticsParams:o}){const l=q(),i=pe(),n=Xe(),{data:g,isLoading:p}=va(),d=jt(n?.id),r=u.useMemo(()=>({...o,planType:ls}),[o]),M=u.useCallback(()=>{a(),d.isSuccess||m.logEventWithStatsig("Cancel Plus: Closed cancel modal without cancellation","cancel_plus_modal_abort",r)},[a,d.isSuccess,r]),f=async()=>{if(!n)throw new Error("No account!");m.logEventWithStatsig("Cancel Plus: Clicked button to cancel plan","cancel_plus_modal_confirm",r),await d.mutateAsync(n?.id,{onError:()=>{i.danger(l.formatMessage(B.cancelFailure),{duration:2}),m.logEventWithStatsig("Cancel Plus: Something errored while cancelling","cancel_plus_modal_error",r)},onSuccess:()=>{m.logEventWithStatsig("Cancel Plus: Request to cancel was successful","cancel_plus_modal_success",r),s?.(),i.info(l.formatMessage(B.cancelSuccess),{duration:2}),a()}})};u.useEffect(()=>{d.isSuccess},[d.isSuccess,a]);const C=g?.active_until;return e.jsx(ce,{testId:"modal-cancel-plus",type:"success",onClose:M,isOpen:t,className:"",title:e.jsx(c,{...B.cancelPlan}),children:p||!n?e.jsx(Ce,{}):d.isSuccess?e.jsx(c,{...B.cancelSuccess}):e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm",children:[!!C&&e.jsx("p",{className:"mb-4",children:e.jsx(c,{...B.planActiveUntil,values:{expirationDate:new Date(C)}})}),e.jsx("p",{className:"mb-2",children:e.jsx(c,{...B.cancelListHeader})}),e.jsx("div",{children:us.map(b=>e.jsxs("div",{className:"text-l mb-2 flex justify-start gap-2",children:[e.jsx(xt,{className:"h-5 w-5 shrink-0 align-top text-gray-500"}),e.jsx("span",{children:e.jsx(c,{...b,values:{learnMoreLink:cs,mainModel:ds}})})]},b.id))})]}),e.jsxs("div",{className:"mt-8 flex justify-end gap-2",children:[e.jsx(I,{onClick:M,color:"secondary",children:e.jsx(c,{...B.closeModal})}),e.jsx(I,{color:"danger",onClick:f,disabled:d.isPending||d.isSuccess,children:e.jsx(c,{...d.isPending?B.cancellingInProgress:B.cancelButton})})]})]})})}const cs=t=>e.jsx("a",{target:"_blank",href:"https://help.openai.com/en/articles/9280126-what-happens-to-my-gpts-if-i-cancel-my-subscription",rel:"noreferrer",className:"underline",children:t}),ds="GPT-4",B=ie({cancelPlan:{id:"cancelPlusModal.cancelPlan",defaultMessage:"Cancel your Plus subscription?"},cancelListHeader:{id:"cancelPlusModal.cancelText",defaultMessage:"When your subscription ends, you'll no longer have:"},planActiveUntil:{id:"cancelPlusModal.planActiveUntil",defaultMessage:"If you cancel your subscription, you’ll be downgraded to the free plan on {expirationDate, date, long}."},cancelButton:{id:"cancelPlusModal.cancelButton",defaultMessage:"Cancel subscription"},cancellingInProgress:{id:"cancelPlusModal.cancellingInProgress",defaultMessage:"Cancelling..."},cancelSuccess:{id:"cancelPlusModal.cancelSuccess",defaultMessage:"Successfully cancelled your plan. Sorry to see you go!"},cancelFailure:{id:"cancelPlusModal.cancelFailure",defaultMessage:"Something went wrong while cancelling your plan. Please reach out to support"},lostFeatureGPTModels:{id:"0w7d5w",defaultMessage:"Access to {mainModel} and {liteModel}"},lostFeatureGPTModelSingular:{id:"cancelPlusModal.lostFeature.gptModelSingular",defaultMessage:"Access to {mainModel}"},lostFeatureNewModelUsageLimits:{id:"TjftEV",defaultMessage:"Higher usage limits for {limitedModel}"},lostFeatureDataAnalysisV2:{id:"cancelPlusModal.lostFeature.dataAnalysisV2",defaultMessage:"Access to advanced data analysis, file uploads, vision, and web browsing"},lostFeatureDataAnalysisLimits:{id:"dlGufV",defaultMessage:"Higher usage limits for advanced data analysis, file uploads, vision, and web browsing"},lostFeatureImageGeneration:{id:"cancelPlusModal.lostFeature.imageGeneration",defaultMessage:"DALL·E image generation"},lostFeatureCustomGPTs:{id:"cancelPlusModal.lostFeature.customGPTs",defaultMessage:"Custom GPT creation"},lostFeaturePersonalGPTs:{id:"cancelPlusModal.lostFeature.personalGPTs",defaultMessage:"GPTs you’ve created (<learnMoreLink>learn more</learnMoreLink>)"},closeModal:{id:"cancelPlusModal.close",defaultMessage:"Close"}}),us=[B.lostFeatureGPTModelSingular,B.lostFeatureDataAnalysisV2,B.lostFeatureImageGeneration,B.lostFeatureCustomGPTs,B.lostFeaturePersonalGPTs];function Rt({isOpen:t,onClose:a,onContinue:s,analyticsParams:o}){u.useEffect(()=>{t&&m.logEventWithStatsig("Mobile Subscription Warning Modal Shown","chatgpt_mobile_subscription_warning_modal_shown",o)},[o,t]);const l=()=>{m.logEventWithStatsig("Mobile Subscription Warning Modal Continue Clicked","chatgpt_mobile_subscription_warning_modal_continue_clicked",o),s()},i=()=>{m.logEventWithStatsig("Mobile Subscription Warning Modal Close Clicked","chatgpt_mobile_subscription_warning_modal_close_clicked",o),a()};return e.jsx(ce,{testId:"modal-mobile-subscription-warning",isOpen:t,onClose:i,type:"warning",icon:ga,title:e.jsx(c,{...ke.checkSubscriptionHeader}),primaryButton:e.jsx(dt.Button,{title:ke.dismissModal.defaultMessage,color:"primary",onClick:i}),secondaryButton:e.jsx(dt.Button,{title:ke.continueToNextStep.defaultMessage,color:"secondary",onClick:l}),children:e.jsx("span",{className:"gap-2 text-gray-600",children:ke.checkSubscriptionBody.defaultMessage})})}const ke=ie({checkSubscriptionHeader:{id:"mobileSubscriptionWarningModal.checkSubscriptionHeader",defaultMessage:"Check your App Store subscription"},checkSubscriptionBody:{id:"mobileSubscriptionWarningModal.checkSubscriptionBody",defaultMessage:"Your subscription through the Apple App Store is currently on pause due to a payment issue. Please resolve that issue to resume using ChatGPT Plus and avoid duplicate charges."},dismissModal:{id:"mobileSubscriptionWarningModal.dismissModal",defaultMessage:"Cancel"},continueToNextStep:{id:"mobileSubscriptionWarningModal.continueToNextStep",defaultMessage:"I understand, continue anyways"}});function Vs(t,a,s,o){let l,i;o===_t?(l=qe,i=bt):o===Ct?(l=$e,i=Pt):(l=ze,i=St);const n=l*a;let g;if("percentage"in s)g=n*(1-s.percentage/100);else if("value"in s)g=n-s.value;else throw new Error("Invalid discount type");return{formattedDiscountedCost:t.formatNumber(g,{style:"currency",currency:o,minimumFractionDigits:0,maximumFractionDigits:2}),currencySymbol:i}}function Bt(t,a,s,o){const l={...a};let i;if(o&&(o.period==="year"?o.num_periods===1?i=t.formatMessage({id:"pricingPlanConstants.promoCostSubtitleForSingleYear",defaultMessage:"for the first year"}):i=t.formatMessage({id:"pricingPlanConstants.promoCostSubtitleForPluralYears",defaultMessage:"for the first {num_years} years"},{num_years:o.num_periods}):o.num_periods===1?i=t.formatMessage({id:"pricingPlanConstants.promoCostSubtitleForSingleMonth",defaultMessage:"for the first month"}):i=t.formatMessage({id:"pricingPlanConstants.promoCostSubtitleForPluralMonths",defaultMessage:"for the first {num_months} months"},{num_months:o.num_periods})),l.costDuration={id:"promoCostDuration",defaultMessage:i,description:"Cost duration for promo plan"},"percentage"in s||"discount_type"in s&&s.discount_type===We.PERCENTAGE){const n=("percentage"in s?s.percentage:s.amount)/100;l.costInDollars={id:"discountedCost",defaultMessage:ue((1-n)*ze).toString()},l.costInEuros={id:"discountedCostEuros",defaultMessage:ue((1-n)*qe).toString()},l.costInPounds={id:"discountedCostPounds",defaultMessage:ue((1-n)*$e).toString()}}else if("value"in s||s.discount_type===We.FIXED){const n="value"in s?s.value:s.amount;l.costInDollars={id:"discountedCost",defaultMessage:ue(ze-n).toString()},l.costInEuros={id:"discountedCostEuros",defaultMessage:ue(qe-n).toString()},l.costInPounds={id:"discountedCostPounds",defaultMessage:ue($e-n).toString()}}return l}const st=fa(t=>({recentlyDowngraded:!1,recentlyUpgraded:!1,recentlyCanceled:!1,setRecentlyDowngraded:a=>t({recentlyDowngraded:a}),setRecentlyUpgraded:a=>t({recentlyUpgraded:a}),setRecentlyCanceled:a=>t({recentlyCanceled:a})}));function Wt(t){switch(t){case y.FREE:return"chatgptfreeplan";case y.PLUS:return"chatgptplusplan";case y.PRO:return"chatgptpro";case y.TEAM:return"chatgptteamplan";default:throw new Error(`Invalid plan type: ${t}`)}}function Vt({isOpen:t,onClose:a,accountId:s,initialPlanType:o,updatedPlanType:l,billingDetails:i}){const n=q(),g=pe(),p=ha(),[d,r]=u.useState(!1),M=o===l,f=o===y.PLUS&&l===y.PRO,C=Wt(l);u.useEffect(()=>{m.logTogglePlanManagementModal({isOpen:!0})},[]);const b=()=>{m.logTogglePlanManagementModal({isOpen:!1}),a()},$=Ea(s),j=wa(s),V=jt(s),{data:v,isError:G,isLoading:k}=kt(s,void 0,C);!M&&G&&(p?.planType===y.TEAM?g.warning(n.formatMessage({id:"planManagement.errorUpgradingTeam",defaultMessage:"Updates to Pro aren't yet supported for users with Team subscriptions"}),{hasCloseButton:!0}):g.warning(n.formatMessage({id:"planManagement.errorFetchingPreview",defaultMessage:"There was a problem updating your subscription"}),{hasCloseButton:!0}),a());const A=_=>{const E=Tt(new Date,_);return new Intl.DateTimeFormat(n.locale,{year:"numeric",month:"short",day:"numeric"}).format(E)},Y=p?.getDaysUntilPlanRenews(),x=Y?A(Y):"",{recentlyCanceled:D,setRecentlyUpgraded:U,setRecentlyDowngraded:te}=st(),P=p?.willRenewSubscription()||D,[ae,se]=u.useState(!1),K=la();if(!p)return null;const z=async _=>{r(!0);try{if(M)await j.mutateAsync(s),g.success(x===""?n.formatMessage({id:"planManagement.successfullyRenewedSubscription2",defaultMessage:"Your subscription has been renewed."}):n.formatMessage({id:"planManagement.successfullyRenewedSubscription",defaultMessage:"Your subscription has been renewed. Your subscription will auto-renew on {renewalDate}."},{renewalDate:x}),{hasCloseButton:!0}),m.logEvent("Renew Plan Success",{planType:_}),X.logEvent("chatgpt_renew_plan_success",null,{planType:_});else{if(P||(await j.mutateAsync(s),se(!0)),await $.mutateAsync({accountId:s,updatedPlan:C,updatedPriceInterval:void 0,updatedSeats:void 0}),_!==l){const oe=f?"Upgrade Plan Success":"Downgrade Plan Success",le=f?"chatgpt_upgrade_plan_success":"chatgpt_downgrade_plan_success";m.logEvent(oe,{fromPlan:_,toPlan:l}),X.logEvent(le,null,{fromPlan:_,toPlan:l}),f?U(!0):te(!0)}const T=v?.renewal_date?new Date(v?.renewal_date).toLocaleDateString(n.locale,{year:"numeric",month:"long",day:"numeric"}):"N/A",L=f?n.formatMessage({id:"planManagement.successfullyUpdatedSubscription",defaultMessage:"You're now subscribed to ChatGPT Pro"}):n.formatMessage({id:"planManagement.updatedSubscriptionToPlus",defaultMessage:"Your subscription has been updated. Your subscription will change to Plus on {renewalDateFormatted}."},{renewalDateFormatted:T});localStorage.setItem(`subscriptionUpdateMessage_${p.id}`,L)}K.invalidateQueries({queryKey:["account-status"]});const E=Ve.getItem(Ge.CheckoutFrom);E&&pt[E]&&(Ve.removeItem(Ge.CheckoutFrom),window.location.href=pt[E]),a()}catch(E){E?.detail?.error_type==="card_declined"?g.warning(n.formatMessage({id:"planManagement.cardDeclinedError",defaultMessage:"Payment error. Your card may be invalid or authentication may be needed."}),{hasCloseButton:!0}):g.warning(n.formatMessage({id:"planManagement.errorUpdatingSubscription",defaultMessage:"There was a problem updating your subscription"}),{hasCloseButton:!0}),ae&&await V.mutateAsync(s),a()}finally{r(!1)}},[Q,J,h]=_s(i.currency);return e.jsx(ce,{testId:"modal-plan-management",type:"success",isOpen:t,onClose:b,size:"custom",noPadding:!0,className:"max-w-xl",showCloseButton:!0,title:n.formatMessage({id:"planManagementModal.title",defaultMessage:"Confirm changes"}),removePopoverStyling:!0,children:k?e.jsx(Gt,{}):M&&p?e.jsx(xs,{account:p,renewalDate:x,handleUpdate:()=>z(o),isUpdating:d,onClose:b,plusCost:Q,proCost:J,currencySymbol:h}):G||!v?null:f?e.jsx(ps,{accountId:s,handleUpdate:()=>z(o),isUpdating:d,onClose:b,currencySymbol:h}):e.jsx(Ms,{renewalDate:v.renewal_date,handleUpdate:()=>z(o),isUpdating:d,onClose:b,plusCost:Q,currencySymbol:h})})}function Gt(){return e.jsx("div",{className:"flex items-center justify-center p-6",children:e.jsx(Ce,{})})}function ms({adjustmentMessage:t,proratedCreditMessage:a,proratedCreditInfoMessage:s}){return e.jsxs("div",{children:[e.jsxs("div",{className:"mt-4 flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:t}),e.jsx("span",{className:"font-semibold text-green-600",children:a})]}),e.jsx("span",{className:"text-token-text-secondary text-sm",children:s})]})}function ps({accountId:t,handleUpdate:a,isUpdating:s,onClose:o,currencySymbol:l}){const i=q(),{data:n,isError:g,isLoading:p}=kt(t,void 0,Wt(y.PRO));if(p)return e.jsx(Gt,{});if(g||!n)return null;const d=gs(n,i,l);return e.jsxs("div",{className:"p-6",children:[e.jsx(fs,{data:n,currencySymbol:l}),d.filter(r=>r.value!==0).map((r,M)=>e.jsx(ms,{adjustmentMessage:r.adjustmentMessage,proratedCreditMessage:r.proratedCreditMessage,proratedCreditInfoMessage:r.proratedCreditInfoMessage},M)),e.jsx("hr",{className:"mt-4 mb-4"}),e.jsx(hs,{data:n,currencySymbol:l}),n.default_payment_method&&e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"mt-4 mb-4"}),e.jsx(ys,{defaultPaymentMethod:n.default_payment_method})]}),e.jsxs("div",{className:"mt-8 flex justify-end gap-2",children:[e.jsx(me,{title:i.formatMessage({id:"planUpgradeModal.cancel",defaultMessage:"Cancel"}),color:"secondary",onClick:o}),e.jsx(me,{title:i.formatMessage({id:"planUpgradeModal.payNow",defaultMessage:"Pay now"}),color:"primary",onClick:a,loading:s})]})]})}function gs(t,a,s){return[{adjustmentMessage:e.jsx(c,{id:"planUpgradeModal.adjustment",defaultMessage:"Adjustment"}),proratedCreditMessage:e.jsx(c,{id:"planUpgradeModal.proratedCredit",defaultMessage:"-{currencySign}{adjustment}",values:{currencySign:a.formatMessage(s.sign),adjustment:(-t.negative_line_item_total/100).toFixed(2)}}),proratedCreditInfoMessage:e.jsx(c,{id:"planUpgradeModal.proratedCreditInfo",defaultMessage:"Prorated credit for the remainder of your Plus subscription"}),value:t.negative_line_item_total},{adjustmentMessage:e.jsx(c,{id:"planUpgradeModal.discount",defaultMessage:"Adjustment"}),proratedCreditMessage:e.jsx(c,{id:"planUpgradeModal.discountAmount",defaultMessage:"-{currencySign}{discount}",values:{currencySign:a.formatMessage(s.sign),discount:(t.discount_amount/100).toFixed(2)}}),proratedCreditInfoMessage:e.jsx(c,{id:"planUpgradeModal.discountInfo",defaultMessage:"Account discount applied"}),value:t.discount_amount},{adjustmentMessage:e.jsx(c,{id:"planUpgradeModal.credits",defaultMessage:"Adjustments"}),proratedCreditMessage:e.jsx(c,{id:"planUpgradeModal.creditsAmount",defaultMessage:"-{currencySign}{credits}",values:{currencySign:a.formatMessage(s.sign),credits:(t.applied_balance/100).toFixed(2)}}),proratedCreditInfoMessage:e.jsx(c,{id:"planUpgradeModal.creditsInfo",defaultMessage:"Credits applied"}),value:t.applied_balance}]}function fs({data:t,currencySymbol:a}){const s=q();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:e.jsx(c,{id:"planUpgradeModal.subscription",defaultMessage:"ChatGPT Pro subscription"})}),e.jsx("span",{className:"font-semibold",children:e.jsx(c,{id:"planUpgradeModal.subscriptionCost",defaultMessage:"{currencySign}{totalCost}",values:{currencySign:s.formatMessage(a.sign),totalCost:(t.positive_line_item_total/100).toFixed(2)}})})]}),e.jsx("span",{className:"text-token-text-secondary text-sm",children:e.jsx(c,{id:"planUpgradeModal.billingCycle",defaultMessage:"Billed monthly, starting today"})})]})}function hs({data:t,currencySymbol:a}){const s=q();return e.jsxs(e.Fragment,{children:[t.amount_due.tax_amount>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mt-4 flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:e.jsx(c,{id:"planUpgradeModal.subTotal",defaultMessage:"Subtotal"})}),e.jsx("span",{children:e.jsx(c,{id:"planUpgradeModal.subtotalPrice",defaultMessage:"{currencySign}{totalCost}",values:{currencySign:s.formatMessage(a.sign),totalCost:(t.amount_due.amount_excluding_tax/100).toFixed(2)}})})]}),e.jsxs("div",{className:"mt-2 flex justify-between",children:[e.jsxs("span",{className:"font-semibold",children:[e.jsx(c,{id:"planUpgradeModal.tax",defaultMessage:"Tax"}),e.jsx("span",{className:"text-token-text-secondary font-normal",children:e.jsx(c,{id:"planUpgradeModal.taxPercent",defaultMessage:" {taxPercent}%",values:{taxPercent:(t.amount_due.tax_amount/t.amount_due.amount_excluding_tax*100).toFixed(0)}})})]}),e.jsx("span",{children:e.jsx(c,{id:"planUpgradeModal.taxAmount",defaultMessage:"{currencySign}{tax}",values:{currencySign:s.formatMessage(a.sign),tax:(t.amount_due.tax_amount/100).toFixed(2)}})})]})]}),e.jsxs("div",{className:"mt-2 flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:e.jsx(c,{id:"planUpgradeModal.totalDueToday",defaultMessage:"Total due today"})}),e.jsx("span",{className:"font-semibold",children:e.jsx(c,{id:"planUpgradeModal.totalDueTodayAmount",defaultMessage:"{currencySign}{totalCost}",values:{currencySign:s.formatMessage(a.sign),totalCost:(t.amount_due.amount/100).toFixed(2)}})})]})]})}function ys({defaultPaymentMethod:t}){return e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:e.jsx(c,{id:"planUpgradeModal.paymentMethod",defaultMessage:"Payment Method"})}),e.jsxs("span",{className:"text-token-text-secondary",children:[t.card_brand?.toUpperCase()," *",t.card_last4]})]})}function Ms({renewalDate:t,handleUpdate:a,isUpdating:s,onClose:o,plusCost:l,currencySymbol:i}){const n=q(),g=t?new Date(t).toLocaleDateString(n.locale,{year:"numeric",month:"long",day:"numeric"}):"N/A";return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"p-6",children:[e.jsx("p",{className:"text-token-text-secondary",children:e.jsx(c,{id:"planDowngradeModal.currentSubscription",defaultMessage:"Your current Pro subscription will remain active until {renewalDateFormatted}, when it will change to Plus.",values:{renewalDateFormatted:g}})}),e.jsxs("div",{className:"bg-token-main-surface-secondary mt-4 rounded-md p-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:e.jsx(c,{id:"planDowngradeModal.newPlan",defaultMessage:"ChatGPT Plus"})}),e.jsx("span",{className:"text-token-text-secondary",children:e.jsx(c,{id:"planDowngradeModal.newPlanCost",defaultMessage:"{currencyCode} {currencySign}{plusCost}/month",values:{currencyCode:n.formatMessage(i.code),currencySign:n.formatMessage(i.sign),plusCost:n.formatMessage(l)}})})]}),e.jsx("span",{className:"text-token-text-secondary",children:e.jsx(c,{id:"planDowngradeModal.billingStart",defaultMessage:"Billing will start on {renewalDateFormatted}",values:{renewalDateFormatted:g}})})]}),e.jsxs("div",{className:"mt-8 flex justify-end gap-2",children:[e.jsx(me,{title:n.formatMessage({id:"planDowngradeModal.cancel",defaultMessage:"Cancel"}),color:"secondary",onClick:o}),e.jsx(me,{title:n.formatMessage({id:"planDowngradeModal.confirm",defaultMessage:"Confirm"}),color:"primary",onClick:a,loading:s})]})]})})}function xs({account:t,renewalDate:a,handleUpdate:s,isUpdating:o,onClose:l,plusCost:i,proCost:n,currencySymbol:g}){const p=q(),d=t.data.subscriptionStatus.planType,r=ja(d.toLowerCase()),M=r==="Pro"?n:i;return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"p-6",children:[e.jsx("p",{className:"text-token-text-secondary",children:e.jsx(c,{id:"planRenewalModal.currentSubscription",defaultMessage:"Your current {planName} subscription will auto-renew on {renewalDate}.",values:{planName:r,renewalDate:a}})}),e.jsxs("div",{className:"bg-token-main-surface-secondary mt-4 rounded-md p-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:e.jsx(c,{id:"planRenewalModal.newPlan",defaultMessage:"ChatGPT {planName}",values:{planName:r}})}),e.jsx("span",{className:"text-token-text-secondary",children:e.jsx(c,{id:"planRenewalModal.newPlanCost",defaultMessage:"{currencyCode} {currencySign}{planCost}/month",values:{currencyCode:p.formatMessage(g.code),currencySign:p.formatMessage(g.sign),planCost:p.formatMessage(M)}})})]}),e.jsx("span",{className:"text-token-text-secondary",children:e.jsx(c,{id:"planRenewalModal.billingStart",defaultMessage:"Billing will auto-renew on {renewalDate}",values:{renewalDate:a}})})]}),e.jsxs("div",{className:"mt-8 flex justify-end gap-2",children:[e.jsx(me,{title:p.formatMessage({id:"planRenewalModal.cancel",defaultMessage:"Cancel"}),color:"secondary",onClick:l}),e.jsx(me,{title:p.formatMessage({id:"planRenewalModal.confirm",defaultMessage:"Confirm"}),color:"primary",onClick:s,loading:o})]})]})})}function _s(t){return t==_t?[_e.plusCostInEurosProduce,Le.proCostInEuros,bt]:t==Ct?[_e.plusCostInPoundsProduce,Le.proCostInPounds,Pt]:[_e.plusCostProduce,Le.proCost,St]}const Me=y.PLUS,Gs=({currentAccount:t})=>{const{data:{subscriptionStatus:a}}=t;return a.hasPaidSubscription&&a.subscriptionPlan===Ye.PLUS?a.billingPeriod==="yearly"?W.plusYearly:W.plusProduceForPlusUsersExp:W.plusProduceForFreeUsersExp},bs=()=>Pe({queryKey:["has-app-store-subscription-in-billing-retry"],queryFn:async()=>await Ke.safeGet("/subscriptions/has_app_store_subscription_in_billing_retry")});function Ht(t,a){const s=t.data.subscriptionStatus.planType,o=t.getNextPlanType();let l=t.getDaysUntilPlanChanges(),i=o===y.PLUS&&s===y.PRO;return a&&!i&&(l=t.getDaysUntilPlanRenews(),i=!0),{daysUntilPlanChanges:l,isDowngradeScheduled:i}}function Ze(t,a){const s=Tt(new Date,t);return new Intl.DateTimeFormat(a,{year:"numeric",month:"short",day:"numeric"}).format(s)}function Cs(t,a,s){let o;switch(t){case"month":o=Oa(new Date,a);break;case"year":o=Fa(new Date,a);break}return new Intl.DateTimeFormat(s,{year:"numeric",month:"short",day:"numeric"}).format(o)}const Ps=({analyticsParams:t,currentAccount:a,planLoading:s,isPromoLoading:o,onSubmit:l,setPlanLoading:i,plusPricingPlanProduce:n=null,shouldShowAdditionalLinks:g=!0,billingDetails:p,promoCode:d=null,promoMetadata:r=null,onCustomUpgradeClick:M=null,onUpgradeLoading:f=!1,handlePromoModalClose:C=()=>{},disableForMobile:b=!1,shouldShowMemoryUpsell:$=!1})=>{const{data:j}=Mt(),{data:V,refetch:v}=Pe(Je),{data:G,isError:k}=bs(),A=a.features,{isUnauthenticated:Y}=ya(),x=q(),D=pe(),[U,te]=u.useState(!1);let P=n||ka();const ae=u.useRef(!1),[se,K]=u.useState(!1),[z,Q]=u.useState(!1),[J,h]=u.useState(!1),{recentlyDowngraded:_,recentlyCanceled:E,setRecentlyCanceled:T}=st();let L=[];const oe=a.isOrWasPaidCustomer(),le=a.hasPaidSubscription(),N=le&&a.isPlus(),ve=le&&a.isPro(),de=a.getLastActiveSubscription(),{layer:Ee}=He("468168202"),{layer:ge}=He("3950229590"),Ie=Fe(),{prepareCheckoutSession:fe,navigateToCheckout:De}=At(),we=wt(j),F=A.includes("disable_plus_upgrade_ui")&&!oe,ne=A.includes("show_cancel_plus_ui"),{daysUntilPlanChanges:nt,isDowngradeScheduled:Yt}=Ht(a,_),O=u.useMemo(()=>({...t,promoCode:d,planType:Me,isUpgradeUiDisabled:F}),[t,d,F]),qt=!!V?.email,he=u.useRef(new Map);u.useEffect(()=>{if(!N&&ge.get("enabled_prefetch_checkout_for_plus",!1)){const w={plan_name:Ye.PLUS,billing_details:p,promo_code:d},R=JSON.stringify(w);if(!he.current.has(R)){m.logEventWithStatsig("Account Pay: Prefetch Checkout Session","chatgpt_account_payment_modal_prefetch_checkout_session",O),he.current.clear();const oa=fe(w,"ProducePlus",A);he.current.set(R,oa)}}},[fe,O,p,d,A,N,ge]);const $t=()=>{const w={plan_name:Ye.PLUS,billing_details:p,promo_code:d},R=he.current.get(JSON.stringify(w));return R?(m.logEventWithStatsig("Account Pay: Using Prefetched Checkout Session","chatgpt_account_payment_modal_using_prefetched_checkout_session",O),R):(m.logEventWithStatsig("Account Pay: Click to Fetch Checkout Session","chatgpt_account_payment_modal_click_to_fetch_checkout_session",O),he.current.clear(),fe(w,"ProducePlus",A))},Ue=async w=>{if(!qt&&!w){h(!0);return}i(y.PLUS),m.logEvent("Account Pay: Payment Checkout Clicked",O),X.logEvent("chatgpt_account_payment_modal_upgrade_button_click",Me);try{const R=await $t();l?.(),m.logEvent("Account Pay: Navigating to Payment Checkout",{...O,url:R.url??""}),X.logEvent("chatgpt_account_payment_modal_navigating_to_checkout",Me,{url:R.url??""}),await De(R)}catch{D.warning(x.formatMessage(S.paymentErrorWarning),{hasCloseButton:!0})}i(null)},zt=()=>{te(!0),m.logEventWithStatsig("Cancel Plus: Opened cancel modal","cancel_plus_start",{...O,cancel_start_source:"manage plan"})},Zt=async()=>{i(y.PLUS);try{const w=await Oe.fetchCustomerPortalUrl();m.logEvent("Account Portal: Navigating to Account Portal",O),location.href=w.url}catch{D.warning(x.formatMessage(S.accountErrorWarning),{hasCloseButton:!0})}i(null)},Xt=()=>{m.logEvent("Account Portal: Click iOS Manage Subscription",O)},Kt=()=>{m.logEvent("Account Portal: Click Android Manage Subscription",O)},Qt=N&&de.purchase_origin_platform===ee.MOBILE_IOS,Jt=N&&de.purchase_origin_platform===ee.MOBILE_ANDROID,it=N&&(de.purchase_origin_platform===ee.WEBAPP||de.purchase_origin_platform===ee.GRANTED)&&a.hasCustomerObject(),ea=it&&!E&&N&&a.willRenewSubscription();if($){const w=P.advertisedFeatures??[];P={...P,advertisedFeatures:[...w.slice(0,4),_e.memoryUpsell,...w.slice(4)]}}if(we&&!N&&L.push(e.jsx(Z,{to:Ta,target:"_blank",className:"px-2 underline",children:e.jsx(c,{...S.limitsApply})},"row-plus-plan-usage-limits")),Qt&&L.push(e.jsx(Z,{to:Nt,target:"_blank",onClick:Xt,className:"px-2 underline",children:x.formatMessage(W.manageSubscriptionIos.callToAction)},"row-plus-plan-manage-ios")),Jt&&L.push(e.jsx(Z,{to:Ft,target:"_blank",onClick:Kt,children:x.formatMessage(W.manageSubscriptionAndroid.callToAction)},"row-plus-plan-manage-android")),it&&Ee.get("is_stripe_manage_subscription_link_enabled",!0)){const w=Ee.get("does_manage_my_subscription_link_take_user_to_subscription_settings",!1);L.push(e.jsx(Z,{to:"#",className:"px-2 underline",onClick:R=>{R.preventDefault(),m.logEvent("Account Portal: Click Manage My Subscription",O),w?Ie("/#settings/Subscription"):Zt()},children:e.jsx(c,{...W.manageSubscriptionWeb.callToAction})},"row-manage-subscription-link")),ea&&ne&&L.push(e.jsxs("button",{children:[e.jsx("span",{onClick:zt,className:"cursor-pointer px-2 underline",children:e.jsx(c,{...W.cancelSubscriptionWeb.callToAction})}),e.jsx(rs,{isOpen:U,onClose:()=>te(!1),onCancelationComplete:()=>T(!0),analyticsParams:O})]},"row-cancel-subscription-link"))}N&&oe&&L.push(e.jsx(Z,{target:"_blank",to:Qe,onClick:et,className:"px-2 underline",children:e.jsx(c,{...S.billingHelp})},"row-plus-plan-help-link"));const ot=function(){K(!se)},ta=()=>{ve?(m.logEvent("Account Pay: Payment Checkout Clicked",O),X.logEvent("chatgpt_account_payment_modal_upgrade_button_click",Me),Q(!0)):Ue()},aa=()=>{k||!G||!G.value?M?(M(p,O),l?.()):ta():ot()},je=(w,R)=>e.jsx(Ae,{planType:Me,isCurrentPlan:N&&!re,disabled:w,onClick:R,testId:"select-plan-button-plus-upgrade",activeColor:ve?"secondary":sa?"primary":void 0,loading:f,children:s===y.PLUS&&!z?e.jsx(Ce,{}):re&&N&&P.callToAction.promo?x.formatMessage(P.callToAction.promo):N?x.formatMessage(P.callToAction.active):lt&&Y&&P.callToAction.inactiveUnauthenticated?x.formatMessage(P.callToAction.inactiveUnauthenticated):x.formatMessage(P.callToAction.inactive)});tt(J,{plan:O});const re=r!=null,sa=r?.promotion_type==="student_discount",lt=r!=null&&"referrer_name"in r,na=(!N||re)&&s==null;L=re?[]:L;let rt=null;const ct=a.getDaysUntilPlanDiscountExpires();if(r!=null?P=Ss(x,P,r,p.currency):a.data.subscriptionStatus.discount&&(P.cost=Bt(x,P.cost,a.data.subscriptionStatus.discount),r==null&&(P.summary=_e.plusSummaryWithDiscount,a.data.subscriptionStatus.discount.discount_type===We.PERCENTAGE&&(rt={discount:{percentage:a.data.subscriptionStatus.discount.amount,expires_at:ct?Ze(ct,x.locale):void 0}}))),o!=null&&o)return null;const ia=vs(a);return e.jsxs(e.Fragment,{children:[e.jsx(Se,{planName:"plus",pricingPlan:P,icon:e.jsx(ts,{className:"icon-md text-green-600"}),showForLine:!N&&!we,callToActionButton:F?e.jsx("div",{className:"relative w-full",children:e.jsx(be,{side:"bottom",sideOffset:20,label:x.formatMessage(W.disabledHighDemand.hoverText),children:je(!0,()=>{})})}):b&&ia?e.jsx("div",{children:e.jsx(be,{side:"top",sideOffset:20,label:x.formatMessage({id:"I2JCGZ",defaultMessage:"Mobile subscriptions are currently not eligible for this promotion."}),onOpenChange:w=>{w&&!ae.current&&(lt&&Aa.logMobileSubscriptionTooltipOpen(),ae.current=!0)},children:e.jsx("div",{children:je(!0,()=>{})})})}):e.jsxs("div",{children:[nt&&Yt?e.jsx(be,{side:"top",sideOffset:20,label:e.jsx(c,{id:"8/N1rV",defaultMessage:"Your subscription will change to Plus on {date}.",values:{date:Ze(nt,x.locale)}}),children:je(!0,()=>{})}):je(!na,aa),e.jsx(Rt,{isOpen:se,onClose:ot,onContinue:Ue,analyticsParams:O}),z&&e.jsx(Vt,{isOpen:z,onClose:()=>Q(!1),accountId:a.id,initialPlanType:y.PRO,updatedPlanType:y.PLUS,billingDetails:p})]}),secondaryCallToActionButton:re?e.jsx(I,{size:"large",color:"secondary",onClick:()=>C(),children:e.jsx(c,{...S.notNow})}):null,additionalLinks:g?L:[],plusInactive:!le&&!re,promoMetadata:r,activeDiscountMetadata:rt,billingDetails:p,className:re?"bg-token-main-surface-primary":""}),e.jsx(ce,{testId:"modal-add-email",isOpen:J,onClose:()=>h(!1),type:"success",className:"max-w-sm",children:e.jsx(at,{enterEmailTitle:x.formatMessage(S.addEmailTitle),enterEmailDescription:x.formatMessage(S.addEmailDescription),onVerified:()=>{v(),h(!1),Ue(!0)},cancelFlowButton:e.jsx(I,{className:"w-full rounded-md",color:"secondary",onClick:()=>h(!1),children:e.jsx(c,{...S.cancelAddEmail})})})})]})};function Ss(t,a,s,o){const{costTitle:l,currencySymbol:i}=Na(a,o),n=l?.defaultMessage?.toString()??"20",g=s.duration?.period??"month",p=s.duration?.num_periods??1,d=Cs(g,p,t.locale),r=Bt(t,a.cost,s.discount,s.duration??{num_periods:1,period:"month"}),M=i.code.defaultMessage?.toString()??"USD",f=t.formatNumber(parseFloat(n)||0,{style:"currency",currency:M,minimumFractionDigits:0,maximumFractionDigits:2});let C;switch(g){case"month":p===1?C=t.formatMessage(S.promoPlanDisclaimerForSingleMonth,{date:d,cost:f}):C=t.formatMessage(S.promoPlanDisclaimerForPluralMonths,{num_months:p,date:d,cost:f});break;case"year":p===1?C=t.formatMessage(S.promoPlanDisclaimerForSingleYear,{date:d,cost:f}):C=t.formatMessage(S.promoPlanDisclaimerForPluralYears,{num_years:p,date:d,cost:f});break;case"hour":throw new Error("Period 'hour' is not supported")}const b="<article>"+t.formatMessage(S.termsApply)+"</article> "+C;return a={...a,summary:{id:"promoSummary",defaultMessage:s.summary},disclaimer:{id:"promoDisclaimer",defaultMessage:b,article:"https://help.openai.com/en/articles/10492689-chatgpt-plus-promotions-referrals"},cost:r,callToAction:{...a.callToAction,promo:{id:"pricingPlanConstants.promo.callToAction",defaultMessage:"Apply to My Subscription",description:"Payment call to action for existing subscribers adding a discount to their plan"}}},a}function vs(t){const a=t.hasPaidSubscription(),s=t.getLastActiveSubscription(),o=a&&s.purchase_origin_platform===ee.MOBILE_IOS,l=a&&s.purchase_origin_platform===ee.MOBILE_ANDROID;return o||l}const S=ie({promoPlanDisclaimerForPluralMonths:{id:"pricingPlanConstants.promoPlanDisclaimerForPluralMonths",defaultMessage:"Promo pricing applies for {num_months} months. Starting {date}, ChatGPT Plus will continue at {cost}/month. Cancel anytime."},promoPlanDisclaimerForSingleMonth:{id:"pricingPlanConstants.promoPlanDisclaimerForSingleMonth",defaultMessage:"Promo pricing applies for 1 month. Starting {date}, ChatGPT Plus will continue at {cost}/month. Cancel anytime."},promoPlanDisclaimerForPluralYears:{id:"pricingPlanConstants.promoPlanDisclaimerForPluralYears",defaultMessage:"Promo pricing applies for {num_years} years. Starting {date}, ChatGPT Plus will continue at {cost}/year. Cancel anytime."},promoPlanDisclaimerForSingleYear:{id:"pricingPlanConstants.promoPlanDisclaimerForSingleYear",defaultMessage:"Promo pricing applies for 1 year. Starting {date}, ChatGPT Plus will continue at {cost}/year. Cancel anytime."},termsApply:{id:"pricingPlanConstants.termsApply",defaultMessage:"Terms apply."},addEmailTitle:{id:"AccountPaymentModal.addEmailTitle",defaultMessage:"Email required"},addEmailDescription:{id:"AccountPaymentModal.addEmailDescription",defaultMessage:"You'll be able to login with this email. It will also be used for account updates (like password resets) and information about OpenAI services."},cancelAddEmail:{id:"AccountPaymentModal.cancelAddEmail",defaultMessage:"Cancel"},haveExistingPlan:{id:"AccountPaymentModal.haveExistingPlan",defaultMessage:"Have an existing plan?"},billingHelp:{id:"AccountPaymentModel.billingHelp",defaultMessage:"I need help with a billing issue"},paymentErrorWarning:{id:"AccountPaymentModal.paymentErrorWarning",defaultMessage:"The payments page encountered an error. Please try again. If the problem continues, please visit help.openai.com."},accountErrorWarning:{id:"AccountPaymentModal.accountErrorWarning",defaultMessage:"The account management page encountered an error. Please try again. If the problem continues, please visit help.openai.com."},limitsApply:{id:"xda4i3",defaultMessage:"Limits apply"},notNow:{id:"AccountPaymentModal.notNow",defaultMessage:"Not Now"}}),Es=t=>u.createElement("svg",{width:20,height:20,viewBox:"0 0 20 20",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...t},u.createElement("path",{d:"M13.4834 10.8828C12.1811 10.8828 10.8568 11.3158 9.84961 12.2109C8.83023 13.1171 8.17486 14.4624 8.1748 16.1904C8.17487 16.5575 8.47276 16.8553 8.83984 16.8555H18.126C18.4932 16.8555 18.791 16.5576 18.791 16.1904C18.791 14.4624 18.1366 13.1171 17.1172 12.2109C16.1101 11.3157 14.7857 10.8829 13.4834 10.8828Z"}),u.createElement("path",{d:"M5.85547 10.7725C4.71599 10.7725 3.55716 11.1515 2.67578 11.9346C1.78358 12.7277 1.21001 13.9056 1.20996 15.418C1.20997 15.7393 1.47069 15.9998 1.79199 16H6.84863C6.89115 14.2044 7.5342 12.6977 8.58691 11.5869C7.77934 11.0395 6.81076 10.7725 5.85547 10.7725Z"}),u.createElement("path",{d:"M5.85547 4C4.2251 4.00011 2.90251 5.32179 2.90234 6.95215C2.90235 8.58265 4.225 9.90516 5.85547 9.90527C7.48591 9.90512 8.80761 8.58262 8.80762 6.95215C8.80745 5.32181 7.48581 4.00016 5.85547 4Z"}),u.createElement("path",{d:"M13.4834 3.14453C11.6205 3.14453 10.1096 4.65468 10.1094 6.51758C10.1094 8.38058 11.6204 9.8916 13.4834 9.8916C15.3463 9.89142 16.8564 8.38047 16.8564 6.51758C16.8563 4.65479 15.3462 3.14471 13.4834 3.14453Z"})),Te=y.TEAM,ws=({analyticsParams:t,planLoading:a,billingDetails:s})=>{const{data:o,refetch:l}=Pe(Je),i=q(),n=Xe(),g=Fe(),[p,d]=u.useState(!1),r=n&&n.isTeam(),M=n&&n.isPlus(),f={...t,planType:Te},C=!!o?.email;let b=Ia();const $=Ya(),{data:j}=qa($??""),V=Ua,v=j?.coupon===Da&&j?.state==="eligible";let G=null;v&&(b={...b,cost:{...b.cost,costInDollars:V.promoCost,costInPounds:V.promoCost,costInEuros:V.promoCost,costDuration:V.promoCostDuration},disclaimer:V.team1dollarPromoDisclaimer},G={plan_name:"chatgptteamplan",title:"",summary:"",discount:{value:0,currency_code:"USD"},duration:{num_periods:1,period:"month"},price_period:"recurring",promotion_type:"discount",promotion_type_label:null});const k=A=>{if(!C&&!A){d(!0);return}m.logEvent("Account Pay: Payment Checkout Clicked",f),X.logEvent("chatgpt_account_payment_modal_upgrade_button_click",Te),La.setPurchaseWorkspaceData({minimumSeats:Ra,billingDetails:s,promoData:j?.state==="eligible"?j:void 0}),It(g)};return tt(p,{plan:f}),e.jsxs(e.Fragment,{children:[e.jsx(Se,{planName:"team",elementId:Ot,pricingPlan:b,icon:e.jsx(Es,{className:"icon-md text-brand-blue-800"}),promoData:j,promoMetadata:G,callToActionButton:e.jsxs("div",{className:"flex flex-col gap-2",children:[r&&e.jsx(Ae,{planType:Te,isCurrentPlan:!0,disabled:a!=null||r,onClick:()=>k(),testId:"select-plan-button-teams-upgrade",children:i.formatMessage(b.callToAction.active)}),e.jsx("div",{className:"w-full",children:e.jsx(Ae,{planType:Te,isCurrentPlan:!1,disabled:a!=null,onClick:()=>k(),testId:"select-plan-button-teams-create",children:r||M?i.formatMessage(b.callToAction.create):i.formatMessage(b.callToAction.inactive)})})]}),billingDetails:s}),e.jsx(ce,{testId:"modal-add-email",isOpen:p,onClose:()=>d(!1),type:"success",className:"max-w-sm",children:e.jsx(at,{enterEmailTitle:i.formatMessage(S.addEmailTitle),enterEmailDescription:i.formatMessage(S.addEmailDescription),onVerified:()=>{d(!1),l(),k(!0)}})})]})},js=t=>u.createElement("svg",{width:20,height:20,viewBox:"0 0 20 20",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",...t},u.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.5711 3.23242C13.3087 3.23254 14.0194 3.51049 14.5614 4.01074L17.7362 6.94043L17.8953 7.10352C18.5891 7.89225 18.6127 9.07384 17.951 9.88965L17.7987 10.0586L10.9823 16.875C10.4397 17.4171 9.55987 17.4172 9.01741 16.875L2.201 10.0586C1.33286 9.19035 1.36145 7.77335 2.2635 6.94043L5.43831 4.01074L5.64925 3.83301C6.15833 3.44479 6.7833 3.23258 7.42854 3.23242H12.5711ZM7.50081 5.83301C7.32377 5.83283 7.17454 5.96577 7.15413 6.1416C7.02742 7.24017 6.40698 7.86058 5.30842 7.9873C5.1326 8.00771 4.99965 8.15695 4.99983 8.33398C5.00016 8.51098 5.1335 8.65976 5.3094 8.67969C6.39232 8.80238 7.05546 9.41629 7.15315 10.5156C7.16914 10.6956 7.32017 10.8332 7.50081 10.833C7.68131 10.8327 7.83192 10.6945 7.84749 10.5146C7.9414 9.43107 8.59789 8.77458 9.68147 8.68066C9.86133 8.66507 9.99949 8.51449 9.99983 8.33398C10 8.15336 9.86235 8.00233 9.68245 7.98633C8.58311 7.88863 7.96919 7.22552 7.84651 6.14258C7.82659 5.96669 7.67778 5.83336 7.50081 5.83301Z"})),ks=()=>Pe({queryKey:["has-app-store-subscription-in-billing-retry"],queryFn:async()=>await Ke.safeGet("/subscriptions/has_app_store_subscription_in_billing_retry")}),xe="pro",Ts=({analyticsParams:t,currentAccount:a,planLoading:s,onSubmit:o,setPlanLoading:l,billingDetails:i,variant:n})=>{const{data:g,isError:p}=ks(),d=a.features,{data:r,refetch:M}=Pe(Je),f=q(),C=pe(),[b]=ra(),$=b.get("checkout_from"),[j,V]=u.useState(!1),[v,G]=u.useState(!1),[k,A]=u.useState(!1),Y=a.getLastActiveSubscription(),x=a.isOrWasPaidCustomer(),D=a.hasPaidSubscription(),U=D&&a.isPro(),te=!!r?.email,{layer:P}=He("468168202"),ae=Fe(),{prepareCheckoutSession:se,navigateToCheckout:K}=At(),{recentlyDowngraded:z}=st(),{daysUntilPlanChanges:Q,isDowngradeScheduled:J}=Ht(a,z),{value:h}=ut("1719651090"),_=Ba({isOperatorEnabled:h}),E=[],T={...t,planType:xe},L=D&&Y.purchase_origin_platform===ee.MOBILE_IOS,oe=D&&Y.purchase_origin_platform===ee.MOBILE_ANDROID,le=D&&(Y.purchase_origin_platform===ee.WEBAPP||Y.purchase_origin_platform===ee.GRANTED)&&a.hasCustomerObject(),N=async F=>{if(!te&&!F){A(!0);return}l(y.PRO),m.logEvent("Account Pay: Payment Checkout Clicked",T),X.logEvent("chatgpt_account_payment_modal_upgrade_button_click",xe);try{const ne=await se({plan_name:"chatgptpro",billing_details:i},"ProducePro",d);o?.(),m.logEvent("Account Pay: Navigating to Payment Checkout",{...T,url:ne.url??""}),X.logEvent("chatgpt_account_payment_modal_navigating_to_checkout",xe,{url:ne.url??""}),$==="vza493q"&&Ve.setItem(Ge.CheckoutFrom,$),await K(ne)}catch{C.warning(f.formatMessage(S.paymentErrorWarning),{hasCloseButton:!0})}l(null)},ve=async()=>{l(y.PRO);try{const F=await Oe.fetchCustomerPortalUrl();m.logEvent("Account Portal: Navigating to Account Portal",T),location.href=F.url}catch{C.warning(f.formatMessage(S.accountErrorWarning),{hasCloseButton:!0})}l(null)},de=()=>{m.logEvent("Account Portal: Click iOS Manage Subscription",T)},Ee=()=>{m.logEvent("Account Portal: Click Android Manage Subscription",T)};if(U&&L&&E.push(e.jsx(Z,{to:Nt,target:"_blank",onClick:de,className:"px-2 underline",children:f.formatMessage(W.manageSubscriptionIos.callToAction)},"row-plus-plan-manage-ios")),U&&oe&&E.push(e.jsx(Z,{to:Ft,target:"_blank",onClick:Ee,children:f.formatMessage(W.manageSubscriptionAndroid.callToAction)},"row-plus-plan-manage-android")),U&&le&&P.get("is_stripe_manage_subscription_link_enabled",!0)){const F=P.get("does_manage_my_subscription_link_take_user_to_subscription_settings",!1);E.push(e.jsx(Z,{to:"#",className:"px-2 underline",onClick:ne=>{ne.preventDefault(),m.logEvent("Account Portal: Click Manage My Subscription",T),F?ae("/#settings/Subscription"):ve()},children:e.jsx(c,{...W.manageSubscriptionWeb.callToAction})},"row-manage-subscription-link"))}x&&E.push(e.jsx(Z,{target:"_blank",to:Qe,onClick:et,className:"px-2 underline",children:e.jsx(c,{...S.billingHelp})},"row-plus-plan-help-link"));const ge=function(){V(!j)},Ie=function(){G(!v)},{value:fe}=ut("1382475798"),De=async()=>{let F=a.hasPaidSubscription()&&a.isPlus();fe&&(F=F&&!a.isActiveSubscriptionGratis()),F?(m.logEvent("Account Pay: Payment Checkout Clicked",T),X.logEvent("chatgpt_account_payment_modal_upgrade_button_click",xe),G(!0)):await N()},we=p||!g||!g.value?De:()=>{ge()};return tt(k,{plan:T}),e.jsxs(e.Fragment,{children:[e.jsx(Se,{planName:"pro",pricingPlan:_,icon:e.jsx(js,{className:"icon-md primary"}),showForLine:!1,callToActionButton:e.jsxs("div",{children:[a.isWorkspacePlan()&&n==="operator"?e.jsx(I,{fullWidth:!0,size:"large",color:"primary",disabled:!0,"data-testid":"select-plan-button-pro-upgrade",children:f.formatMessage(yt.switchToPersonalAccount)}):L||oe?e.jsx(be,{side:"top",sideOffset:20,label:f.formatMessage(yt.switchToMobile),onOpenChange:F=>{F&&(m.logEvent("Account Pay: Show Mobile Subscription Tooltip",T),X.logEvent("chatgpt_account_payment_modal_show_mobile_subscription_tooltip",xe))},children:e.jsx(I,{fullWidth:!0,size:"large",color:"primary",disabled:!0,"data-testid":"select-plan-button-pro-upgrade",children:f.formatMessage(_.callToAction.inactive)})}):J&&Q?e.jsx(be,{side:"top",sideOffset:20,label:e.jsx(c,{id:"jgTAPh",defaultMessage:"Your subscription will remain active until {date}, when it will change to Plus.",values:{date:Ze(Q,f.locale)}}),children:e.jsx(I,{fullWidth:!0,size:"large",color:"primary",disabled:U||s!=null,"data-testid":"select-plan-button-pro-upgrade",className:U||s!=null?"bg-token-sidebar-surface-tertiary text-token-text-primary hover:bg-token-sidebar-surface-tertiary dark:bg-token-text-tertiary dark:text-token-text-primary dark:hover:bg-token-text-tertiary border-none font-semibold":"",children:s===y.PRO&&!v?e.jsx(Ce,{}):U?f.formatMessage(_.callToAction.active):f.formatMessage(_.callToAction.inactive)})}):e.jsx(I,{fullWidth:!0,size:"large",color:"primary",disabled:U||s!=null,onClick:we,"data-testid":"select-plan-button-pro-upgrade",className:U||s!=null?"bg-token-sidebar-surface-tertiary text-token-text-primary hover:bg-token-sidebar-surface-tertiary dark:bg-token-text-tertiary dark:text-token-text-primary dark:hover:bg-token-text-tertiary border-none font-semibold":"",children:s===y.PRO&&!v?e.jsx(Ce,{}):U?f.formatMessage(_.callToAction.active):f.formatMessage(_.callToAction.inactive)}),e.jsx(Rt,{isOpen:j,onClose:ge,onContinue:N,analyticsParams:T}),v&&e.jsx(Vt,{isOpen:v,onClose:Ie,accountId:a.id,initialPlanType:y.PLUS,updatedPlanType:y.PRO,billingDetails:i})]}),additionalLinks:E,className:"bg-token-main-surface-primary",billingDetails:i}),e.jsx(ce,{testId:"modal-add-email",isOpen:k,onClose:()=>A(!1),type:"success",className:"max-w-sm",children:e.jsx(at,{enterEmailTitle:f.formatMessage(S.addEmailTitle),enterEmailDescription:f.formatMessage(S.addEmailDescription),onVerified:()=>{M(),A(!1),N(!0)},cancelFlowButton:e.jsx(I,{className:"w-full rounded-md",color:"secondary",onClick:()=>A(!1),children:e.jsx(c,{...S.cancelAddEmail})})})})]})},yt=ie({switchToPersonalAccount:{id:"y5FjSF",defaultMessage:"Switch to a personal account to upgrade"},switchToMobile:{id:"gbjsg6",defaultMessage:"It looks like you already have an active mobile subscription. Switch to your mobile app to upgrade"}});function As({analyticsParams:t,currentAccount:a,planLoading:s,selectedTab:o,setPlanLoading:l,shouldSplitBetweenPersonalAndBusiness:i,isEnterpriseEnabled:n,billingDetails:g,variant:p,shouldShowMemoryUpsell:d}){const r=[],M=a.hasPaidSubscription();return p==="operator"?(M&&a.isPlus()&&r.push("plus"),r.push("pro")):i?o==="personal"?(M||r.push("free"),r.push("plus"),r.push("pro")):r.push("team"):(M||r.push("free"),(!a.isTeam()||!a.isEnterprisey()&&n)&&(r.push("plus"),r.push("pro")),r.push("team")),r.length===0&&vt.addError(new Error("Account payment modal missing columns")),r.map(f=>{switch(f){case"free":return e.jsx(Ja,{billingDetails:g},f);case"plus":return e.jsx(Ps,{analyticsParams:t,currentAccount:a,setPlanLoading:l,planLoading:s,billingDetails:g,shouldShowMemoryUpsell:d},f);case"team":return e.jsx(ws,{analyticsParams:t,billingDetails:g,currentAccount:a,planLoading:s},f);case"enterprise":return e.jsx(Qa,{billingDetails:g},f);case"pro":return e.jsx(Ts,{analyticsParams:t,currentAccount:a,setPlanLoading:l,planLoading:s,billingDetails:g,variant:p},f)}})}function Hs({currentAccount:t,defaultTab:a="personal",hasEnterpriseFooter:s=!0,onClose:o,subtitle:l,title:i,variant:n="default"}){const[g,p]=u.useState(null),d=ca(),r=da(),M=Wa(),f=M&&n!=="operator",C=u.useMemo(()=>({...t.subscriptionAnalyticsParams,referrer:document.referrer}),[t]),b=Fe(),$=pe(),j=u.useCallback(()=>{m.logEvent("Account Pay: Close Account Payment Modal",C),o?o():It(b)},[C,b,o]),V=Va();u.useEffect(()=>{const h=localStorage.getItem(`subscriptionUpdateMessage_${t.id}`);if(h){localStorage.removeItem(`subscriptionUpdateMessage_${t.id}`),$.success(h,{hasCloseButton:!0});const _=setTimeout(()=>{j()},5e3);return()=>{clearTimeout(_)}}},[t.id,$,j]);const[v,G]=u.useState(a),{country:k,setCountry:A,userCountry:Y}=$a(),x=Ns({currentAccount:t,selectedTab:v}),D=za({country:x?k:_a,currentAccount:t,location:"AccountPaymentModal",shouldUsePaidSubscriptionBillingCurrency:v==="personal"});Ga(()=>{const h=d.state?.[Ha],_=d.key;h&&b({hash:d.hash,search:d.search},{replace:!0,state:{}}),Ma.count(xa.DEFAULT,"chatgpt_account_payment_modal_show",[{key:"location",value:h},{key:"locationKey",value:_},{key:"navigationType",value:r},{key:"initialTab",value:a},{key:"initialCountrySelectorCountry",value:k},{key:"selectedCountry",value:D.country??""},{key:"selectedCurrency",value:D.currency??""},{key:"userCountry",value:Y??""},{key:"isCountrySelectorEnabled",value:String(x)}]),m.logEventWithStatsig("Account Pay: Account Payment Modal Show","chatgpt_account_payment_modal_show",{...C,initialTab:a,location:h,locationKey:_,navigationType:r,initialCountrySelectorCountry:k,selectedCountry:D.country??"",selectedCurrency:D.currency??"",userCountry:Y??"",isCountrySelectorEnabled:x})});const U=u.useCallback(h=>{vt.addAction("chatgpt_selected_country_changed_in_pricing_modal",{old_selected_country:k,new_selected_country:h}),m.logEventWithStatsig("Selected country changed in pricing modal","chatgpt_selected_country_changed_in_pricing_modal",{old_selected_country:k,new_selected_country:h}),A(h)},[k,A]),te=h=>{G(h),m.logEventWithStatsig("Account Pay: Account Payment Modal Toggle Clicked","chatgpt_account_payment_modal_toggle_clicked",{selectedTab:h})},P=136,[ae,se]=u.useState(),K=u.useRef(null);u.useEffect(()=>{const h=()=>{if(K.current){const _=document.documentElement.clientHeight,E=K.current.getBoundingClientRect().height,T=_-E;se(Math.max(T,P))}};return h(),window.addEventListener("resize",h),()=>window.removeEventListener("resize",h)},[v]);const z=As({analyticsParams:C,currentAccount:t,planLoading:g,selectedTab:v,setPlanLoading:p,shouldSplitBetweenPersonalAndBusiness:f,isEnterpriseEnabled:!1,billingDetails:D,variant:n,shouldShowMemoryUpsell:V}),Q=Fs({defaultTitle:i,hasProSubscription:t.isPro()}),J=u.useRef(!1);return u.useEffect(()=>{const h=document.getElementById(Ot);if(!(!h||!h.scrollIntoView||J.current)){if(K.current&&!f&&a==="business")h.scrollIntoView({behavior:"smooth"}),m.logEvent("Account Pay: Account Payment Modal Scroll",{selectedTab:"business",scrollSource:"auto"}),J.current=!0;else if(!f){const _=new IntersectionObserver(E=>{E.some(T=>T.isIntersecting)&&(m.logEvent("Account Pay: Account Payment Modal Scroll",{selectedTab:"business",scrollSource:"manual"}),J.current=!0,_.disconnect())},{root:null,threshold:.5});return _.observe(h),()=>_.disconnect()}}},[t,a,f]),e.jsxs(ce,{testId:"modal-account-payment",size:"fullscreen",isOpen:!0,onClose:j,type:"success",className:"flex flex-col",removePopoverStyling:!0,children:[e.jsxs("div",{ref:K,children:[e.jsxs("div",{className:"relative grid grid-cols-[1fr_auto_1fr] px-6 py-4 md:pt-[4.5rem] md:pb-10",children:[e.jsx("div",{}),e.jsxs("div",{className:"my-1 flex flex-col items-center justify-center md:mt-0 md:mb-0",children:[e.jsx("div",{className:"text-2xl font-semibold md:text-3xl",children:e.jsx(c,{...Q})}),l?e.jsx("div",{className:"text-token-text-secondary mt-3 mb-1",children:e.jsx(c,{...l})}):null]}),e.jsx("button",{className:"text-token-text-primary justify-self-end opacity-50 transition hover:opacity-75 md:absolute md:end-6 md:top-6",onClick:()=>{j()},children:e.jsx(xt,{className:mt({"h-5 w-5":!M,"icon-lg":M})})})]}),t.isPersonalAccount()&&f?e.jsx("div",{className:"mb-3 flex justify-center md:mb-10",children:e.jsx("div",{className:"w-[fit-content]",children:e.jsx(Xa,{value:v,onChange:te})})}):null,e.jsx("div",{className:"flex flex-col justify-center gap-4 px-3 py-3 md:min-h-[30rem] md:flex-row md:gap-0 md:py-0",children:z})]}),e.jsxs("div",{className:"relative grid grid-cols-[1fr_auto_1fr]",style:{height:`${ae}px`},children:[e.jsx("div",{}),s?e.jsxs("span",{className:"text-token-text-secondary mt-8 mb-12 flex flex-col items-center justify-start gap-2 text-sm md:mt-8 md:mb-8",children:[e.jsx(Ut,{}),e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx(c,{...Ne.needMoreCapabilities}),e.jsx("div",{children:e.jsx(c,{...Ne.seeChatGptEnterprise,values:{link:h=>e.jsx(Z,{target:"_blank",to:Et,onClick:()=>{m.logEventWithStatsig("Account Pay: Click see enterprise link from Modal","chatgpt_account_payment_modal_enterprise_link_clicked")},className:"mx-1 underline",children:h})}})})]})]}):null,e.jsx("span",{"data-testid":"country-selector-in-pricing-modal",className:mt({hidden:!x},"text-token-text-primary justify-self-end opacity-50 transition hover:opacity-75 md:absolute md:end-4 md:bottom-4"),children:e.jsx(Za,{onChange:U,value:k})})]})]})}function Ns({currentAccount:t,selectedTab:a}){return!!(!t.hasPaidSubscription()||(t.isPlus()||t.isPro())&&a==="business"||t.isTeam())}function Fs({defaultTitle:t,hasProSubscription:a}){return t||(a?Ne.proModalTitle:Ne.modalTitle)}const Ne=ie({modalTitle:{id:"AccountPaymentModal.modalTitle",defaultMessage:"Upgrade your plan"},proModalTitle:{id:"AccountPaymentModal.proModalTitle",defaultMessage:"Choose your plan"},modalFooterCapabilities:{id:"AccountPaymentModal.modalFooterCapabilities",defaultMessage:"Need more capabilities? See <link> ChatGPT Enterprise </link>"},needMoreCapabilities:{id:"SdJWr7",defaultMessage:"Need more capabilities for your business?"},seeChatGptEnterprise:{id:"7C5fuF",defaultMessage:"See<link>ChatGPT Enterprise</link>"},promoNotEligibleMessage:{id:"AccountPaymentModal.promoNotEligibleMessage",defaultMessage:"Thanks for being a susbcriber. Since you already use ChatGPT Plus, you're not eligible for this offer."}});export{Hs as A,Ps as P,hs as T,Vs as a,_s as b,ms as c,ys as d,Vt as e,Gs as g,et as h};
//# sourceMappingURL=lrc5m64spklls83o.js.map
