import{ad as j,B as y,eP as k}from"./citrwydz0bgriwlc.js";import{i as P,f as v,a as C,D as M,r as m,u as _,j as e,M as i}from"./b8ijctzpgh0s7wpx.js";import{S as p}from"./d7kgdj2gn7xkll1d.js";import{dL as N,dM as q,aJ as b}from"./krbmwir12ubt4od1.js";import{b as I}from"./otl51en3t0ec5n7s.js";import{M as R}from"./i75gb1ryagd0j9ba.js";import{g as S,W as T,d as E,w as W}from"./omp8ie1vzl40ti1z.js";import{a as B}from"./gw319re0na8zpsh7.js";import"./b4v20hsjdnh8a64d.js";import"./ku4zsoy6w4wkp690.js";import"./k1h56nx2kjoqc52m.js";import"./exvo283q5zxd2q6r.js";import"./jekpe1ukp5thtucq.js";import"./dcml6fn13vfm1zv2.js";import"./nvghija6qp2cunds.js";import"./djd85tifm57yisqi.js";import"./h3krx8dg2s8o2yh5.js";import"./cfe0bfy5asp94vp2.js";import"./jkznwfhp8ahnvlot.js";import"./megablgldkh4lap1.js";import"./hbpbckirom363mgh.js";import"./izdon3syh095bs23.js";import"./dweroubxngal4vlb.js";import"./i7jya7stlyvnzya0.js";import"./cb2t82g498wwhuc2.js";import"./ndwtlsjk3xm27wkq.js";import"./o0ebhsapkoy5qkg1.js";import"./k7nub2yuxq70se07.js";import"./k6ccgr4wxcppeg93.js";import"./dbalwdodzoo02ru2.js";import"./c2d9eukr2hh7n3q0.js";import"./eigi8l95ddhoqirr.js";import"./etmxhiuvgu79utu0.js";import"./ct6yhczwft8t5t9k.js";import"./ndqm17bbs5ambnrw.js";import"./nnffynscsbaol5fb.js";import"./eeyp7d7oqudhas3m.js";import"./nfkxdwnvdjy1s4sn.js";import"./cwi4lsxreiklxbjv.js";function F(){const a=P(),o=v(),n=C(),{taskId:r,turnId:s}=M(),[f,c]=m.useState(!1),x=m.useMemo(()=>S(r,s,n,{refetchInterval:t=>{const d=t.state?.data?.turn?.pull_request_status;switch(d){case null:case void 0:case"not_created":case"creating":return 2e3;case"failed":case"created":case"updated":return!1;default:N(d)}}}),[r,s,n]),{data:u}=_(x),g=j(),h=async()=>{if(!(!r||!s))try{c(!0),await T.createPr(r,s,Q()),await n.invalidateQueries({queryKey:["wham","task"]})}catch(t){t instanceof E&&W(t,s,a,g)}finally{c(!1)}},l=u?.turn?.pull_request_data?.url;m.useEffect(()=>{l&&(window.location.href=l)},[l]);const w=u?.turn?.pull_request_status==="failed";return e.jsx(R,{children:e.jsx(I,{mobileHeaderRightContent:null,children:e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsx(B,{className:"absolute start-0 end-0 top-0",children:e.jsx("div",{className:"flex w-full justify-end",children:e.jsx(q,{onClick:()=>{window.opener?(window.opener.focus(),window.close()):o(`/codex/tasks/${r}`)},icon:e.jsx(p,{}),label:a.formatMessage({id:"wham.task.pr.header.title",defaultMessage:"Back to task"})})})}),e.jsx("div",{className:"flex grow items-center justify-center p-4",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(b,{className:"mb-4 h-15 w-15"}),w?e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("div",{className:"text-token-text-error flex items-center gap-1",children:e.jsx(i,{id:"wham.task.pr.inProgress.error.description",defaultMessage:"Failed to create pull request. Please try again."})}),e.jsx(y,{color:"secondary",size:"small",icon:p,loading:f,onClick:t=>{t.preventDefault(),t.stopPropagation(),h()},children:e.jsx(i,{id:"wham.task.pr.inProgress.error.button",defaultMessage:"Retry"})})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"loading-shimmer-pure-text text-lg font-semibold",children:e.jsx(i,{id:"wham.task.pr.inProgress.title",defaultMessage:"Creating pull requestâ€¦"})}),e.jsx("p",{className:"text-token-text-secondary text-sm",children:e.jsx(i,{id:"wham.task.pr.inProgress.description",defaultMessage:"Pull request will automatically open once it has been created."})})]})]})})]})})})}function Q(){const o=new URLSearchParams(location.search).get("mode");if(o==="draft")return"draft";if(o==="auto_merge")return"auto_merge"}const Ce=()=>[{title:"Codex"}],Me=k(function(){return e.jsx(F,{})});export{Me as default,Ce as meta};
//# sourceMappingURL=kv1er7qvvucycnzc.js.map
