const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/c9ri1ap1wvh593dt.js","assets/b8ijctzpgh0s7wpx.js","assets/d93ofje6cuqhnn4o.js","assets/citrwydz0bgriwlc.js","assets/root-gxczc0vy.css","assets/hwsg9g3vzuodcwkr.js","assets/lclantcr99684npn.js","assets/krbmwir12ubt4od1.js","assets/conversation-small-dfayqh3x.css"])))=>i.map(i=>d[i]);
import{i as $,r as _,j as t,R as Zt,M as v,c as L,a as Je,l as dt,u as et,v as Gs,f as Se,L as Jt,a5 as es,a6 as Es,e as Ct}from"./b8ijctzpgh0s7wpx.js";import{nw as Ds,qS as As,nt as Os,nr as Rs,qT as Us,qU as Ls,cP as se,qV as He,a5 as ts,cm as Ge,cR as ne,cS as ae,e as Bs,qW as Ae,fb as ss,fk as Hs,cr as Qe,fe as qs,ff as Bt,fg as $s,f9 as ce,dY as b,dI as Vs,fi as Ws,fj as ft,bY as Nt,fm as Ks,fv as tt,fx as st,ds as Ys,fp as Xs,fq as Qs,mk as Zs,on as Js,ot as en,e_ as tn,m6 as ke,l9 as sn,fc as nn,oA as xt,qX as an,bQ as on,ou as gt,qY as rn,e$ as ln,qZ as Ht,f5 as cn,f0 as mt,ov as dn,ol as mn,q_ as un,q$ as nt,r0 as fn,r1 as xn,r2 as gn,c1 as hn,ls as pn,r3 as jn,r4 as ns,r5 as Ke,X as Mt,r6 as qt,r7 as vn,r8 as wt,r9 as as,ra as _t,ja as Sn,jb as bn,rb as yn,o_ as Cn,rc as os,rd as Nn,re as Mn,oT as is,rf as wn,gm as _n,rg as kn,jw as rs,d as In,aa as zn,a6 as Tn,rh as $t,ri as Pn,rj as Fn,rk as ht,Y as kt,V as at,m9 as Gn,rl as ls,rm as cs,aX as Ie,fo as En,oY as Dn,rn as An,f8 as ot,fY as On,m7 as Rn,ac as ds,ad as It,ro as Un,ft as Oe,rp as ms,rq as Ln,rr as Bn,fs as pt,rs as Hn,rt as Ye,dq as qn,o5 as $n,cz as us,P as pe,U as de,ru as fs,dH as Vn,jv as Wn,rv as xs,rw as Kn,da as Yn,oS as Xn,rx as Qn,ry as Zn,rz as Jn,rA as gs,fy as hs,oD as ea,ij as ps,cd as js,cs as ta,aN as sa,lC as vs,gx as na,id as aa,hm as oa,rB as ia,bI as Ze,m4 as ra,rC as la,rD as ca,rE as da,ml as ma,o as ua,am as fa,al as xa,a8 as ga,rF as ha,oR as pa,nL as ja,Q as va,rG as Sa,rH as ba,rI as ya,qF as Ca,dM as Na,rJ as Ma,d8 as wa,cD as _a,rK as ka,mQ as it,j7 as Ss,rL as Ia,cb as za,rM as Ta,rN as Pa,rO as Fa,rP as Ga,rQ as Ea,mg as Da,rR as Aa,mO as Oa,mP as Ra,l1 as Vt,hY as Ua,c5 as La,rS as Ba,ko as Ha,rT as qa}from"./krbmwir12ubt4od1.js";import{d as $a,u as Va}from"./ku4zsoy6w4wkp690.js";import{aM as Wa,j as me,Q as ze,_ as Te,ad as Re,aq as Ka,c as U,ca as Wt,B as je,ab as Ue,f as zt,aN as Ya,F as Pe,bX as bs,ha as Xa,ac as Xe,aK as jt,bW as Qa,de as Tt,e as Q,aR as Za,dw as Ja,dk as eo,a7 as ys,ae as rt,O as Cs,m as vt,fN as to,dr as Pt,be as so,eR as no,gh as ao,l as Ee,af as Ft,cQ as De,at as oo,c7 as be,g3 as io,au as lt,S as ro,b1 as St,bj as lo,b as Gt,aQ as co,aD as mo,bi as uo,aL as Et,d as fo,db as xo,bk as go,bL as ho,aS as bt,n as Kt}from"./citrwydz0bgriwlc.js";import{G as Dt}from"./dcml6fn13vfm1zv2.js";import{d as At,e as po}from"./nvghija6qp2cunds.js";import{H as jo,G as vo}from"./h3krx8dg2s8o2yh5.js";import{c as So,D as yt,P as bo,d as yo}from"./jkznwfhp8ahnvlot.js";import{u as Co}from"./o0ebhsapkoy5qkg1.js";import{G as Ns}from"./cfe0bfy5asp94vp2.js";import{T as No,g as Mo,u as wo}from"./c2d9eukr2hh7n3q0.js";function _o({task:s}){const e=$(),n=!1,a=Ds(s.originalConversationId),{clearSystemHintModeTrigger:r}=$a();return _.useEffect(()=>{s.notificationStatus?.recentlyCompleted&&!s.notificationStatus?.notificationSent&&(a(),As(s,e),r(Wa.Research),Os.setTaskNotificationSent(s.taskId))},[s,e,a,n,r]),t.jsx(Zt.Fragment,{})}function ko(){const s=Rs(Us.getAllTasksOrdered);return Ls(),s.length?t.jsx(t.Fragment,{children:s.map(e=>t.jsx(_o,{task:e},e.taskId))}):null}function Io({gizmoResource:s,serverThreadId:e,isOnProjectPage:n,conversations:a,hasNextPage:r=!1}){const o=me(),i=a??[],d=i.findIndex(x=>x.id===e),{name:c}=se(),l=c?ne:ae,m=i.slice(0,He);d!=null&&d>=He&&(m[He-1]=i[d]);const f=r||i.length>He;return t.jsxs(t.Fragment,{children:[m.map(x=>t.jsx(jo,{className:"ps-9",conversation:x,isActive:x.id===e},x.id)),f&&!n&&t.jsx(ts,{to:Ge(o,s),className:"ps-9",label:t.jsx(v,{...l.seeAllChats})})]})}const Ms=ze(()=>Te(()=>import("./c9ri1ap1wvh593dt.js"),__vite__mapDeps([0,1])).then(s=>s.DirectorySyncResourceManagedIndication));function zo(s,e){return s.type===ce.USER?s.user_id===e.user_id:s.type===ce.GROUP?s.group_id===e.group_id:s.type===e.type}function To(s){"use forget";const e=L.c(74),{gizmo:n,publishedGizmo:a,onClose:r}=s,o=me(),i=$(),d=Re(),c=Ka(),l=Bs(),{name:m}=se(),f=m?ne:ae,x=Ae();let h;e[0]!==n.sharing?.subjects?(h=n.sharing?.subjects??[],e[0]=n.sharing?.subjects,e[1]=h):h=e[1];const[u,p]=_.useState(h),[j,g]=_.useState(!1);let S;e[2]!==n.sharing?.subjects||e[3]!==u?(S=()=>!Wt(n.sharing?.subjects,u),e[2]=n.sharing?.subjects,e[3]=u,e[4]=S):S=e[4];const y=S,w=Je(),C=ss(n);let N;e[5]!==u?(N=function(E){u.find(X=>zo(X,E))||p([...u,E])},e[5]=u,e[6]=N):N=e[6];const k=N;let M;e[7]!==c?(M=function(E,X,he){return E.type===ce.USER&&E.user_id.indexOf("__")===-1?{...E,user_id:E.user_id+"__"+c?.getWorkspaceId()}:E},e[7]=c,e[8]=M):M=e[8];const P=M;let I;e[9]!==j||e[10]!==u||e[11]!==r||e[12]!==w||e[13]!==x||e[14]!==P?(I=async function(E){if(j)return;g(!0);const X=u.map(P);await x.mutateAsync({id:E,update:{sharing:{recipient:Qe.Private,subjects:X}}}),g(!1),r(),w.invalidateQueries({queryKey:["gizmos"]}),w.refetchQueries({queryKey:["gizmos","discovery"]}),w.refetchQueries({queryKey:["gizmo",{gizmoId:E}]}),w.invalidateQueries({queryKey:["gizmo","userActionSettings",{gizmoId:E}]}),w.invalidateQueries({queryKey:["workspace"]})},e[9]=j,e[10]=u,e[11]=r,e[12]=w,e[13]=x,e[14]=P,e[15]=I):I=e[15];const G=I;let B;e[16]!==a||e[17]!==l?.id?(B=!a||Do(a.gizmo.author.user_id.split("__")[0],l?.id),e[16]=a,e[17]=l?.id,e[18]=B):B=e[18];const z=B;let Z;e[19]!==a.gizmo.id||e[20]!==G?(Z=()=>G(a.gizmo.id),e[19]=a.gizmo.id,e[20]=G,e[21]=Z):Z=e[21];const K=C.length>0||!Hs(Qe.Private,n.sharingTargets);let A;e[22]===Symbol.for("react.memo_cache_sentinel")?(A=t.jsx(v,{id:"BEKjVh",defaultMessage:"Save"}),e[22]=A):A=e[22];let H;e[23]!==j||e[24]!==Z||e[25]!==K?(H=t.jsx(je,{onClick:Z,loading:j,disabled:K,children:A}),e[23]=j,e[24]=Z,e[25]=K,e[26]=H):H=e[26];let J;e[27]!==y?(J=y()&&t.jsx("div",{className:"text-token-text-secondary absolute start-6 bottom-8 text-sm",children:t.jsx(v,{id:"9CkgC4",defaultMessage:"Unsaved changes"})}),e[27]=y,e[28]=J):J=e[28];let F;e[29]!==o||e[30]!==i||e[31]!==a||e[32]!==d?(F=a&&t.jsx(je,{color:"secondary",onClick:T=>Ks(o,a,d,T,i.formatMessage({id:"KdDqMm",defaultMessage:"Copied link to clipboard"})),children:t.jsx(v,{id:"bbhdTf",defaultMessage:"Copy link"})}),e[29]=o,e[30]=i,e[31]=a,e[32]=d,e[33]=F):F=e[33];let O;e[34]!==J||e[35]!==F?(O=t.jsxs(t.Fragment,{children:[J,F]}),e[34]=J,e[35]=F,e[36]=O):O=e[36];let V;e[37]!==f.projectShareTitle||e[38]!==i?(V=i.formatMessage(f.projectShareTitle),e[37]=f.projectShareTitle,e[38]=i,e[39]=V):V=e[39];let q;e[40]!==k?(q=T=>k(T),e[40]=k,e[41]=q):q=e[41];let R;e[42]!==a||e[43]!==q?(R=t.jsx(Fo,{onAdd:q,publishedGizmo:a}),e[42]=a,e[43]=q,e[44]=R):R=e[44];let ee;e[45]===Symbol.for("react.memo_cache_sentinel")?(ee=t.jsx("h3",{className:"text-base font-semibold",children:t.jsx(v,{id:"bNQXcV",defaultMessage:"Share with..."})}),e[45]=ee):ee=e[45];let W;e[46]!==z||e[47]!==a.gizmo.author||e[48]!==l?(W=t.jsx("div",{className:"shrink-0 grow-0 self-start",children:z?t.jsx(qs,{user:l,size:"gizmoConversation",roundedStyle:"rounded-full"}):t.jsx(Bt,{name:a.gizmo.author.display_name??"User",initialsCount:2,size:"gizmoConversation"})}),e[46]=z,e[47]=a.gizmo.author,e[48]=l,e[49]=W):W=e[49];let Y;e[50]!==z||e[51]!==a.gizmo.author||e[52]!==l?.email||e[53]!==l?.name?(Y=t.jsx("div",{className:"grow text-base font-semibold",children:z?t.jsxs("div",{className:"flex flex-col",children:[t.jsx(v,{id:"U7tzof",defaultMessage:"{userName} (you)",values:{userName:l?.name}}),t.jsx("span",{className:"text-token-text-secondary -mt-1 text-sm",children:l?.email})]}):t.jsx(v,{id:"FBF0QC",defaultMessage:"{userName} (owner)",values:{userName:a.gizmo.author.display_name}})}),e[50]=z,e[51]=a.gizmo.author,e[52]=l?.email,e[53]=l?.name,e[54]=Y):Y=e[54];let ue;e[55]!==W||e[56]!==Y?(ue=t.jsxs("div",{className:"mb-4 flex flex-row items-center justify-between space-x-3",children:[W,Y]}),e[55]=W,e[56]=Y,e[57]=ue):ue=e[57];let ie;e[58]!==u?(ie=u.map((T,E)=>$s(T)&&t.jsxs("div",{className:"mb-4 flex flex-row items-center justify-between space-x-3",children:[t.jsx(Bt,{name:T.type===ce.GROUP?T.group_name:`${T.user_name} ${T.user_email}`,initialsCount:T.type===ce.USER?2:1,size:"gizmoConversation",className:U("shrink-0 grow-0",T.type===ce.USER&&"self-start")}),t.jsxs("div",{className:"flex grow flex-col",children:[t.jsxs("span",{className:"flex flex-row",children:[t.jsx("span",{className:"me-2 text-base font-semibold",children:T.type===ce.GROUP?T.group_name:T.user_name}),T.type===ce.GROUP&&T.is_scim_managed&&t.jsx(Ms,{})]}),T.type===ce.USER&&t.jsx("span",{className:"text-token-text-secondary -mt-1 text-sm",children:T.user_email})]}),t.jsxs(b.Root,{children:[t.jsxs(b.Trigger,{className:"text-token-text-secondary text-base whitespace-nowrap",children:[t.jsx(v,{...ws(T.capabilities)}),t.jsx(Vs,{className:"icon-sm"})]}),t.jsx(b.Portal,{children:t.jsxs(b.Content,{className:"max-w-[320px]",children:[[Ws,ft].map((X,he)=>t.jsx(Po,{capabilities:X,selected:Wt(X,T.capabilities),onClick:()=>{p(u.map(xe=>xe===T?{...xe,capabilities:X}:xe))}},he)),t.jsx(b.Separator,{className:"my-2"}),t.jsx(b.Item,{onClick:()=>p(u.filter(X=>X!==T)),color:"danger",icon:Nt,children:t.jsx(v,{id:"NU0BOB",defaultMessage:"Remove"})})]})})]})]},E)),e[58]=u,e[59]=ie):ie=e[59];let fe;e[60]!==ue||e[61]!==ie?(fe=t.jsxs("div",{className:"max-h-[200px] space-y-2 overflow-y-auto",children:[ue,ie]}),e[60]=ue,e[61]=ie,e[62]=fe):fe=e[62];let ve;e[63]===Symbol.for("react.memo_cache_sentinel")?(ve=t.jsx("hr",{className:"border-token-border-medium"}),e[63]=ve):ve=e[63];let re;e[64]===Symbol.for("react.memo_cache_sentinel")?(re=t.jsx("div",{className:"text-token-text-secondary text-sm",children:t.jsx(v,{id:"GkuPg+",defaultMessage:"Project conversations are private regardless of these settings."})}),e[64]=re):re=e[64];let te;e[65]!==R||e[66]!==fe?(te=t.jsxs("div",{className:"flex flex-col space-y-4",children:[R,ee,fe,ve,re]}),e[65]=R,e[66]=fe,e[67]=te):te=e[67];let le;return e[68]!==r||e[69]!==H||e[70]!==O||e[71]!==V||e[72]!==te?(le=t.jsx(Ue,{testId:"modal-share-project",type:"success",className:"max-w-[555px]",size:"custom",isOpen:!0,onClose:r,primaryButton:H,secondaryButton:O,title:V,showCloseButton:!0,children:te}),e[68]=r,e[69]=H,e[70]=O,e[71]=V,e[72]=te,e[73]=le):le=e[73],le}function ws(s){return s.can_write?dt({id:"vsUknl",defaultMessage:"Can edit"}):s.can_view_config?dt({id:"4ceJzB",defaultMessage:"Can chat"}):dt({id:"x2E8ET",defaultMessage:"Unknown"})}function Po(s){"use forget";const e=L.c(20),{capabilities:n,selected:a,onClick:r}=s;let o=null;n.can_write?o=tt:n.can_view_config&&(o=st);let i;e[0]!==n.can_write?(i=n.can_write?t.jsx(v,{id:"r5Iods",defaultMessage:"Chat, edit files & instructions, and duplicate"}):t.jsx(v,{id:"bIM51p",defaultMessage:"Chat, view files & instructions, and duplicate"}),e[0]=n.can_write,e[1]=i):i=e[1];const d=i,c=o;let l;e[2]!==n?(l=ws(n),e[2]=n,e[3]=l):l=e[3];let m;e[4]!==l?(m=t.jsx("span",{className:"mb-0.5 text-base leading-tight",children:t.jsx(v,{...l})}),e[4]=l,e[5]=m):m=e[5];let f;e[6]!==d?(f=t.jsx("span",{className:"text-token-text-secondary text-xs",children:d}),e[6]=d,e[7]=f):f=e[7];let x;e[8]!==m||e[9]!==f?(x=t.jsxs("div",{className:"me-1 flex grow flex-col",children:[m,f]}),e[8]=m,e[9]=f,e[10]=x):x=e[10];const h=!a&&"invisible";let u;e[11]!==h?(u=U("icon-lg shrink-0",h),e[11]=h,e[12]=u):u=e[12];let p;e[13]!==u?(p=t.jsx(Ys,{className:u}),e[13]=u,e[14]=p):p=e[14];let j;return e[15]!==o||e[16]!==r||e[17]!==x||e[18]!==p?(j=t.jsxs(b.Item,{className:"flex h-auto flex-row items-center px-3 py-3",onClick:r,icon:c,children:[x,p]}),e[15]=o,e[16]=r,e[17]=x,e[18]=p,e[19]=j):j=e[19],j}function Fo(s){"use forget";const e=L.c(19),{onAdd:n,publishedGizmo:a}=s,r=$(),o=zt(),[i,d]=_.useState(""),c=Xs(o?.id,0,i,5),l=o?.data?.name??"your workspace",m=c.data?.items.filter(k=>k.account_user_id!==a?.gizmo.author.user_id),f=o?.id;let x;e[0]!==i||e[1]!==f?(x=[f,"groups","filtered",i],e[0]=i,e[1]=f,e[2]=x):x=e[2];let h;e[3]!==o||e[4]!==i?(h=o?()=>Ya.getWorkspaceGroups(o.id,{query:i,orderby:"@score"}):void 0,e[3]=o,e[4]=i,e[5]=h):h=e[5];const u=i.trim()!==""&&o!=null&&!!o.getWorkspaceId();let p;e[6]!==x||e[7]!==h||e[8]!==u?(p={queryKey:x,queryFn:h,enabled:u},e[6]=x,e[7]=h,e[8]=u,e[9]=p):p=e[9];const{data:j}=et(p);let g;e[10]!==n?(g=function(M,P,I){n({type:ce.GROUP,group_id:M,group_name:P,capabilities:{...ft},is_scim_managed:I}),d("")},e[10]=n,e[11]=g):g=e[11];const S=g;let y;e[12]!==o||e[13]!==n?(y=function(M,P,I){o&&(n({type:ce.USER,user_id:M,user_name:P,user_email:I,capabilities:{...ft}}),d(""))},e[12]=o,e[13]=n,e[14]=y):y=e[14];const w=y;let C;e[15]!==o||e[16]!==r||e[17]!==l?(C=o?.isEnterprisey()?r.formatMessage({id:"72/DBb",defaultMessage:"Add people and groups from {workspaceName}"},{workspaceName:l}):r.formatMessage({id:"xF0Ixa",defaultMessage:"Add people from {workspaceName}"},{workspaceName:l}),e[15]=o,e[16]=r,e[17]=l,e[18]=C):C=e[18];const N=C;return t.jsx("div",{className:"flex w-full flex-row space-x-3",children:t.jsx(Qs,{label:N,name:"share-with-input",inputValue:i,onInputChange:d,suggestions:[...m?.map(k=>{const{id:M,account_user_id:P,name:I,email:G}=k;return{id:M,className:"flex flex-col rounded-xs p-1 hover:bg-token-main-surface-tertiary",focusedClassName:"bg-token-main-surface-tertiary",onClick:()=>w(P,I??"Unknown User",G??""),children:t.jsx(Go,{name:I??"Unknown User",email:G??""})}})??[],...j?.items.slice(0,5).map(k=>{const{id:M,name:P,is_scim_managed:I,num_members:G}=k;return{id:M,className:"flex flex-col rounded-xs p-1 hover:bg-token-main-surface-tertiary",focusedClassName:"bg-token-main-surface-tertiary",onClick:()=>S(M,P,I??!1),children:t.jsx(Eo,{name:P,isScimManaged:I??!1,numMembers:G})}})??[]]})})}function Go({name:s,email:e}){return t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"w-full font-semibold",children:s}),t.jsx("span",{className:"text-token-text-secondary text-sm",children:e})]})}function Eo(s){"use forget";const e=L.c(12),{name:n,isScimManaged:a,numMembers:r}=s;let o;e[0]!==n?(o=t.jsx("span",{className:"me-2 font-semibold",children:n}),e[0]=n,e[1]=o):o=e[1];let i;e[2]!==a?(i=a&&t.jsx(Ms,{}),e[2]=a,e[3]=i):i=e[3];let d;e[4]!==o||e[5]!==i?(d=t.jsxs("span",{className:"flex flex-row",children:[o,i]}),e[4]=o,e[5]=i,e[6]=d):d=e[6];let c;e[7]!==r?(c=t.jsx("span",{className:"text-token-text-secondary text-sm",children:t.jsx(v,{id:"r3Rx6X",defaultMessage:"{numMembers, plural, one {1 member} other {# members}}",values:{numMembers:r}})}),e[7]=r,e[8]=c):c=e[8];let l;return e[9]!==d||e[10]!==c?(l=t.jsxs("span",{className:"flex flex-col",children:[d,c]}),e[9]=d,e[10]=c,e[11]=l):l=e[11],l}function Do(s,e){return s===void 0||e===void 0?!1:s.split("__")[0]===e.split("__")[0]}const _s=Pe.div`text-sm text-red-500`,Ao=Pe.textarea`w-full overflow-y-auto overflow-x-clip rounded-lg border px-3 py-2 focus:ring-2 focus:ring-token-text-primary border-token-border-medium bg-token-main-surface-primary`,qe=20;function ks({onClose:s,gizmo:e}){const n=$(),[a,r]=_.useState(e?.gizmo?.instructions||""),{name:o}=se(),i=o?ne:ae,d=Ae(),c=Re(),l=[];a?.length>xt&&l.push(n.formatMessage(i.instructionsTooLong,{length:xt}));const m=j=>{r(j.target.value)},f=()=>{s()},x=async()=>{try{await d.mutateAsync({update:{instructions:a??""},id:e.gizmo.id}),s()}catch(j){const g=Tt(j);c.danger(g??"Error",{duration:2})}},h=t.jsx(Xe.Button,{title:n.formatMessage(i.save),color:"primary",onClick:x,loading:d.isPending,disabled:l.length>0}),u=t.jsx(Xe.Button,{title:n.formatMessage(i.cancel),color:"secondary",onClick:f,disabled:d.isPending}),p=ke(e);return t.jsx(Ue,{testId:"modal-project-custom-instructions",className:"min-h-[50dvh] max-w-[820px]",isOpen:!0,showCloseButton:!d.isPending,hideSeparator:!0,noPadding:!0,size:"custom",type:"success",title:t.jsx("div",{className:"h-8",children:n.formatMessage(i.editCustomInstructionsTitle)}),onClose:()=>{d.isPending||s()},children:t.jsxs("div",{className:"flex h-full flex-col px-6 pt-0 pb-7",children:[t.jsx("div",{className:"text-sm font-medium",children:n.formatMessage(p?i.editCustomInstructionsSubtitle:i.readOnlyCustomInstructionsTitle)}),t.jsx("div",{className:"text-token-text-secondary text-sm",children:n.formatMessage(p?i.editCustomInstructionsDescription:i.readOnlyCustomInstructionsDescription)}),t.jsx(Ao,{autoFocus:!0,placeholder:n.formatMessage(i.projectInstructionsPlaceholder),className:"bg-token-main-surface-primary mt-4 mb-1 min-h-24 w-full grow resize-none rounded-md",onChange:m,value:a,disabled:d.isPending||!p}),l.map(j=>t.jsx(_s,{className:"mt-1",children:j},j)),p&&t.jsx(Xe.Actions,{primaryButton:h,secondaryButton:u})]})})}function Oo({gizmoId:s,gizmoName:e,canEdit:n,gizmoEditorData:a,openFileDialog:r,pendingFiles:o,setVersion:i,pendingFileUpsertMutationsRef:d,currentModelConfig:c}){const l=a?.files?.reduce((g,S)=>g+(S.file_size_tokens??0),0)??0,m=a?.contextStuffingBudget;let f;m&&(f=l/m,l>0&&f<.01&&(f=.01));const x=a?.files??[],h=Array.from(o.current.values()).filter(g=>x.every(S=>S.file_id!==g.fileId)),u=h.filter(g=>c!=null&&gt(c,g.file.type,g.file.name)===jt.CodeInterpreter),p=x.filter(g=>c!=null&&g.type!=null&&gt(c,g.type,g.name)===jt.CodeInterpreter),j=[...u.map(g=>g.tempId),...p.map(g=>g.file_id)];return t.jsx(rn,{gizmoId:s,gizmoName:e,canEdit:n,pendingFiles:h,pendingFileUpsertMutationsRef:d,files:x,modelCapacityUsed:f,interpreterOnlyFileIds:j,onAddFiles:r,removePendingFile:g=>{o.current.delete(g),i(S=>S+1)}})}const Ro=_.forwardRef(function({gizmo:e,showInstructions:n=!0},a){const r=$(),{name:o}=se(),i=o?ne:ae,[d,c]=_.useState(!1),l=Ae(),m=Zs(e),f=ss(m),{data:x}=bs(),h=x?.models.get(Xa)??(x&&Js(x.models.values(),K=>K.tags.includes(Qa.GPT_4o))),u=Re(),[p,j]=_.useState(0),g=_.useRef(new Map),S=_.useRef([]),y=en(h,void 0),w=K=>{K.some(({errors:A})=>A.length!==1||A[0]?.code!==Ht.TooManyFiles)?u.danger(r.formatMessage(i.unknownError),{duration:2}):u.danger(r.formatMessage(i.dragTooManyFilesError,{MAX_FILES_PER_PROJECT:qe}),{duration:2})},C=async K=>{Q.logEvent("Upload File",{client:"web",eventSource:"mouse",intent:"gizmo"});const A=m.id;K.length>0&&await Promise.all(K.map(H=>{const J=cn(H);g.current.set(J,{tempId:J,gizmoId:A,file:H,status:mt.Uploading,progress:1,fileId:null,cdnUrl:null}),dn(J,H,r,u,{kind:Za.Gizmo,gizmoId:A},{onFileUploaded:async(F,O,V,q)=>{const R=g.current.get(F);R?.fileId&&R?.fileId&&(S.current.push({id:e.gizmo.id,mutationId:Gs(),update:W=>{if(!R.fileId)return W;const Y=[...W.files??[],{file_id:R.fileId,name:R.file.name,size:R.file.size,type:q?.mimeType??mn(R.file),last_modified:R.file.lastModified,file_size_tokens:q?.fileTokenSize}];return{...W,files:Y}},onSuccess:()=>{g.current.delete(F),j(W=>W+1)}}),un(e.gizmo.id)({gizmoId:e.gizmo.id,upsertProjectMutation:l,pendingFileUpsertMutationsRef:S}))},onFileCreated:(F,O,V)=>{g.current.set(F,{tempId:F,gizmoId:A,file:H,status:mt.Uploading,progress:1,...g.current.get(F),fileId:O,cdnUrl:V}),j(q=>q+1)},onFileUploadProgress:(F,O)=>{const V=g.current.get(F);V?.status===mt.Uploading&&g.current.set(F,{...V,progress:O>95?95:O}),j(q=>q+1)},onError:F=>{g.current.delete(F),j(O=>O+1)}},{usesRetrievalIndex:h!=null&&gt(h,H.type,H.name)===jt.Retrieval})}))},N=tn(y),k=So(N),M=g.current.size+m.files.length,P=ke(e),{open:I,getInputProps:G,getRootProps:B,isDragAccept:z,isDragReject:Z}=Co({noClick:!0,noDragEventsBubbling:!0,onDropAccepted:C,onDropRejected:w,multiple:!0,maxSize:ln,maxFiles:qe-M,validator:()=>M>=qe?{code:Ht.TooManyFiles,message:"Too many files"}:null,...N});return _.useImperativeHandle(a,()=>({openFileDialog:I})),t.jsxs("div",{...B({className:"h-full px-6"}),children:[t.jsx("input",{...G()}),n&&t.jsxs(sn,{children:[t.jsx("button",{className:"w-full",onClick:()=>c(!0),children:t.jsx("div",{className:"border-token-border-default w-full rounded-lg border text-start text-sm",children:m?.instructions?.length?t.jsx("div",{className:"mx-4 my-3 line-clamp-4",children:m.instructions}):t.jsxs("div",{className:"text-token-text-secondary flex h-full w-full items-center px-4 py-3",children:[t.jsx("div",{className:"flex-1",children:t.jsx(v,{...i.addCustomInstructions})}),t.jsx(tt,{className:"icon-sm"})]})})}),f.includes(nn.GizmoInstructionsTooLong)?t.jsx(_s,{className:"mt-1",children:t.jsx(v,{...i.instructionsTooLong,values:{length:xt}})}):null]}),d&&t.jsx(ks,{gizmo:e,onClose:()=>{c(!1)}}),t.jsx(Oo,{gizmoId:e.gizmo.id,gizmoName:e.gizmo.display.name,canEdit:P,gizmoEditorData:m,openFileDialog:I,pendingFiles:g,pendingFileUpsertMutationsRef:S,setVersion:j,currentModelConfig:h}),z&&t.jsxs(yt,{children:[t.jsx(an,{}),t.jsx("h3",{children:t.jsx(v,{...i.dragInstructions})}),t.jsx("h4",{className:"w-2/3 text-center",children:k.length>0?k.join(", "):t.jsx(v,{...i.dragAllAccepted})})]}),Z&&t.jsxs(yt,{children:[t.jsx(on,{className:"icon-2xl"}),t.jsx("h3",{children:t.jsx(v,{...i.dragTooManyFiles})}),t.jsx("h4",{className:"w-2/3 text-center",children:t.jsx(v,{...i.dragTooManyFilesDescription,values:{MAX_FILES_PER_PROJECT:qe}})})]})]})});function Uo({gizmo:s,onClose:e}){const n=_.useRef(null),a=_.useCallback(()=>{n.current?.openFileDialog()},[n]),r=ke(s),{name:o}=se(),i=o?ne:ae;return t.jsx(t.Fragment,{children:t.jsx(Ue,{testId:"modal-project-files",className:"min-h-72 max-w-[820px]",isOpen:!0,showCloseButton:!0,hideSeparator:!0,noPadding:!0,size:"custom",type:"success",onClose:()=>{e()},children:t.jsxs("div",{className:"flex h-full flex-col",children:[t.jsx(Xe.TitleBar,{$hasSeparator:!1,children:t.jsxs("div",{className:"flex w-full items-center gap-2",children:[t.jsx("div",{className:"flex-1",children:t.jsx(Ja,{className:"text-token-text-primary text-lg leading-6 font-semibold",children:t.jsx(v,{...i.projectFilesModalTitle})})}),r&&t.jsx(je,{color:"secondary",onClick:a,children:t.jsx(v,{...i.addFilesButtonLabel})}),t.jsx(eo,{asChild:!0,className:"sm:mt-0",children:t.jsx(ys,{onClick:e})})]})}),t.jsx("div",{className:"h-[50dvh] grow overflow-y-auto pt-0",children:t.jsx(Ro,{ref:n,gizmo:s,showInstructions:!1})})]})})})}function Lo({gizmo:s}){return t.jsx("div",{className:"mt-6 grid grid-cols-2 items-start",children:s?t.jsxs(t.Fragment,{children:[t.jsx(Bo,{gizmo:s,className:"rounded-[20px_0px_0px_20px] [border-width:1px_0.5px_1px_1px]"}),t.jsx(qo,{gizmo:s,className:"rounded-[0px_20px_20px_0px] [border-width:1px_1px_1px_0.5px]"})]}):t.jsxs(t.Fragment,{children:[t.jsx(Yt,{}),t.jsx(Yt,{})]})})}function Ot({className:s,header:e,context:n,contextClassName:a="",icon:r,modal:o,onClick:i,disabled:d=!1,isModalOpen:c=!1}){return t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:i,disabled:d,className:U("group/snorlax-control-tile border-token-border-light bg-token-bg-primary hover:bg-token-bg-tertiary active:bg-token-bg-tertiary relative h-full rounded-2xl border disabled:pointer-events-none disabled:opacity-50",s),children:t.jsxs("div",{className:"relative mx-5 my-4 flex items-center justify-between gap-3 overflow-hidden",children:[t.jsxs("div",{className:"w-full grow text-start",children:[t.jsx("div",{className:"text-sm font-medium",children:e}),t.jsx("div",{className:U("text-token-text-secondary text-xs",a),children:n})]}),r]})}),c&&o]})}function Yt(){return t.jsx(Ot,{disabled:!0,header:t.jsx("div",{className:"bg-token-bg-tertiary my-2 h-2 w-48 rounded-full"}),context:t.jsx("div",{className:"bg-token-bg-tertiary my-2 h-2 w-32 rounded-full"})})}function Bo({className:s,gizmo:e}){const{files:n}=e,a=!n.length,r=nt(e),[o,i]=_.useState(!1),{name:d}=se(),c=d?ne:ae,l=o&&t.jsx(Uo,{gizmo:e,onClose:()=>{i(!1)}}),m=()=>i(!0);let f,x,h;const u=ke(e);if(a)f=t.jsx(v,{...u?c.addFilesButtonLabel:c.viewFilesButtonLabel}),x=t.jsx(v,{...u?c.filesControlDescription:c.noFilesReadOnlyDescription}),h=t.jsxs("div",{className:"relative flex h-10 w-10 shrink-0 items-center justify-center rounded-full",children:[t.jsx("div",{className:"bg-token-bg-tertiary absolute h-full w-full rounded-full opacity-5",style:{backgroundColor:r??void 0}}),u?t.jsx(hn,{className:"icon-md h-5 w-5",style:{color:r}}):t.jsx(pn,{className:"icon-md h-5 w-5",style:{color:r}})]});else{const j=n.slice(0,3);f=t.jsx(v,{...c.projectFilesModalTitle}),x=t.jsx(v,{...c.filesCount,values:{count:n.length}}),h=t.jsx("div",{className:"relative flex h-10 w-20 shrink-0 items-center justify-center rounded-full",children:j.toReversed().map((g,S)=>t.jsx(Ho,{file:g,index:S,gizmoId:e.gizmo.id},g.id))})}return t.jsx(Ot,{className:s,isModalOpen:o,modal:l,onClick:m,header:f,context:x,icon:h,disabled:a&&!u})}function Ho({file:s,index:e,gizmoId:n}){const a=s.name,o=fn(a)&&s.file_id!=null&&t.jsx(xn,{fileName:a,fileId:s.file_id,gizmoId:n,className:"rotate-[-6deg] [box-shadow:0px_4px_16px_0px_rgba(0,0,0,0.05)]"});return t.jsx("div",{className:"border-token-bg-primary group-hover/snorlax-control-tile:border-token-bg-tertiary absolute end-0 top-0 h-10 w-10 overflow-hidden rounded-xl border-2",style:{transform:`translateX(${e*-20}px)`},children:o||t.jsx(gn,{className:"h-9 w-9 shrink-0 rotate-[-6deg] [box-shadow:0px_4px_16px_0px_rgba(0,0,0,0.05)]",filename:s.name,contextConnectorInfo:void 0})})}function qo({gizmo:s,className:e}){const{instructions:n}=s.gizmo,a=!n.length,r=nt(s),[o,i]=_.useState(!1),{name:d}=se(),c=d?ne:ae,l=o&&t.jsx(ks,{gizmo:s,onClose:()=>{i(!1)}}),m=()=>i(!0);let f,x,h,u;const p=ke(s);return a?(f=t.jsx(v,{...p?c.customInstructionsTitle:c.customInstructionsReadOnlyTitle}),x=t.jsx(v,{...p?c.customInstructionsDescription:c.customInstructionsReadOnlyDescription}),h=t.jsxs("div",{className:"relative flex h-10 w-10 shrink-0 items-center justify-center rounded-full",children:[t.jsx("div",{className:"bg-token-main-surface-secondary absolute h-full w-full rounded-full opacity-5",style:{backgroundColor:r??void 0}}),t.jsx(tt,{className:"icon-md h-5 w-5",style:{color:r}})]})):(f=t.jsx(v,{...c.editCustomInstructionsTitle}),u="overflow-hidden text-ellipsis whitespace-nowrap",x=n),t.jsx(Ot,{className:e,isModalOpen:o,modal:l,onClick:m,header:f,context:x,icon:h,contextClassName:u,disabled:a&&!p})}const $o=()=>t.jsx("div",{className:"ms-1 mt-3 h-10",children:t.jsx("div",{className:"bg-token-tertiary my-[15px] h-[10px] w-48 rounded-full"})}),Xt=new Map;function Vo(s){const e=Xt.get(s);if(e)return e;const n=In(Wo,2e3,{trailing:!0});return Xt.set(s,n),n}async function Wo({gizmoId:s,upsertProjectMutation:e,toaster:n}){const a=Pn,r=$t(a.getState(),"theme",s);try{r!==void 0&&await e.mutateAsync({id:s,update:{theme:r??void 0}}),$t(a.getState(),"theme",s)===r&&Fn(s,"theme")}catch(o){const i=Tt(o);n.warning(i??"Error",{duration:2})}}function Ko({gizmoId:s,theme:e,upsertProjectMutation:n,toaster:a}){kn(s,"theme",e),Vo(s)({gizmoId:s,upsertProjectMutation:n,toaster:a})}function Yo(s){"use forget";const e=L.c(15),{gizmo:n}=s,a=nt(n),r=Ae(),[o,i]=_.useState(!1),d=Re();let c;e[0]!==a||e[1]!==n||e[2]!==d||e[3]!==r?(c=u=>{u!==a&&(Q.logEventWithStatsig("Projects: Theme Change","chatgpt_web_projects_theme_change",{theme:u??"default"}),Ko({gizmoId:n.gizmo.id,theme:u,upsertProjectMutation:r,toaster:d}))},e[0]=a,e[1]=n,e[2]=d,e[3]=r,e[4]=c):c=e[4];const l=c;let m;e[5]===Symbol.for("react.memo_cache_sentinel")?(m=u=>i(u),e[5]=m):m=e[5];let f;e[6]!==a?(f=t.jsx(os,{currentTheme:a}),e[6]=a,e[7]=f):f=e[7];let x;e[8]!==a||e[9]!==l?(x=t.jsx(wn,{currentTheme:a,onSelect:l}),e[8]=a,e[9]=l,e[10]=x):x=e[10];let h;return e[11]!==o||e[12]!==f||e[13]!==x?(h=t.jsx(_n,{open:o,sideOffset:4,alignOffset:7,side:"bottom",alignAgainstAnchor:"start",size:"none",modal:!0,onOpenChange:m,triggerButton:f,children:x}),e[11]=o,e[12]=f,e[13]=x,e[14]=h):h=e[14],h}function Xo(s){"use forget";const e=L.c(2),{gizmo:n}=s;let a;return e[0]!==n?(a=t.jsx("div",{className:"mb-8 inline-flex gap-2 self-center",children:n?t.jsxs("div",{className:"text-page-header inline-block px-4 text-center",children:[n?t.jsx(Yo,{gizmo:n}):t.jsx(os,{disabled:!0,currentTheme:null}),t.jsxs("a",{href:"#edit-title",role:"button",className:"group hover:text-token-text-secondary relative ms-2 text-balance",onClick:Qo,children:[n.gizmo.display.name,t.jsx(Nn,{})]})]}):t.jsx($o,{})}),e[0]=n,e[1]=a):a=e[1],a}function Qo(s){s.preventDefault(),_t.setShowProjectSettingsModal(!0)}function Zo(s){"use forget";const e=L.c(2),{children:n}=s;let a;return e[0]!==n?(a=t.jsx("div",{className:"group relative flex flex-col gap-1 p-4",children:t.jsx("div",{className:"flex items-center gap-4",children:n})}),e[0]=n,e[1]=a):a=e[1],a}function Jo(s){"use forget";const e=L.c(23),{conversation:n,gizmo:a}=s,r=vt(n.id,ei)??n.title,[o,i]=_.useState(!1);let d,c;e[0]!==n.id?(d=()=>to(Ns,{editTitleInMainScreen:g=>{const{serverThreadId:S}=g;S===n.id&&i(!0)}}),c=[n.id],e[0]=n.id,e[1]=d,e[2]=c):(d=e[1],c=e[2]),_.useEffect(d,c);const{snippet:l}=n;let m;e[3]!==n||e[4]!==r||e[5]!==o?(m=o?t.jsx(zn,{conversationId:n.id,historyConversationResponse:n,onClose:()=>{i(!1)}}):t.jsx("div",{className:"text-sm font-medium",children:r}),e[3]=n,e[4]=r,e[5]=o,e[6]=m):m=e[6];let f;e[7]!==l?(f=l&&t.jsx("div",{className:"text-token-text-secondary truncate text-sm",children:l}),e[7]=l,e[8]=f):f=e[8];let x;e[9]!==m||e[10]!==f?(x=t.jsxs("div",{className:"can-hover:group-hover:me-5 grow overflow-hidden",children:[m,f]}),e[9]=m,e[10]=f,e[11]=x):x=e[11];let h;e[12]!==n||e[13]!==o?(h=!o&&t.jsx(ti,{conversation:n}),e[12]=n,e[13]=o,e[14]=h):h=e[14];let u;e[15]!==x||e[16]!==h?(u=t.jsxs(Zo,{children:[x,h]}),e[15]=x,e[16]=h,e[17]=u):u=e[17];const p=u;let j;return e[18]!==p||e[19]!==n.id||e[20]!==a||e[21]!==o?(j=o?p:t.jsx(Jt,{to:Tn(n.id,a),draggable:!1,children:p}),e[18]=p,e[19]=n.id,e[20]=a,e[21]=o,e[22]=j):j=e[22],j}function ei(s){return s?.title}function ti(s){"use forget";const e=L.c(10),{conversation:n}=s,[a,r]=_.useState(!1),o=a?"flex":"can-hover:group-hover:flex hidden";let i;e[0]!==o?(i=U("absolute end-0 top-0 bottom-0 items-center gap-1.5 pe-4",o),e[0]=o,e[1]=i):i=e[1];let d;e[2]!==n?(d=m=>{r(m),m&&Q.logEvent("Conversation History Item Open Menu",{conversationId:n.id})},e[2]=n,e[3]=d):d=e[3];let c;e[4]!==n||e[5]!==d?(c=t.jsx(vo,{conversation:n,onOpenChange:d,inMainScreen:!0,isActiveConversation:!1}),e[4]=n,e[5]=d,e[6]=c):c=e[6];let l;return e[7]!==i||e[8]!==c?(l=t.jsx("div",{className:i,onClick:si,children:c}),e[7]=i,e[8]=c,e[9]=l):l=e[9],l}function si(s){s.preventDefault()}function ni(s){"use forget";const e=L.c(19),{gizmo:n}=s;Mn(n.gizmo.id);const{items:a,hasNextPage:r,fetchNextPage:o,isLoading:i,isFetching:d,isFetchingNextPage:c}=is(n.gizmo.id),l=_.useRef(null);let m;e[0]!==r||e[1]!==d||e[2]!==i||e[3]!==o?(m=S=>{i||S==null||(l.current?.disconnect(),l.current=new IntersectionObserver(y=>{y[0].isIntersecting&&r&&!d&&o()}),l.current.observe(S))},e[0]=r,e[1]=d,e[2]=i,e[3]=o,e[4]=m):m=e[4];const f=m;let x,h;e[5]===Symbol.for("react.memo_cache_sentinel")?(x=()=>()=>{l.current?.disconnect()},h=[],e[5]=x,e[6]=h):(x=e[5],h=e[6]),_.useEffect(x,h);const u=a.length;let p;e[7]!==u||e[8]!==n||e[9]!==r||e[10]!==f||e[11]!==i||e[12]!==a?(p=u||i?t.jsx(oi,{gizmo:n,items:a??[],hasNextPage:r,infiniteScrollTriggerElementRef:f}):t.jsx(ai,{}),e[7]=u,e[8]=n,e[9]=r,e[10]=f,e[11]=i,e[12]=a,e[13]=p):p=e[13];let j;e[14]!==c?(j=c&&t.jsx("div",{className:"m-4 mb-5 flex justify-center",children:t.jsx(Cs,{})}),e[14]=c,e[15]=j):j=e[15];let g;return e[16]!==p||e[17]!==j?(g=t.jsxs("div",{className:"mt-6 mb-14 contain-inline-size",children:[p,j]}),e[16]=p,e[17]=j,e[18]=g):g=e[18],g}function ai(){"use forget";const s=L.c(3),{name:e}=se(),n=e?ne:ae;let a;s[0]===Symbol.for("react.memo_cache_sentinel")?(a=t.jsx(rs,{className:"icon-lg text-token-interactive-icon-tertiary-default mb-2"}),s[0]=a):a=s[0];let r;return s[1]!==n.emptyChatsInProjectTitle?(r=t.jsxs("div",{className:"mt-8 flex flex-col items-center font-medium",children:[a,t.jsx("div",{className:"text-token-text-secondary text-sm",children:t.jsx(v,{...n.emptyChatsInProjectTitle})})]}),s[1]=n.emptyChatsInProjectTitle,s[2]=r):r=s[2],r}function oi(s){"use forget";const e=L.c(14),{gizmo:n,items:a,hasNextPage:r,infiniteScrollTriggerElementRef:o}=s,i=a.length;let d;if(e[0]!==i||e[1]!==n||e[2]!==r||e[3]!==o||e[4]!==a){let l;e[6]!==i||e[7]!==n||e[8]!==r||e[9]!==o||e[10]!==a.length?(l=(m,f)=>{const x=r&&f===a.length-3?o:void 0;return t.jsx("li",{ref:x,className:U("hover:bg-token-bg-tertiary first:rounded-t-lg last:rounded-b-lg",f!==i-1&&"border-token-border-xlight border-b"),children:t.jsx(Jo,{conversation:m,gizmo:n})},m.id)},e[6]=i,e[7]=n,e[8]=r,e[9]=o,e[10]=a.length,e[11]=l):l=e[11],d=a.map(l),e[0]=i,e[1]=n,e[2]=r,e[3]=o,e[4]=a,e[5]=d}else d=e[5];let c;return e[12]!==d?(c=t.jsx(t.Fragment,{children:t.jsx("ol",{children:d})}),e[12]=d,e[13]=c):c=e[13],c}function Rt(s,e){"use forget";const n=L.c(14),a=jn(),r=me(),o=Se(),i=ns(),d=Ke.useStore(),c=a?.kind==="conversation"&&a.gizmoId!==e;let l;n[0]!==o||n[1]!==d||n[2]!==i?(l=async function(p){const{conversation:j,newGizmoId:g,previousGizmoId:S}=p;d.expandProject(g),await i({newGizmoId:g,conversation:j,previousGizmoId:S}),o(`/g/${g}/project`)},n[0]=o,n[1]=d,n[2]=i,n[3]=l):l=n[3];const m=l;let f;n[4]!==m||n[5]!==c||n[6]!==r||n[7]!==a||n[8]!==e||n[9]!==s?(f=()=>{if(!c)return;const{conversation:u,gizmoId:p}=a;if(e)return m({conversation:u,newGizmoId:e,previousGizmoId:p});rt(r,j=>{const{closeModal:g}=j;return t.jsx(wt,{onClose:g,onSuccess:S=>{if(!S)return;const y=m({conversation:u,newGizmoId:S,previousGizmoId:p});return Q.logEventWithStatsig("Projects: Create Open","chatgpt_web_projects_create_open",{source:s}),y}})})},n[4]=m,n[5]=c,n[6]=r,n[7]=a,n[8]=e,n[9]=s,n[10]=f):f=n[10];const x=f;let h;return n[11]!==c||n[12]!==x?(h={canDropConversation:c,onDropConversation:x},n[11]=c,n[12]=x,n[13]=h):h=n[13],h}function ii(s){"use forget";const e=L.c(46),{clientThreadId:n,gizmoId:a,currentModelId:r,onRequestCompletion:o}=s,i=$(),{name:d}=se(),c=d?ne:ae,{data:l}=Mt(a),m=qt(di),f=qt(ci),{onDropConversation:x,canDropConversation:h}=Rt(void 0,a),[u,p]=_.useState(!1);let j;e[0]!==h?(j=z=>{z.preventDefault(),h&&p(!0)},e[0]=h,e[1]=j):j=e[1];let g;e[2]!==h||e[3]!==x?(g=z=>{z.preventDefault(),h&&(p(!1),x())},e[2]=h,e[3]=x,e[4]=g):g=e[4];let S,y;e[5]!==h?(S=z=>{z.preventDefault(),h&&p(!0)},y=z=>{z.preventDefault(),h&&p(!1)},e[5]=h,e[6]=S,e[7]=y):(S=e[6],y=e[7]);let w;e[8]!==l?(w=t.jsx(Xo,{gizmo:l}),e[8]=l,e[9]=w):w=e[9];let C;e[10]!==n||e[11]!==r||e[12]!==l||e[13]!==o?(C=l?t.jsx(bo,{clientThreadId:n,isNewThread:!0,currentModelId:r,onContinueGenerating:z=>o(bn(z)),onRequestCompletion:async z=>o(await Sn(z)),hideHeader:!0}):t.jsx("div",{className:"bg-token-tertiary h-24 w-full rounded-3xl"}),e[10]=n,e[11]=r,e[12]=l,e[13]=o,e[14]=C):C=e[14];let N,k;e[15]!==l?(N=t.jsx(Lo,{gizmo:l}),k=l&&t.jsx(ni,{gizmo:l}),e[15]=l,e[16]=N,e[17]=k):(N=e[16],k=e[17]);let M;e[18]!==l||e[19]!==a||e[20]!==f?(M=l&&f&&t.jsx(To,{gizmo:vn(l),publishedGizmo:l,onClose:li},a),e[18]=l,e[19]=a,e[20]=f,e[21]=M):M=e[21];let P;e[22]!==c||e[23]!==l||e[24]!==a||e[25]!==i||e[26]!==m?(P=m&&t.jsx(wt,{submitButtonTitle:i.formatMessage(c.projectSettingsSubmitButton),gizmo:l,onClose:ri},a),e[22]=c,e[23]=l,e[24]=a,e[25]=i,e[26]=m,e[27]=P):P=e[27];let I;e[28]!==c||e[29]!==l?.gizmo||e[30]!==u?(I=u&&t.jsxs(yt,{children:[t.jsx(as,{className:"h-12 w-12",style:{color:"#3C46FF"}}),t.jsx("h3",{className:"text-center",children:t.jsx(v,{...c.addConversationToNamedSnorlax,values:{projectName:l?.gizmo.display.name??"project"}})}),t.jsx("h4",{className:"text-center",children:t.jsx(v,{...c.moveConversation})})]}),e[28]=c,e[29]=l?.gizmo,e[30]=u,e[31]=I):I=e[31];let G;e[32]!==P||e[33]!==I||e[34]!==w||e[35]!==C||e[36]!==N||e[37]!==k||e[38]!==M?(G=t.jsx(yn,{verticalPadding:"none",horizontalPadding:"standard",overflowY:"auto",fullHeight:!0,children:t.jsxs(Cn,{column:!0,shouldRemoveGap:!0,className:"min-w-[min(90cqw,640px)]",children:[w,C,N,k,M,P,I]})}),e[32]=P,e[33]=I,e[34]=w,e[35]=C,e[36]=N,e[37]=k,e[38]=M,e[39]=G):G=e[39];let B;return e[40]!==j||e[41]!==G||e[42]!==g||e[43]!==S||e[44]!==y?(B=t.jsx("div",{onDragOver:j,onDrop:g,onDragEnter:S,onDragLeave:y,className:"flex max-h-full min-h-full flex-col md:pt-[calc(var(--header-height)+20px)]",children:G}),e[40]=j,e[41]=G,e[42]=g,e[43]=S,e[44]=y,e[45]=B):B=e[45],B}function ri(){_t.setShowProjectSettingsModal(!1)}function li(){_t.setShowShareModal(!1)}function ci(s){return s.showShareModal}function di(s){return s.showProjectSettingsModal}const mi=Object.freeze(Object.defineProperty({__proto__:null,SnorlaxSplashScreen:ii,useProjectsDragDrop:Rt},Symbol.toStringTag,{value:"Module"})),ui=ze(()=>Te(()=>import("./d93ofje6cuqhnn4o.js"),__vite__mapDeps([2,1,3,4,5])).then(s=>s.SnorlaxFolderAnimation),{loading:({color:s})=>t.jsx(Ut,{color:s})}),fi={open:{opacity:1,y:0,transition:{duration:.15,ease:"easeOut"}},closed:{opacity:0,y:-5,transition:{duration:.15,ease:"easeIn"}}};function xi(s){"use forget";const e=L.c(21),{color:n,folderState:a,gizmoId:r,sidebarSnorlaxFolderStore:o}=s,i=$(),[d,c]=_.useState(!1),{name:l}=se(),m=l?ne:ae;let f;e[0]!==m.hideChatsForProjectTooltip||e[1]!==m.showChatsForProjectTooltip||e[2]!==a||e[3]!==i?(f=a==="open"?i.formatMessage(m.hideChatsForProjectTooltip):i.formatMessage(m.showChatsForProjectTooltip),e[0]=m.hideChatsForProjectTooltip,e[1]=m.showChatsForProjectTooltip,e[2]=a,e[3]=i,e[4]=f):f=e[4];let x;e[5]!==a||e[6]!==r||e[7]!==o?(x=y=>{y.preventDefault(),a==="open"?o.collapseProject(r):o.expandProject(r)},e[5]=a,e[6]=r,e[7]=o,e[8]=x):x=e[8];let h,u;e[9]===Symbol.for("react.memo_cache_sentinel")?(h=()=>{c(!0)},u=()=>{c(!1)},e[9]=h,e[10]=u):(h=e[9],u=e[10]);const p=a==="open";let j;e[11]!==n||e[12]!==d||e[13]!==p?(j=t.jsx(ui,{isOpen:p,isHovered:d,color:n}),e[11]=n,e[12]=d,e[13]=p,e[14]=j):j=e[14];let g;e[15]!==x||e[16]!==j?(g=t.jsx("button",{className:"icon",onClick:x,onMouseEnter:h,onMouseLeave:u,children:j}),e[15]=x,e[16]=j,e[17]=g):g=e[17];let S;return e[18]!==f||e[19]!==g?(S=t.jsx(Ie,{label:f,triggerAs:null,children:g}),e[18]=f,e[19]=g,e[20]=S):S=e[20],S}function Ut(s){"use forget";const e=L.c(2),{color:n}=s;let a;return e[0]!==n?(a=t.jsx(ht,{className:"icon",style:{color:n}}),e[0]=n,e[1]=a):a=e[1],a}function pr(s){"use forget";const e=L.c(88),{gizmo:n,historyDisabled:a,flair:r,onClick:o,isActive:i,hideOverflowMenu:d}=s,c=d===void 0?!1:d,l=me(),{clientThreadId:m}=At(),f=Pt(m),x=Se(),h=$(),u=n.gizmo.id,p=Ke.useStore();let j;e[0]!==u?(j=D=>Ke.selectFolderState(D,u),e[0]=u,e[1]=j):j=e[1];const g=Ke.useState(j);let S;e[2]!==n.gizmo.tags?(S=n.gizmo.tags?.includes(kt.FirstParty),e[2]=n.gizmo.tags,e[3]=S):S=e[3];const y=!!S,{items:w,hasNextPage:C}=is(n.gizmo.id);let N;e[4]!==w?(N=w===void 0?[]:w,e[4]=w,e[5]=N):N=e[5];const k=N,M=at(u),P=nt(n),I=i&&(!M||!(g==="open"&&f)),G=_.useRef(g);let B,z;e[6]!==g?(B=()=>{G.current=g},z=[g],e[6]=g,e[7]=B,e[8]=z):(B=e[7],z=e[8]),_.useEffect(B,z);let Z,K;e[9]!==u||e[10]!==i||e[11]!==f||e[12]!==p?(Z=()=>{G.current!=="open"&&i&&f&&p.expandProject(u)},K=[i,f,p,u],e[9]=u,e[10]=i,e[11]=f,e[12]=p,e[13]=Z,e[14]=K):(Z=e[13],K=e[14]),_.useEffect(Z,K);let A;if(n!=null)A=n.gizmo.display.name||Gn;else if(a){let D;e[15]!==h?(D=h.formatMessage(ls.clearChat),e[15]=h,e[16]=D):D=e[16],A=D}else A=Dn;const[H,J]=_.useState();let F;e[17]===Symbol.for("react.memo_cache_sentinel")?(F=()=>{J(void 0)},e[17]=F):F=e[17];let O;e[18]!==n?(O=[n],e[18]=n,e[19]=O):O=e[19],_.useEffect(F,O);const V=Ae(),[q,R]=_.useState(!1),[ee,W]=_.useState(!1),{canDropConversation:Y,onDropConversation:ue}=Rt("sidebar_row_button",u);let ie;e[20]!==l||e[21]!==n.gizmo.id||e[22]!==i||e[23]!==q||e[24]!==A||e[25]!==x||e[26]!==H||e[27]!==V?(ie=q?t.jsx(An,{initialValue:A,onCommit:async D=>{J(D),R(!1);const{resource:Fe}=await V.mutateAsync({update:{name:D},id:n.gizmo.id});Fe&&i&&x(Ge(l,Fe),{replace:!0})},onCancel:()=>{R(!1)}}):H??A,e[20]=l,e[21]=n.gizmo.id,e[22]=i,e[23]=q,e[24]=A,e[25]=x,e[26]=H,e[27]=V,e[28]=ie):ie=e[28];const fe=ie,ve=ee&&"[&>*]:pointer-events-none";let re;e[29]!==ve?(re=U(ve),e[29]=ve,e[30]=re):re=e[30];let te;e[31]!==Y||e[32]!==ue?(te=D=>{Y&&(D.preventDefault(),D.stopPropagation(),W(!1),ue())},e[31]=Y,e[32]=ue,e[33]=te):te=e[33];let le;e[34]!==Y||e[35]!==M?(le=D=>{Y&&D.target===D.currentTarget&&M&&(D.preventDefault(),W(!0))},e[34]=Y,e[35]=M,e[36]=le):le=e[36];let T;e[37]===Symbol.for("react.memo_cache_sentinel")?(T=D=>{D.target===D.currentTarget&&W(!1)},e[37]=T):T=e[37];let E;e[38]!==l||e[39]!==n?(E=Ge(l,n),e[38]=l,e[39]=n,e[40]=E):E=e[40];let X;e[41]===Symbol.for("react.memo_cache_sentinel")?(X=()=>{R(!0)},e[41]=X):X=e[41];let he;e[42]!==n.gizmo.id||e[43]!==o?(he=D=>{const Fe=n?.gizmo.id??"primary";Q.logNewChatButtonClicked({location:"Sidebar gizmo list",gizmo_id:Fe}),Q.logEvent("Sidebar Click Gizmo",{gizmo_id:Fe}),o?.(D)},e[42]=n.gizmo.id,e[43]=o,e[44]=he):he=e[44];let xe;e[45]!==P||e[46]!==g||e[47]!==u||e[48]!==n.gizmo.display||e[49]!==y||e[50]!==M||e[51]!==p||e[52]!==k?(xe=M&&k.length>0?t.jsx(xi,{color:P,folderState:g,gizmoId:u,sidebarSnorlaxFolderStore:p}):M?t.jsx(Ut,{color:P}):t.jsx(Dt,{simple:!0,isFirstParty:y,src:n?.gizmo.display.profile_picture_url,className:"icon-md",alt:""}),e[45]=P,e[46]=g,e[47]=u,e[48]=n.gizmo.display,e[49]=y,e[50]=M,e[51]=p,e[52]=k,e[53]=xe):xe=e[53];let ye;e[54]!==r?(ye=r===cs.Workspace&&t.jsx(gi,{}),e[54]=r,e[55]=ye):ye=e[55];let Ce;e[56]!==r||e[57]!==n||e[58]!==c||e[59]!==i||e[60]!==M||e[61]!==ee?(Ce=!c&&!ee&&(M?t.jsx(pi,{gizmoResource:n,isActive:i}):t.jsx(hi,{gizmoResource:n,flair:r})),e[56]=r,e[57]=n,e[58]=c,e[59]=i,e[60]=M,e[61]=ee,e[62]=Ce):Ce=e[62];let Ne;e[63]!==fe||e[64]!==I||e[65]!==ee||e[66]!==re||e[67]!==te||e[68]!==le||e[69]!==E||e[70]!==he||e[71]!==xe||e[72]!==ye||e[73]!==Ce?(Ne=t.jsx(ts,{className:re,highlighted:ee,onDrop:te,onDragEnter:le,onDragLeave:T,to:E,onDoubleClick:X,onClick:he,active:I,icon:xe,label:fe,trailing:ye,highlightTrailing:Ce}),e[63]=fe,e[64]=I,e[65]=ee,e[66]=re,e[67]=te,e[68]=le,e[69]=E,e[70]=he,e[71]=xe,e[72]=ye,e[73]=Ce,e[74]=Ne):Ne=e[74];let Me;e[75]!==g||e[76]!==n||e[77]!==C||e[78]!==M||e[79]!==f||e[80]!==I||e[81]!==k?(Me=M&&g==="open"&&k.length>0&&t.jsx(es.div,{initial:"closed",animate:"open",exit:"closed",variants:fi,className:"overflow-hidden",children:t.jsx(Io,{gizmoResource:n,serverThreadId:f,isOnProjectPage:I,conversations:k,hasNextPage:C})},"nested-conversations"),e[75]=g,e[76]=n,e[77]=C,e[78]=M,e[79]=f,e[80]=I,e[81]=k,e[82]=Me):Me=e[82];let we;e[83]!==Me?(we=t.jsx(Es,{initial:!1,children:Me}),e[83]=Me,e[84]=we):we=e[84];let Be;return e[85]!==Ne||e[86]!==we?(Be=t.jsxs(t.Fragment,{children:[Ne,we]}),e[85]=Ne,e[86]=we,e[87]=Be):Be=e[87],Be}const gi=()=>{const s=$(),e=zt(),n=e?.name?s.formatMessage({id:"gizmo.workspaceRecommended",defaultMessage:"Recommended at {workspace_name}"},{workspace_name:e.name??"Your Workspace"}):s.formatMessage({id:"gizmo.workspaceRecommended.noWorkplaceName",defaultMessage:"Recommended at your workplace"});return t.jsx(Ie,{side:"right",label:n,children:t.jsx(En,{className:"icon-md",alt:n})})},Is=ze(()=>Te(()=>import("./lclantcr99684npn.js"),__vite__mapDeps([6,1,7,3,4,8])).then(s=>s.GizmoKeepInSidebarMenuItem)),hi=s=>{"use forget";const e=L.c(10),{gizmoResource:n,flair:a}=s,r=Je();let o;e[0]===Symbol.for("react.memo_cache_sentinel")?(o=t.jsx(ds,{onMouseOver:ji,icon:It}),e[0]=o):o=e[0];let i;e[1]!==a||e[2]!==n||e[3]!==r?(i=a===cs.Recent&&t.jsx(b.Item,{onClick:()=>{ot.updateGizmoSidebar(r,On,n.gizmo.id,"keep","sidebar")},children:t.jsx(v,{...ls.keepInSidebar})}),e[1]=a,e[2]=n,e[3]=r,e[4]=i):i=e[4];let d;e[5]!==n?(d=t.jsx(Is,{gizmoResource:n,location:"sidebar"}),e[5]=n,e[6]=d):d=e[6];let c;return e[7]!==i||e[8]!==d?(c=t.jsxs(Oe,{triggerButton:o,contentAlign:"start",sideOffset:-5,alignOffset:-16,size:"auto",children:[i,d]}),e[7]=i,e[8]=d,e[9]=c):c=e[9],c},pi=s=>{"use forget";const e=L.c(11),{gizmoResource:n,isActive:a}=s,r=me(),o=Se(),{name:i}=se(),d=i?ne:ae;if(!Rn(n))return null;let c;e[0]===Symbol.for("react.memo_cache_sentinel")?(c=t.jsx(ds,{icon:It}),e[0]=c):c=e[0];let l;e[1]!==r||e[2]!==n||e[3]!==a||e[4]!==o?(l=x=>{x.preventDefault();const h=function(p){p(),a&&o("/")};rt(r,u=>{const{closeModal:p}=u;return t.jsx(Un,{gizmoId:n.gizmo.id,onError:void 0,onSuccess:()=>h(p),onClose:()=>{p()}})})},e[1]=r,e[2]=n,e[3]=a,e[4]=o,e[5]=l):l=e[5];let m;e[6]!==d.deleteProjectDropdownButton?(m=t.jsx(v,{...d.deleteProjectDropdownButton}),e[6]=d.deleteProjectDropdownButton,e[7]=m):m=e[7];let f;return e[8]!==l||e[9]!==m?(f=t.jsx(t.Fragment,{children:t.jsx(Oe,{triggerButton:c,contentAlign:"start",sideOffset:-4,alignOffset:-16,size:"auto",children:t.jsx(b.Item,{color:"danger",onClick:l,icon:Nt,children:m})})}),e[8]=l,e[9]=m,e[10]=f):f=e[10],f};function ji(){return Is.prefetch()}function vi(s){const e=$(),{name:n}=se(),a=n?ne:ae,r=Je(),o=me(),i=so(o).checkGate("3728943795")&&!s.inSidebarFlyout,d=Se(),[c,l]=_.useState(!1),{snorlaxes:m,hasNextPage:f,fetchNextPage:x,isLoading:h,isFetchingNextPage:u,isError:p}=ms(),g=(s.inSidebarFlyout?m.slice(Ln):m).filter(({gizmo:C})=>C.gizmo.id!==s.currentGizmoId),S=g.length===0,y=_.useRef(null),w=_.useCallback(C=>{h||C==null||(y.current?.disconnect(),y.current=new IntersectionObserver(N=>{N[0].isIntersecting&&f&&x()}),y.current.observe(C))},[h,f,x]);return _.useEffect(()=>()=>{y.current?.disconnect()},[]),t.jsxs("div",{ref:S&&!p?w:void 0,children:[S&&h&&t.jsxs(no,{children:[t.jsx(b.Shimmer,{}),t.jsx(b.Shimmer,{})]}),S&&p&&t.jsxs("div",{className:"text-token-text-tertiary p-3 text-center italic",children:[e.formatMessage(a.unableToLoadHistory),!c&&t.jsx("div",{className:"mt-1",children:t.jsx(je,{as:"button",color:"primary",size:"small",className:"m-auto mt-2",onClick:()=>{l(!0),Bn(r)},children:e.formatMessage(a.retryLoadingHistory)})})]}),i&&t.jsx(t.Fragment,{children:t.jsx(b.Item,{icon:as,label:t.jsx(v,{...a.newProjectHeaderButton}),onSelect:()=>{rt(o,({closeModal:C})=>t.jsx(wt,{onClose:()=>C(),onSuccess:async N=>{N&&(await s.onUpdateConversationGizmo(N),d(`/g/${N}/project`))}}))}})}),!h&&!S&&g.map(({gizmo:C},N)=>{const k=N===g.length-1?w:void 0;return t.jsxs(t.Fragment,{children:[i&&N===0&&t.jsx(b.Separator,{}),t.jsx(b.LinkItem,{to:C!=null?Ge(o,C):"/",icon:t.jsx(Ut,{color:C.gizmo.display.theme}),label:C.gizmo.display.name,onClick:()=>{s.inSidebarFlyout||s.onUpdateConversationGizmo(C.gizmo.id)},ref:k},C.gizmo.id)]})}),u&&t.jsxs(t.Fragment,{children:[t.jsx(b.Shimmer,{}),t.jsx(b.Shimmer,{})]})]})}const Qt=Zt.memo(vi);function Si({resource:s,grayedOut:e,className:n}){const a=s.gizmo.vanity_metrics?.num_conversations_str;return t.jsxs("div",{className:U("flex w-full grow items-center gap-4 overflow-hidden",n),children:[t.jsx(Dt,{isFirstParty:!!s.gizmo.tags?.includes(kt.FirstParty),src:s.gizmo.display.profile_picture_url??void 0,className:U("h-12 w-12 shrink-0",e&&"grayscale group-hover:grayscale-0")}),t.jsxs("div",{className:"overflow-hidden break-words text-ellipsis",children:[t.jsx("span",{className:"line-clamp-2 text-sm leading-tight font-semibold",children:s.gizmo.display.name}),t.jsx("span",{className:"line-clamp-3 text-xs",children:s.gizmo.display.description}),t.jsxs("div",{className:"text-token-text-tertiary mt-1 flex items-center gap-1 pe-1 text-xs text-ellipsis whitespace-nowrap",children:[t.jsx(pt,{gizmo:s,className:"text-xs",hideLink:!0}),a&&t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"text-[8px]",children:"â€¢"}),t.jsx(rs,{className:"h-3 w-3"}),a]})]})]})]})}const bi=ze(()=>Te(()=>Promise.resolve().then(()=>mi),void 0).then(s=>s.SnorlaxSplashScreen)),jr=({clientThreadId:s,currentModelId:e,onRequestCompletion:n,gizmoId:a})=>{const{data:r}=Mt(a),o=at(a),i=ao();return r==null?null:o?t.jsx(bi,{clientThreadId:s,gizmoId:a,currentModelId:e,onRequestCompletion:n}):t.jsx(zs,{gizmo:r,showStarterPrompts:!0,disableStarterPrompts:i})};function zs({gizmo:s,hideOwner:e=!1,children:n,className:a,avatarClassName:r,showStarterPrompts:o=!1,disableStarterPrompts:i=!1}){return s==null?null:t.jsx(t.Fragment,{children:t.jsxs("div",{className:U("text-token-text-primary flex h-full flex-col items-center justify-center","screen-arch:min-h-[calc(100dvh-var(--thread-leading-height)-var(--thread-trailing-height)-12px)]",a),children:[t.jsx(yi,{gizmo:s,avatarClassName:r}),t.jsx(Ni,{gizmo:s,hideOwner:e,showStarterPrompts:o,disableStarterPrompts:i}),n]})})}function yi({gizmo:s,avatarClassName:e}){const n=!!(s!=null&&Hn(s)&&s?.gizmo.tags?.includes(kt.FirstParty));return t.jsx("div",{className:"relative",children:t.jsx(Dt,{isFirstParty:n||!s,src:s!=null&&Ye(s)?s.profilePictureUrl:s?.gizmo.display.profile_picture_url,className:U("mb-3 h-12 w-12",e)})})}function Ci({gizmo:s,disabled:e}){const n=yo(s),a=po(),r=qn();if(n==null||n.length===0)return null;const o=n.slice(0,r?2:4);return t.jsx(wi,{starterPrompts:o,onSelectStarterPrompt:a,disabled:e})}function Ni({gizmo:s,hideOwner:e,showStarterPrompts:n,disableStarterPrompts:a}){const r=s!=null&&Ye(s)?s.name:s?.gizmo.display.name,o=s!=null&&Ye(s)?s.description:s?.gizmo.display.description;return t.jsxs("div",{className:"flex flex-col items-center gap-2",children:[t.jsx("div",{className:"text-center text-2xl font-semibold",children:r}),!e&&t.jsx("div",{className:"text-token-text-tertiary flex items-center gap-1",children:t.jsx(t.Fragment,{children:s&&Ye(s)?t.jsx(pt,{gizmo:s}):t.jsx(pt,{gizmo:s,socials:s.gizmo.author.display_socials})})}),o&&t.jsx("div",{className:"text-token-text-primary max-w-md text-center text-sm font-normal",children:o}),n&&t.jsx(Ci,{gizmo:s,disabled:a})]})}const Mi=/\s/;function wi({starterPrompts:s,onSelectStarterPrompt:e,disabled:n,cssMobileDisplayLimit:a,marginOverride:r}){let o=s.map((i,d)=>{let c=i.oneliner??i.title;c===""&&(c=i.body);const l=Mi.test(c);return t.jsxs("button",{className:U(a!==void 0&&d>=a&&"max-sm:hidden","border-token-border-default shadow-xxs enabled:hover:bg-token-main-surface-secondary relative flex w-40 flex-col gap-2 rounded-2xl border px-3 pt-3 pb-4 text-start align-top text-[15px] transition disabled:cursor-not-allowed"),disabled:n,onClick:m=>e(m,i,s,d),children:[t.jsx($n,{category:i.category}),t.jsx("div",{className:U("line-clamp-3 max-w-full text-balance text-gray-600 dark:text-gray-500",l?"break-word":"break-all"),children:c})]},i.id??d)});if(o.length>2){const i=Math.floor(o.length/2);o=[o.slice(0,i),o.slice(i)].map((d,c)=>t.jsx("div",{className:"flex max-w-3xl flex-wrap items-stretch justify-center gap-4",children:d},c))}return t.jsx("div",{className:U("mx-3 flex max-w-3xl flex-wrap items-stretch justify-center gap-4",r??"mt-12"),children:o})}const _i=ze(()=>Te(()=>import("./lclantcr99684npn.js"),__vite__mapDeps([6,1,7,3,4,8])).then(s=>s.GizmoKeepInSidebarMenuItem)),ki=4,ct=Pe.div`font-bold mt-6`,Ii=s=>et({queryFn:async()=>ot.getAbout(s),queryKey:["gizmo","about",{gizmoId:s}]}),zi=s=>et({queryFn:async()=>ot.getCreatorSlice({creatorId:s}),queryKey:["gizmo","creator",{creatorId:s}],enabled:s!=null}),Ti=s=>{switch(s.type){case be.BROWSER:return{title:ge.browsing};case be.PYTHON:return{title:ge.dataAnalysis};case be.DALLE:return{title:ge.dalle};case be.IMAGE_GEN:return{title:ge.imageGen};case be.MEMORY:return{title:ge.memory,description:ge.memoryDescription};case be.JIT_PLUGIN:return{title:ge.actions,description:ge.actionsDescription};default:return null}},Pi=({tools:s})=>{const e=Ft(),n=e?.includes(De.SearchTool)&&!e?.includes(De.SearchToolHoldout),a=Vn(s??[],o=>o.type);var r=oo(a.map(Ti).filter(o=>o!=null)??[]);return r.length===0?null:(n&&(r=r.map(o=>o.title===ge.browsing?{title:ge.search}:o)),t.jsxs("div",{className:"flex flex-col",children:[t.jsx(ct,{className:"mb-2",children:t.jsx(v,{id:"gizmo.about.capabilitiesHeader",defaultMessage:"Capabilities"})}),r.map(o=>t.jsxs("div",{className:"flex flex-row items-start gap-2 py-1 text-sm",children:[t.jsx(Wn,{className:"icon-sm mt-0.5 text-green-600"}),t.jsxs("div",{children:[t.jsx(v,{...o.title}),o.description!=null&&t.jsx("div",{className:"text-token-text-tertiary text-xs",children:t.jsx(v,{...o.description})})]})]},o.title.id))]}))},$e=Pe.div`flex flex-col justify-center items-center gap-2 border-s border-token-border-heavy first:border-0 w-48 mt-4 px-2`,Ve=Pe.div`flex flex-row items-center gap-1.5 pt-1 text-xl font-semibold text-center leading-none`,We=Pe.div`text-xs text-token-text-tertiary`,Fi=({gizmoResource:s})=>t.jsxs(Oe,{contentAlign:"end",sideOffset:4,triggerButton:t.jsx(je,{color:"ghost",icon:It}),children:[t.jsx(_i,{gizmoResource:s,location:"about_modal"}),t.jsx(fs,{gizmoResource:s})]}),Gi=({aboutBlock:s})=>{switch(s.type){case"generic_title_subtitle":return t.jsxs($e,{children:[t.jsx(Ve,{children:s.title}),t.jsx(We,{children:s.subtitle})]});case"rating":return t.jsxs($e,{children:[t.jsxs(Ve,{children:[t.jsx(xs,{className:"icon-sm"}),s.avg]}),t.jsx(We,{children:s.count_str})]});case"category":return s.category_ranking!=null?t.jsxs($e,{children:[t.jsx(Ve,{children:t.jsx(v,{id:"gizmo.about.trendingRank",defaultMessage:"#{rank}",values:{rank:s.category_ranking}})}),t.jsx(We,{children:t.jsx(v,{id:"gizmo.about.inCategory",defaultMessage:"in {category} {locale}",values:{category:s.category_str,locale:s.category_locale_str??""}})})]}):t.jsxs($e,{children:[t.jsx(Ve,{children:s.category_str}),t.jsx(We,{children:t.jsx(v,{id:"gizmo.about.category",defaultMessage:"Category"})})]})}},Ei=({blocks:s})=>t.jsx("div",{className:"flex justify-center",children:s.map(e=>t.jsx(Gi,{aboutBlock:e},e.type))}),Di=({href:s,onClick:e,children:n})=>t.jsx(es.div,{whileTap:{scale:.98},className:"flex",children:t.jsxs(Jt,{to:s,reloadDocument:!0,onClick:e,className:U("group border-token-border-medium bg-token-main-surface-primary hover:bg-token-main-surface-secondary relative ms-2 h-14 min-w-full grow rounded-xl border px-4 focus:outline-hidden"),children:[t.jsx("div",{className:"flex h-full items-center",children:t.jsx("div",{className:"line-clamp-2 text-sm break-all",children:n})}),t.jsx("div",{className:"border-token-border-medium bg-token-main-surface-primary group-hover:bg-token-main-surface-secondary absolute -start-2 -bottom-px h-3 w-4 border-b",children:t.jsx("div",{className:"border-token-border-medium bg-token-main-surface-primary h-3 w-2 rounded-ee-full border-e border-b"})}),t.jsx("div",{className:"absolute end-2 top-0 bottom-0 hidden items-center group-hover:flex",children:t.jsx("div",{className:"bg-token-main-surface-primary flex h-8 w-8 items-center justify-center rounded-lg",children:t.jsx(st,{className:"icon-md text-token-text-primary"})})})]})}),Ai=({gizmo:s,onClose:e})=>{const n=Ee("1825130190").value,a=s.gizmo.display.prompt_starters?.slice(0,ki);return a==null||a.length===0||!n?null:t.jsxs("div",{className:"flex flex-col",children:[t.jsx(ct,{children:t.jsx(v,{id:"gizmo.about.conversationStartersHeader",defaultMessage:"Conversation Starters"})}),t.jsx("div",{className:"mt-4 grid grid-cols-2 gap-x-1.5 gap-y-2",children:a.map((r,o)=>t.jsx(Oi,{gizmo:s,prompt:r,onClick:e},o))})]})};function Oi({gizmo:s,prompt:e,onClick:n}){const a=me(),r=Kn(a,s,e);return t.jsx(Di,{href:r?.toString()??"#",onClick:n,children:e})}const Ri=({reviewStats:s})=>Ee("1825130190").value?t.jsxs("div",{className:"flex flex-col",children:[t.jsx("div",{className:"mb-2",children:t.jsx(ct,{children:t.jsx(v,{id:"gizmo.about.ratingsHeader",defaultMessage:"Ratings"})})}),s!=null?[5,4,3,2,1].map(n=>t.jsxs("div",{className:"flex flex-row items-center gap-2 py-1 text-xl font-semibold",children:[t.jsxs("div",{className:"icon-lg relative",children:[t.jsx(xs,{className:"icon-lg text-green-500"}),t.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-[11px] text-white",children:n})]}),t.jsx("div",{className:"h-2.5 grow overflow-hidden rounded-full bg-gray-100 dark:bg-gray-700",children:t.jsx("div",{className:"h-full bg-green-500",style:{width:`${(s?.by_rating[n-1]??0)*100}%`}})})]},n)):t.jsx("div",{className:"text-token-text-tertiary text-sm",children:t.jsx(v,{id:"gizmo.about.ratings.notEnoughRatings",defaultMessage:"Not enough ratings yet"})})]}):null,Ui=({gizmoId:s,creatorId:e})=>{const n=us(pe.GPTDetails),a=()=>de.closeModal(pe.GPTDetails);return n?t.jsx(Li,{gizmoId:s,creatorId:e,onClose:a}):null},Li=({gizmoId:s,creatorId:e,onClose:n,children:a})=>{const r=Mt(s),o=Ii(s),i=zi(e);return _.useEffect(()=>{Q.logEvent("Detail Show Modal",{gizmo_id:s})},[s]),t.jsx(Ue,{testId:"modal-gizmo-about",isOpen:!0,onClose:n,type:"success",hideSeparator:!0,showCloseButton:!0,noPadding:!0,className:"flex h-[calc(100vh-25rem)] min-h-[40vh] max-w-xl flex-col",children:t.jsx(Bi,{aboutQuery:o,gizmoQuery:r,creatorSliceQuery:i,onClose:n,children:a})})},Bi=({aboutQuery:s,gizmoQuery:e,creatorSliceQuery:n,children:a,onClose:r})=>{const o=$();if(s.isLoading||e.isLoading||n.isLoading)return t.jsx("div",{className:"flex h-40 items-center justify-center pb-10",children:t.jsx(Cs,{})});const i=s.data?.gizmo,d=n?.data,c=e?.data;if(!i||s.error||e.error||n.error||s.data==null||e.data==null||n.data==null||!c){const l=Tt(s.error??e.error??n.error)??o.formatMessage({id:"I3v3Oj",defaultMessage:"An error occurred loading this GPT."});return t.jsx("div",{className:"relative flex flex-col gap-2 overflow-hidden px-2 py-4",children:t.jsx("div",{className:"flex flex-col p-4 text-red-500",children:l})})}return t.jsx("div",{className:"flex h-full px-2 py-4",children:t.jsxs("div",{className:"relative flex grow flex-col gap-4 overflow-y-auto px-8 pt-16 pb-20",children:[t.jsx("div",{className:"absolute top-0",children:t.jsxs("div",{className:"from-token-main-surface-primary fixed start-4 end-4 z-10 flex items-center justify-end bg-linear-to-b to-transparent pb-2",children:[c&&t.jsx(Fi,{gizmoResource:c}),t.jsx(ys,{onClick:r})]})}),t.jsx("div",{className:"absolute bottom-[64px]",children:t.jsx("div",{className:"from-token-main-surface-primary fixed start-4 end-4 z-10 flex min-h-[64px] items-end bg-linear-to-t to-transparent px-2",children:a})}),t.jsx(zs,{gizmo:c,className:"h-fit!",avatarClassName:"h-20! w-20!"}),t.jsx(Ei,{blocks:s.data.about_blocks}),t.jsx(Ai,{gizmo:c,onClose:r}),t.jsx(Pi,{tools:c.tools}),t.jsx(Ri,{reviewStats:s.data.review_stats}),d&&t.jsx(Hi,{gizmos:d.items})]})})};function Hi({gizmos:s}){const e=me();return s.length===0?null:t.jsxs("div",{className:"flex flex-col",children:[t.jsx("div",{className:"mb-2",children:t.jsx(ct,{children:t.jsx(v,{id:"gizmo.about.moreByHeader",defaultMessage:"More by {creatorName}",values:{creatorName:s[0].gizmo.author.display_name}})})}),t.jsx("div",{className:U("no-scrollbar group flex min-h-[104px] items-center space-x-2 overflow-x-auto overflow-y-hidden"),children:s?.map(n=>t.jsx("a",{onClick:()=>{Q.logEvent("Detail Click Gizmo",{gizmo_id:n.gizmo.id})},href:Ge(e,n),className:"bg-token-main-surface-secondary h-fit min-w-fit rounded-xl px-1 py-4 md:px-3 md:py-4 lg:px-3",children:t.jsx(Si,{resource:n})},n.gizmo.id))})]})}const vr=s=>t.jsx("div",{className:"flex grow flex-col items-center",children:t.jsxs(je,{color:"primary",className:"h-12 w-full",icon:st,...s,children:[t.jsx(v,{id:"gizmo.about.startChat",defaultMessage:"Start Chat"}),s.children]})}),ge=Ct({browsing:{id:"gizmo.about.tools.browsing",defaultMessage:"Browsing"},search:{id:"gizmo.about.tools.search",defaultMessage:"Web Search"},dataAnalysis:{id:"gizmo.about.tools.dataAnalysis",defaultMessage:"Code Interpreter & Data Analysis"},dalle:{id:"gizmo.about.tools.dalle",defaultMessage:"DALLÂ·E Images"},imageGen:{id:"gizmo.about.tools.imageGen",defaultMessage:"4o Image Generation"},memory:{id:"gizmo.about.tools.memory",defaultMessage:"Memory"},actions:{id:"gizmo.about.tools.actions",defaultMessage:"Actions"},actionsDescription:{id:"gizmo.about.tools.actionsDescription",defaultMessage:"Retrieves or takes actions outside of ChatGPT"},memoryDescription:{id:"gizmo.about.tools.memoryDescription",defaultMessage:"Learns from previous chats to improve future conversations"}});function qi(s,e){const{data:n}=bs(),r=Yn(s).id,{modelLabel:o}=Mo(r,n),i=Xn(),d=wo(s,i,void 0,e);return{modelLabel:o,dropdownSections:d}}function $i({show:s,clientThreadId:e,gizmoHasCustomActions:n}){const{modelLabel:a,dropdownSections:r}=qi(e,n);return s?t.jsxs(b.Sub,{onOpenChange:o=>{o&&Q.logEvent("GPTs: Breadcrumb Picker Model Picker Open")},children:[t.jsx(b.SubMenuTrigger,{children:t.jsxs("div",{className:"flex w-full items-center justify-between gap-1",children:[t.jsx(v,{id:"ilkdMh",defaultMessage:"Model"}),t.jsx("span",{className:"text-token-text-secondary text-xs font-medium",children:a})]})}),t.jsx(b.Portal,{children:t.jsx(b.SubContent,{onClick:()=>{Q.logEvent("GPTs: Breadcrumb Picker Model Picker Select")},children:t.jsx(No,{sections:r})})})]}):null}const Vi=ze(()=>Te(()=>import("./lclantcr99684npn.js"),__vite__mapDeps([6,1,7,3,4,8])).then(s=>s.GizmoKeepInSidebarMenuItem));function Wi({children:s,clientThreadId:e,gizmoResource:n,showReportModal:a,inMobileHeader:r,showGizmoModelPicker:o}){return t.jsxs(t.Fragment,{children:[t.jsx(Oe,{contentAlign:r?"center":"start",size:"small",triggerButton:s,children:t.jsx(Ts,{clientThreadId:e,gizmoResource:n,showReportModal:a,showGizmoModelPicker:o})}),t.jsx(Ki,{gizmoResource:n})]})}function Ki({gizmoResource:s}){const e=us(pe.GPTRemoveThirdParty),n=zt(),a=gs(s);return t.jsxs(t.Fragment,{children:[t.jsx(Ui,{gizmoId:s.gizmo.id,creatorId:s.gizmo.author.user_id}),t.jsx(la,{gizmo:s}),a&&t.jsx(ca,{gizmo:s}),a&&t.jsx(da,{gizmo:s}),t.jsx(ma,{gpt:s,isOpen:e,onClose:()=>de.closeModal(pe.GPTRemoveThirdParty),account:n})]})}function Ts({clientThreadId:s,gizmoResource:e,showReportModal:n,showGizmoModelPicker:a}){const r=ke(e),o=Qn(e),i=Zn(e.gizmo.id),d=Ft(),c=Jn(e),l=e.gizmo.share_recipient===Qe.Marketplace||e.gizmo.share_recipient===Qe.Link,m=!c&&l,f=Ee("1825130190").value,x=Ee("3645668434").value,h=f&&!c&&gs(e),u=d?.includes(De.GizmoSupportEmails)&&!c&&e.gizmo.author.will_receive_support_emails&&h,p=io(),j=Pt(s),g=hs(De.WorkspaceShareLinks),{isUnauthenticated:S}=lt(),y=g&&j&&!S,w=Se();return t.jsxs(t.Fragment,{children:[t.jsx($i,{show:a,clientThreadId:s,gizmoHasCustomActions:ea(e.tools)}),t.jsx(b.Item,{onClick:()=>{Q.logNewChatButtonClicked({location:"Gizmo information dropdown",gizmo_id:e.gizmo.id}),js(w,`/g/${e.gizmo.short_url}`)},icon:ps,children:t.jsx(v,{...oe.newChat})}),t.jsx(b.Item,{onClick:()=>de.openModal(pe.GPTDetails),icon:ta,children:t.jsx(v,{...oe.about})}),e.tools?.find(C=>C.type===be.JIT_PLUGIN)&&t.jsx(b.Item,{onClick:()=>de.openModal(pe.GPTPrivacySettings),icon:sa,children:t.jsx(v,{...oe.privacySettings})}),r&&t.jsx(b.Item,{onClick:()=>{w(i)},icon:vs,children:t.jsx(v,{...oe.customize})}),!r&&o&&x&&t.jsxs(t.Fragment,{children:[t.jsx(b.Item,{onClick:async()=>{w(`/g/${e.gizmo.id}/view`)},icon:na,children:t.jsx(v,{id:"GizmoInformation.viewGizmoLabel",defaultMessage:"View configuration"})}),t.jsx(b.Item,{onClick:async()=>{const C=await ot.copyGizmo({gizmoId:e.gizmo.id});C.gizmo.id&&w(`/gpts/editor/${C.gizmo.id}`)},icon:aa,children:t.jsx(v,{id:"GizmoInformation.copyGizmoLabel",defaultMessage:"Duplicate GPT"})})]}),t.jsx(Vi,{gizmoResource:e,location:"conversation_page"}),t.jsx(fs,{gizmoResource:e}),u&&t.jsx(b.Item,{onClick:()=>de.openModal(pe.GPTFeedbackEmail),icon:st,children:t.jsx(v,{...oe.feedbackEmail})}),h&&t.jsx(b.Item,{onClick:()=>de.openModal(pe.GPTReview),icon:oa,children:t.jsx(v,{...oe.reviewGPT})}),m&&t.jsx(b.Item,{onClick:n,icon:ia,children:t.jsx(v,{...oe.report})}),y&&t.jsx(b.Item,{onClick:()=>de.openSharingModal(j),icon:Ze,children:t.jsx(v,{...oe.shareChat})}),p&&t.jsxs(t.Fragment,{children:[t.jsx(b.Separator,{}),t.jsx(b.Item,{color:"danger",onClick:()=>de.openModal(pe.GPTRemoveThirdParty),icon:ro,children:t.jsx(v,{defaultMessage:"Remove GPT from workspace",id:"GizmoInformation.removeGPT"})})]}),d?.includes("debug")&&t.jsxs(t.Fragment,{children:[t.jsx(b.Separator,{}),t.jsx(b.Item,{onClick:()=>{w(ra(e))},children:"(Internal) See share page"})]})]})}const Yi=({conversation:s,inMainScreen:e=!1,isActiveConversation:n,inChatWindow:a=!1})=>{const r=me(),o=s.id,i=s.gizmo_id,d=at(i),c=St(r,"16480203"),l=lo(o),m=hs(De.WorkspaceShareLinks),{isUnauthenticated:f}=lt(),x=m&&l&&!f&&(!d||c),h=ua(),{name:u}=se(),p=u?ne:ae,[j,g]=_.useState(!!s.is_do_not_remember),S=$();let y=null;const{snorlaxes:w}=ms();y=w;let C=null;d&&y&&(C=y.find(({gizmo:z})=>z.gizmo.id===i)?.gizmo);const N=ns(),k=Je(),{eligible:M,markAsViewed:P}=fa(xa.ArchiveConversationOnboarding),I=Re(),G=Se(),B=async()=>{await Gt.safePatch("/conversation/{conversation_id}",{parameters:{path:{conversation_id:s.id}},requestBody:{is_archived:!0}}),ja(k,s.gizmo_id),co.logEvent("chatgpt_conversation_archived"),Q.logEvent("Conversation Archived"),M&&(I.info(S.formatMessage({defaultMessage:"You can view archived chats in Settings",id:"HistoryGizmoItem.archiveChatOnboarding"}),{duration:10,hasCloseButton:!0}),P()),n&&js(G)};return t.jsxs(t.Fragment,{children:[x&&!a&&t.jsx(b.Item,{onClick:()=>de.openSharingModal(l,"History Item Menu"),icon:Ze,"data-testid":"share-chat-menu-item",children:t.jsx(v,{...oe.shareChat})}),!1,!a&&t.jsx(b.Item,{disabled:!l,onClick:()=>{setTimeout(()=>{l&&Ns.publish({kind:e?"editTitleInMainScreen":"editTitle",serverThreadId:l})},100)},icon:tt,children:t.jsx(v,{...oe.renameChat})}),h&&y&&y?.length>0&&ga(i)&&l&&t.jsxs(t.Fragment,{children:[d&&t.jsxs(t.Fragment,{children:[y.length>1&&t.jsxs(b.Sub,{children:[t.jsx(b.SubMenuTrigger,{icon:ht,children:t.jsx(v,{...p.moveConversationToSnorlax})}),t.jsx(b.Portal,{children:t.jsx(b.SubContent,{children:t.jsx(Qt,{inSidebarFlyout:!1,onUpdateConversationGizmo:z=>N({newGizmoId:z,conversation:s,previousGizmoId:i}),currentGizmoId:i})})})]}),t.jsx(b.Item,{onClick:()=>{N({newGizmoId:null,conversation:s,previousGizmoId:i})},icon:ha,children:t.jsx("div",{className:"overflow-hidden text-ellipsis whitespace-nowrap",children:t.jsx(v,{...p.removeConversationFromSnorlax,values:{projectName:C?.gizmo.display.name??"project"}})})})]}),!d&&t.jsxs(b.Sub,{children:[t.jsx(b.SubMenuTrigger,{icon:ht,children:S.formatMessage(p.addConversationToSnorlax)}),t.jsx(b.Portal,{children:t.jsx(b.SubContent,{children:t.jsx(Qt,{inSidebarFlyout:!1,onUpdateConversationGizmo:z=>N({newGizmoId:z,conversation:s,previousGizmoId:i})})})})]})]}),t.jsx(b.Separator,{}),t.jsx(b.Item,{disabled:!l,onClick:()=>{l&&B()},icon:pa,children:t.jsx(v,{...oe.archiveChat})}),!1,t.jsx(b.Item,{color:"danger",disabled:!l,onClick:()=>{l&&rt(r,va,{serverThreadId:l,isActiveConversation:n})},icon:Nt,"data-testid":"delete-chat-menu-item",children:t.jsx(v,{...oe.deleteChat})})]})},Ps=({conversation:s,children:e,onOpenChange:n,inMainScreen:a=!1,isActiveConversation:r,inChatWindow:o=!1,...i})=>{const[d,c]=_.useState(!1);return t.jsx(Oe,{...i,open:d,onOpenChange:l=>{c(l),n?.(l)},side:"bottom",contentAlign:o?"end":"start",alignOffset:o?0:-16,sideOffset:o?0:-5,triggerButton:e,size:"auto",children:d&&t.jsx(Yi,{conversation:s,inMainScreen:a,isActiveConversation:r,inChatWindow:o})})},oe=Ct({newChat:{defaultMessage:"New chat",id:"GizmoInformation.newChat"},about:{defaultMessage:"About",id:"GizmoInformation.about"},privacySettings:{defaultMessage:"Privacy settings",id:"GizmoInformation.privacySettings"},viewDetails:{defaultMessage:"View details",id:"GizmoInformation.viewDetails"},share:{defaultMessage:"Share",id:"GizmoInformation.share"},favorite:{defaultMessage:"Favorite",id:"GizmoInformation.favorite"},customize:{defaultMessage:"Edit GPT",id:"GizmoInformation.customize"},feedbackEmail:{defaultMessage:"Send feedback",id:"GizmoInformation.feedbackEmail"},reviewGPT:{defaultMessage:"Review GPT",id:"GizmoInformation.reviewGPT"},report:{defaultMessage:"Report",id:"GizmoInformation.report"},privacy:{defaultMessage:"Privacy",id:"GizmoInformation.privacy"},deleteChat:{defaultMessage:"Delete",id:"GizmoInformation.deleteChat.0"},debugChat:{defaultMessage:"(Internal) Debug",id:"GizmoInformation.debugChat"},renameChat:{defaultMessage:"Rename",id:"GizmoInformation.renameChat"},archiveChat:{defaultMessage:"Archive",id:"GizmoInformation.archiveChat.0"},shareChat:{defaultMessage:"Share",id:"GizmoInformation.shareChat"},shareChatLong:{defaultMessage:"Share chat",id:"GizmoInformation.shareChatLong"}}),Sr=Object.freeze(Object.defineProperty({__proto__:null,GizmoConversationOptionsDropdown:Ps,GizmoInformationDropdown:Wi,GizmoInformationDropdownItems:Ts},Symbol.toStringTag,{value:"Module"})),Le=mo(uo(()=>({feedItems:[],hasUnreadNotifications:!1,isModalOpen:!1}))),Xi=Le.getState,ut=Le.setState,Qi={getHasUnreadNotifications:(s=Xi())=>s.hasUnreadNotifications},_e={setIsModalOpen:s=>{ut({isModalOpen:s})},setHasUnreadNotifications:s=>{ut({hasUnreadNotifications:s})},bulkLoadFeedItems:s=>{ut(e=>{e.feedItems=s})}};function Zi(){const s=Lt(),e=Le(Qi.getHasUnreadNotifications);return s&&e}function Fs(s,e,n,a){const r=Zi(),o=Sa();return r||a&&o?s:e}function Lt(){const{layer:s}=Et("3606233934",{shouldLogExposure:!1});return s.get("enable_notifications_feed")}function br(){const s=Lt(),e=Le(n=>n.isModalOpen);return s&&e}function Ji(){const s=Lt(),e=et({queryKey:["fetch-notifications-feed"],queryFn:async()=>{const n=await Gt.safeGet("/notifications/feed");return _e.bulkLoadFeedItems(n.items),_e.setHasUnreadNotifications(n.has_unreads),n.items},enabled:s});return{isLoading:e.isLoading,isFetching:e.isFetching}}function yr(){const s=$(),e=Fs(ka,_a,!0,!1),n=s.formatMessage({id:"1UHY6w",defaultMessage:"Notifications"});return Ji(),t.jsx(Ie,{label:n,className:"group",children:t.jsx(it,{icon:e,onClick:()=>_e.setIsModalOpen(!0),"aria-label":n})})}function er({item:s,closeModal:e}){const a={announcement:Ma}[s.type];let r=null;try{const l=new Date(s.created_at);r=wa({date:l})}catch{}const{clientThreadId:o}=At(),i=Va(o),d=Se(),c=l=>{if(s.action?.type==="show_conversation")e(),d(s.action.conversation_id);else if(s.action?.type==="new_conversation"){const m=s.action;m.prefilled_message&&(i({sourceEvent:l,promptMessage:xo(m.prefilled_message),requestedModelId:m.model_slug??void 0}),e())}};return t.jsxs("button",{className:"border-token-border-default flex w-full items-center justify-start gap-3 overflow-hidden border-t py-4 first-of-type:border-none",onClick:c,disabled:!s.action,children:[t.jsx("div",{className:"relative",children:a&&t.jsx(a,{className:"icon-md"})}),t.jsxs("div",{className:"flex h-5 shrink grow basis-0 items-center justify-between",children:[t.jsx("div",{className:"text-token-text-primary text-sm leading-tight font-normal",children:s.message}),t.jsx("div",{className:"flex items-center justify-start gap-1",children:t.jsx("div",{className:"text-token-text-tertiary text-sm leading-tight font-normal",children:r??""})})]})]})}function Cr(){const{feedItems:s,isModalOpen:e}=Le();_.useEffect(()=>{e&&(_e.setHasUnreadNotifications(!1),Gt.safePost("/notifications/feed/read",{authOption:fo.SendIfAvailable}))},[e]);const n=$(),a=Se(),{value:r}=Ee("3325813340"),o=new Date,i=ba(s,c=>{const l=new Date(c.created_at);if(ya(l))return"today";const m=Ca(o,l);return m<=7?"last_7_days":m<=30?"last_30_days":"more_than_30_days"}),d=c=>{switch(c){case"today":return n.formatMessage({id:"zlkA39",defaultMessage:"Today"});case"last_7_days":return n.formatMessage({id:"FW89A4",defaultMessage:"Last 7 days"});case"last_30_days":return n.formatMessage({id:"2s3h/P",defaultMessage:"Last 30 days"});case"more_than_30_days":return n.formatMessage({id:"yArZiR",defaultMessage:"More than 30 days"})}};return t.jsx(Ue,{testId:"modal-notifications-feed",isOpen:e,onClose:()=>{_e.setIsModalOpen(!1)},type:"success",size:"custom",className:"max-w-3xl",children:t.jsxs("div",{className:"flex flex-col gap-y-10",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h2",{className:"text-2xl font-bold",children:n.formatMessage({id:"kWt8Cx",defaultMessage:"Notifications"})}),r&&t.jsx(Na,{icon:t.jsx(vs,{className:"icon"}),onClick:()=>{a("/#settings/Notifications")},label:n.formatMessage({id:"mZVh0S",defaultMessage:"Notifications settings"})})]}),Object.entries(i).map(([c,l])=>t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-bold",children:d(c)}),l.map(m=>t.jsx(er,{item:m,closeModal:()=>_e.setIsModalOpen(!1)},m.id))]},c))]})})}function Nr({showShareButton:s,showProfileDropdown:e,clientThreadId:n}){const a=me(),r=Pt(n),o=$(),{layer:i}=Et("1547743984");St(a,"1288877412"),St(a,"3204157926");const[d,c,l,m]=vt(n,N=>[Kt.hasUserMessage(N),Kt.getGizmoId(N),qa(N),N?.is_do_not_remember??null]),f=go(n),{prefetchSearchPromises:x}=At(),h=x!=null,u=i.get("show_share_button_text",!1),p=o.formatMessage({id:"GizmoInformation.shareChat",defaultMessage:"Share"}),j=()=>de.openSharingModal(r),g=at(c),S=Ft();ho();const{isUnauthenticated:y}=lt(),w=vt(n,N=>N),C=_.useMemo(()=>n==null?null:{id:n,title:w?.title??"",create_time:null,update_time:null,conversation_template_id:null,async_status:w?.async_status??null,gizmo_id:c??null,snippet:null,is_do_not_remember:m},[c,n,w?.title,w?.async_status,m]);return t.jsxs(t.Fragment,{children:[bt(a)?t.jsx(Fa,{}):null,!1,bt(a)&&S?.includes("caterpillar")&&t.jsx(ko,{}),null,s&&r&&t.jsx(t.Fragment,{children:u?t.jsx(je,{onClick:j,icon:Ze,label:p,"data-testid":"share-chat-button",color:"secondary",className:"text-token-text-primary",style:{viewTransitionName:"var(--vt_share_chat_wide_button)"},children:p}):t.jsx(Ie,{label:o.formatMessage({id:"CPEfES",defaultMessage:"Share chat"}),children:t.jsx(it,{"data-testid":"share-chat-button",onClick:j,icon:Ze,style:{viewTransitionName:"var(--vt_share_chat_compact_button)"}})})}),t.jsxs("div",{className:"flex items-center",children:[!y&&!c&&f&&!h&&!d&&t.jsxs(t.Fragment,{children:[!1,t.jsx(Ga,{clientThreadId:n})]}),t.jsx(Ea,{}),r!=null&&C!=null&&!y?t.jsx(Ps,{conversation:C,inMainScreen:!0,isActiveConversation:!0,inChatWindow:!0,children:t.jsx(Da,{"aria-label":o.formatMessage({id:"9Mk/E3",defaultMessage:"Open conversation options"}),"data-testid":"conversation-options-button"})}):c&&g?t.jsx(t.Fragment,{children:t.jsx(Aa,{gizmoId:c})}):null,e&&t.jsx(tr,{})]})]})}const tr=()=>{const s=me();return Vt.markStart("LoginOrProfileMenu"),Vt.markRendered("LoginOrProfileMenu"),t.jsxs(t.Fragment,{children:[!bt(s)&&t.jsx(ar,{}),t.jsx(Ua,{})]})};function sr({onClick:s,className:e,testId:n}){const r=$().formatMessage({id:"OFyxqj",defaultMessage:"New chat"});return t.jsx(Ie,{label:r,className:U("flex",e),children:t.jsx(it,{onClick:o=>Pa(o,s),icon:ps,"aria-label":r,"data-testid":n,as:"link"})})}function Mr({clientThreadId:s,hideNewChat:e=!1}){const n=Ss(),a=Ia({clientThreadId:s,location:"Navigation actions"}),r=za();return!Ta()&&(n||r!=="none")?null:t.jsxs("div",{className:"flex items-center",children:[t.jsx(nr,{}),!e&&t.jsx(sr,{onClick:a})]})}function nr(){const s=$(),e=Ss(),{isUnauthenticated:n}=lt(),a=Fs(Ra,Oa,!0,!0);return n||e?null:t.jsx(Ie,{label:s.formatMessage({id:"cElEQV",defaultMessage:"Open sidebar"}),className:"flex",children:t.jsx(it,{"aria-label":s.formatMessage({id:"pV/Etp",defaultMessage:"Open sidebar"}),onClick:()=>{de.setSidebarOpen(!0)},icon:a})})}function ar(){const s=La(),e=Ba(),n=Ha(or.signUpCta),{layer:a}=Et("3637408529"),r=a.get("is_desktop_primary_auth_button_on_right",!1),o=()=>{s({authType:"login",callback:m=>{Q.logLogInButtonClicked({location:"Chat header",provider:m})}})},i=()=>{s({authType:"signup",callback:m=>{Q.logSignUpButtonClicked({location:"Chat header",provider:m})}})},d=t.jsx(je,{onClick:o,color:e?"primary":"secondary","data-testid":"login-button",className:U(!e&&"screen-arch:hidden md:screen-arch:flex"),children:t.jsx(v,{id:"B1SN7b",defaultMessage:"Log in"})},"login"),c=t.jsx(je,{color:e?"secondary":"primary",onClick:i,"data-testid":"signup-button",className:U(e&&"screen-arch:hidden md:screen-arch:flex"),children:t.jsx(v,{...n})},"signup"),l=e?[d,c]:[c,d];return t.jsx("div",{className:"flex items-center justify-center gap-2",children:r?l.reverse():l})}const or=Ct({signUpCta:{id:"P6cySK",defaultMessage:"Sign up"}});export{Nr as C,nr as E,Li as G,tr as L,Mr as N,Qt as S,vr as a,Cr as b,zs as c,Si as d,Fs as e,qi as f,jr as g,ar as h,pr as i,Rt as j,Lt as k,yr as l,sr as m,Sr as n,br as u};
//# sourceMappingURL=b4v20hsjdnh8a64d.js.map
