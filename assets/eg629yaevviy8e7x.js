const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/krbmwir12ubt4od1.js","assets/b8ijctzpgh0s7wpx.js","assets/citrwydz0bgriwlc.js","assets/root-gxczc0vy.css","assets/conversation-small-dfayqh3x.css","assets/buwlp1o3sxgk4t6n.js"])))=>i.map(i=>d[i]);
import{j as e,M as m,r as h,i as Ce,e as Te,R as _e}from"./b8ijctzpgh0s7wpx.js";import{cs as Ee,f3 as be,iz as ke,iA as ue,iB as Pe,iC as De,gA as we,iD as Ne,iE as oe,iF as Ae,gN as Se,eO as Le,iG as Be,iH as Fe,iI as Oe,iJ as Qe,iK as Ge,iL as Ie,iM as Ve,iN as We,iO as Ue,iP as Y,iQ as K,iR as qe,iS as ze,iT as Ye,b3 as Ke,iU as Ze,be as $e,iV as He,iW as Je,iX as Xe,iY as et,iZ as tt,i_ as Z,i$ as st,j0 as at,j1 as nt}from"./krbmwir12ubt4od1.js";import{n as H,a_ as ge,c as S,Q as me,cB as A,cC as G,m as V,aJ as fe,bX as ot,B as rt,_ as xe,aQ as re,eH as ie,cr as it,gA as lt,eW as $,j as he,k as ct,eA as dt,gB as ut,gC as gt,ak as mt,gD as ft,gE as xt,dW as ht,cI as pt,ch as Mt}from"./citrwydz0bgriwlc.js";import{c as yt}from"./ku4zsoy6w4wkp690.js";const vt=me(()=>xe(()=>import("./krbmwir12ubt4od1.js").then(t=>t.zA),__vite__mapDeps([0,1,2,3,4]))),jt=({errorState:t,nodeId:o,clientThreadId:a,isFeedbackEnabled:i,isUserTurn:s})=>{const r=H.isLastActorMessage(ge(a),o),l=t.canRetry&&r;if(s){const g=t?.flagSeverity;return e.jsxs("div",{className:"flex w-full flex-col items-end justify-between gap-2",children:[e.jsxs("div",{className:S("flex max-w-[var(--user-chat-width,70%)] flex-row-reverse items-start gap-1 text-start text-sm",g==="danger"&&"text-token-text-error",g==="warning"&&"text-orange-600",(g==="info"||!g)&&"text-token-text-secondary"),children:[e.jsx(Ee,{className:S("icon-md mt-[0.0625em] shrink-0")}),e.jsx(le,{errorState:t,clientThreadId:a,isFeedbackEnabled:i})]}),l&&e.jsx(de,{clientThreadId:a,nodeId:o,errorState:t})]})}return e.jsx(be,{type:t?.flagSeverity,className:"mb-2 w-fit self-start",primaryAction:l&&e.jsx(de,{clientThreadId:a,nodeId:o,errorState:t}),children:e.jsx("div",{className:"flex flex-row items-center justify-between gap-4",children:e.jsx(le,{errorState:t,clientThreadId:a,isFeedbackEnabled:i})})})},le=({errorState:t,clientThreadId:o,isFeedbackEnabled:a})=>{const{errCode:i,errMessage:s}=t;switch(i){case G.ContentPolicy:return e.jsx(_t,{isFeedbackEnabled:a});case G.ModelIncompatibility:return e.jsx(m,{id:"cyOWhN",defaultMessage:"Your request was flagged as potentially violating our usage policy. Please try again with a different prompt."});case G.ContentOrTos:return e.jsx(Ct,{isFeedbackEnabled:a});case G.ContentRegurgitation:return e.jsx(Tt,{});case A.ModelCapExceeded:return e.jsx(Rt,{clientThreadId:o});case A.HistoryDisabledConversationNotFound:return e.jsx(m,{id:"TextMessageDisplay.historyDisabledConversationMissing",defaultMessage:"Sorry, conversations created when Chat History is off expire after 6 hours of inactivity. Please start a new conversation to continue using ChatGPT."});case A.MissingLastCompletion:case A.InterruptionServerError:return e.jsx(m,{id:"TextMessageDisplay.somethingWentWrong",defaultMessage:"Something went wrong."});default:return s?e.jsx(vt,{rehypePlugins:[[ke,{target:"_new",rel:"noopener noreferrer"}]],className:"markdown break-words [&>:last-child]:mb-0",children:s}):null}};function Rt({clientThreadId:t}){const o=ue(r=>r.isoDate),a=Ne(o),i=V(t,r=>r?.mode),s=i&&i.kind!==fe.PrimaryAssistant;return o?e.jsx(m,{id:"TextMessageDisplay.gptUsageCapExceededExpired",defaultMessage:"You previously reached your usage cap for GPT-4, but you can now try sending your message again"}):e.jsx("span",{children:s!=null?e.jsx(m,{id:"TextMessageDisplay.gptUsageCapExceededCustomFeature",defaultMessage:"You've reached the current usage cap for GPT-4, please try again {formattedTime}. <link>Learn more</link>",values:{link:ce,formattedTime:a}}):e.jsx(m,{id:"TextMessageDisplay.gptUsageCapExceeded",defaultMessage:"You've reached the current usage cap for GPT-4. You can continue with the default model now, or try again {formattedTime}. <link>Learn more</link>",values:{link:ce,formattedTime:a}})})}const ce=t=>e.jsx("a",{href:"https://share.hsforms.com/16d0ZZVM3QZirXnCD_q7u1Q4sk30",target:"_blank",rel:"noreferrer",className:"underline hover:no-underline",children:t});function Ct({isFeedbackEnabled:t}){return e.jsxs("div",{children:[e.jsx("div",{className:t?"font-semibold":"",children:e.jsx(m,{id:"TextMessageDisplay.contentOrTosViolationNoFeedback",defaultMessage:"This content may violate our <termsLink>Terms of Use</termsLink> or <contentPolicyLink>usage policies</contentPolicyLink>.",values:{contentPolicyLink:pe,termsLink:Et}})}),e.jsx("div",{children:t&&e.jsx(m,{id:"TextMessageDisplay.contentPolicyFeedback",defaultMessage:"Did we get it wrong? Please tell us by giving this response a thumbs down."})})]})}function Tt(){return e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:e.jsx(m,{id:"kAMQnd",defaultMessage:"ChatGPT isn't designed to provide this type of content."})}),e.jsx("div",{children:e.jsx(m,{id:"fQ0JYv",defaultMessage:"Read the <modelSpecLink>Model Spec</modelSpecLink> for more on how ChatGPT handles creators' content.",values:{modelSpecLink:bt}})})]})}function _t({isFeedbackEnabled:t}){return e.jsxs("div",{children:[e.jsx("div",{className:t?"font-semibold":"",children:e.jsx(m,{id:"TextMessageDisplay.contentPolicyViolationNoFeedback",defaultMessage:"This content may violate our <contentPolicyLink>usage policies</contentPolicyLink>.",values:{contentPolicyLink:pe}})}),e.jsx("div",{children:t&&e.jsx(m,{id:"TextMessageDisplay.contentPolicyFeedback",defaultMessage:"Did we get it wrong? Please tell us by giving this response a thumbs down."})})]})}const pe=t=>e.jsx(J,{href:"https://openai.com/policies/usage-policies",children:t}),Et=t=>e.jsx(J,{href:"https://openai.com/policies/terms-of-use",children:t}),bt=t=>e.jsx(J,{href:"https://model-spec.openai.com",children:t}),J=({href:t,children:o})=>e.jsx("a",{target:"_blank",rel:"noreferrer",href:t,className:"underline hover:no-underline",children:o}),de=({clientThreadId:t,nodeId:o,errorState:a})=>{const i=yt({clientThreadId:t}),s=a?.errCode===A.ModelCapExceeded,r=ue(p=>p.isoDate),l=s&&!!r,g=V(t,p=>p?.mode),f=g&&g.kind!==fe.PrimaryAssistant,n=l&&!f,x=l&&f,j=Pe(),{data:R}=ot(),d=De(R)?.id,c=p=>{s?re.logEvent("chatgpt_regenerate_due_to_rate_limit_button_clicked",void 0,{...ie({clientThreadId:t}),useDefaultModel:n?"true":"false"}):re.logEvent("chatgpt_regenerate_due_to_error_button_clicked",void 0,{...ie({clientThreadId:t}),inlineButton:"true",errorCode:a?.errCode??""}),n?(j({modelId:d,location:"Model switcher menu item"}),i({sourceEvent:p,nodeId:o,requestedModelId:d})):i({sourceEvent:p,nodeId:o})};return e.jsx(rt,{as:"button",color:"secondary",disabled:x,onClick:c,icon:we,"data-testid":"regenerate-thread-error-button",children:n?e.jsx(m,{id:"MessageError.buttonUseDefaultModel",defaultMessage:"Use default model"}):e.jsx(m,{id:"MessageError.buttonRetryResponse",defaultMessage:"Retry"})})},kt=me(()=>xe(()=>import("./buwlp1o3sxgk4t6n.js"),__vite__mapDeps([5,1,2,3,0,4])).then(t=>t.TextMessageImageGroup));function Me({attachments:t,citations:o,contentReferences:a,className:i,clientThreadId:s,displayParts:r,isCompletionInProgress:l,hasActiveRequest:g,id:f,isActivelyStreaming:n,isUserTurn:x,isFinalUserTurn:j,turnIndex:R,isFeedbackEnabled:d,messages:c,parts:p,prevGroupedMessageType:T,prevGroupedMessages:k,size:L="medium",errorState:_}){const B=h.useRef(!1),W=c.length>1,P=p.some(y=>y!==""),E=!P&&c[0].metadata?.content_references?.length===0,F=c[0].metadata?.targeted_reply_label??c[0].metadata?.targeted_reply,O=c[0].metadata?.targeted_reply_icon;h.useEffect(()=>{const y=c[0];if(y.author.metadata?.real_author===`tool:${it.SEARCHGPT}`&&P){const u=y.metadata?.search_source;oe.logEvent("Search Tool Request Time To First Text Token",s,y.id,{search_source:u},()=>{u===lt.InstantQuery&&Ae.logEvent("Search Tool Page Load Time To First Text Token",{message_id:y.id,search_source:u})})}},[s,P,c]),h.useEffect(()=>{if(!E)switch(T){case $.Browsing:oe.logEvent("Browsing Time To First Text Token",s,c[0].id);break}},[E,c,s,T]);const D=Se(),U=he(),Q=ct(U,"3253785454").get("should_animate_user_message",!1),C=V(s,y=>{if(!Q||!j||!g||D||B.current)return!1;const u=ht(c,M=>!pt(M));return u!=null&&H.getNode(y,u.id).children.length===1?(B.current=!0,!0):!1});return e.jsxs("div",{"data-message-author-role":c[0].author.role,"data-message-id":c[0].id,dir:"auto",className:S(i,"text-message relative flex w-full flex-col items-end gap-2 text-start break-words whitespace-normal [.text-message+&]:mt-5",C&&Ve.slideUp),"data-message-model-slug":c[0].metadata?.model_slug,children:[F&&e.jsxs("div",{className:"text-token-text-tertiary mx-2 my-1 flex items-start justify-end gap-1.5 text-sm font-normal",children:[(()=>{switch(O){case"product_tag":return e.jsx(Be,{className:"icon"});default:return e.jsx(Le,{className:"icon"})}})(),e.jsx("p",{className:"line-clamp-3",children:F})]}),x&&e.jsx(Fe,{messages:c,clientThreadId:s}),x&&e.jsx(Oe,{hint:c[0]?.metadata?.retrieval_hint_file_data}),e.jsx(Qe,{messages:c,clientThreadId:s}),e.jsx(Pt,{parts:p,attachments:t,isUserTurn:x,isCompletionInProgress:l,turnIndex:R,displayParts:r,isActivelyStreaming:n,shouldHideContent:!!_?.shouldHideContent&&!d,clientThreadId:s,id:f,isEmpty:E,prevGroupedMessageType:T,prevGroupedMessages:k,flagSeverity:_?.flagSeverity,messages:c,citations:o,contentReferences:a,size:L}),_&&e.jsx(jt,{errorState:_,nodeId:f,isFeedbackEnabled:d,clientThreadId:s,isUserTurn:x}),e.jsx(Ge,{message:W?void 0:c[0]}),!x&&!n&&k&&T===$.SearchResult&&e.jsx(Ie,{messages:k})]})}function Pt({clientThreadId:t,id:o,displayParts:a,turnIndex:i,isActivelyStreaming:s,shouldHideContent:r,isEmpty:l,prevGroupedMessageType:g,prevGroupedMessages:f,messages:n,citations:x,contentReferences:j,size:R,isUserTurn:d,parts:c,attachments:p}){const T=Ce(),k=he(),L=h.useRef(!1),_=We(a),B=n[0].metadata?.serialization_metadata,W=n[0].metadata?.image_results?.length??0,P=h.useMemo(()=>({clientThreadId:t,messageId:o,turnIndex:i}),[t,o,i]),{toggleThreadSidebar:E}=dt(),F=h.useCallback((u,M)=>{E({type:"searchSources",scrollToHeader:M,clientThreadId:t,turnIndex:i,messageId:o})},[t,i,o,E]),O=e.jsx(He,{parts:c,attachments:p,isUserTurn:d,clientThreadId:t},"files-and-tables"),D=!!(p?.length||a.some(u=>u.type==="images")),U=Ue();function Q(u,M,v){const w=g===$.CodeInterpreter?f:void 0,{text:X,contentReferences:ee}=qe(M,x,j);let te=ee;U&&(te=ee.filter(b=>b.type!=="attribution"));const se=ut(X,te,s?void 0:w,!1,s);let{processedText:N}=se;const{displayedContentReferences:ae}=se;N.includes(gt)&&!L.current&&!s&&(L.current=!0,mt.addError(new Error("Failed replaceTextWithDirectives"),{text:N,displayedContentReferences:ae}));const q=n[0],ne=q.metadata?.message_locale,ye=n.find(b=>b.id===o),ve=ze(ye),je=Ye(k)?"streaming-animation block-entry-animation":"streaming-animation",Re=N?je:"result-thinking";let z=e.jsx(Ke,{clientThreadId:t,componentOverrides:ve?Ze:null,messageId:o,size:R,isActivelyStreaming:s,className:S(s&&Re),isDeepResearchResultMessage:q.metadata?.is_async_task_result_message,children:N===""?"&#8203;":N});if(ne!=null){const b=ft(ne);b!=null&&(z=e.jsx(xt,{locale:b,children:z}))}return e.jsx($e.Provider,{value:{analyticsMetadata:P,message:q,contentReferences:ae,onShowSearchResults:F,numImageResults:W,isActivelyStreaming:s,useSafeUrls:!0,clientThreadId:t},children:z},u)}const C=a.map((u,M)=>{if(u.type==="transcription"){const v=r?null:u.text;let w=null;if(d&&r)w=e.jsx("span",{className:"italic opacity-30",children:e.jsx(m,{...I.contentRemoved})});else if(d&&v!=null)w=v.trim().length===0?e.jsx("span",{className:"italic opacity-30",children:e.jsx(Y,{text:T.formatMessage(I.transcriptUnavailable),customSymbolOffsets:void 0})}):e.jsx("span",{className:"italic opacity-65",children:e.jsx(Y,{text:`“${v.trim()}”`,customSymbolOffsets:void 0})});else if(!d&&v!=null)return Q(M,v);return e.jsx(K,{containsImagesOrAttachments:D,isUserTurn:d,children:w},M)}else if(u.type==="text"){const v=r?null:u.text;return!l&&!r&&!d?Q(M,_):l&&s&&!d?e.jsx("div",{className:"result-streaming",children:e.jsx("span",{children:e.jsx("pre",{})})},M):e.jsx(K,{containsImagesOrAttachments:D,isUserTurn:d,children:d&&r?e.jsx("span",{className:"italic opacity-30",children:e.jsx(m,{...I.contentRemoved})}):v?e.jsx(Y,{text:v,customSymbolOffsets:B?.custom_symbol_offsets}):null},M)}else if(u.type==="images"){const v=n[0].metadata?.attachments??[];return e.jsx(kt,{assets:u.imageAssets,attachments:v,isUserTurn:d,clientThreadId:t},M)}else return null}),y=a.findIndex(u=>u.type==="text");if(y!==-1?C.splice(y,0,O):C.push(O),r&&d)C.length=0,C.push(e.jsx(K,{containsImagesOrAttachments:D,isUserTurn:d,children:e.jsx("span",{className:"italic opacity-30",children:e.jsx(m,{...I.contentRemoved})})}));else if(r&&!d)return null;return e.jsx("div",{className:Dt(d),children:C})}function Dt(t){return S("flex w-full flex-col gap-1 empty:hidden",t&&"items-end rtl:items-start",!t&&"first:pt-[3px]")}const I=Te({contentRemoved:{id:"textMessage.contentRemoved",defaultMessage:"Content removed"},transcriptUnavailable:{id:"textMessage.transcriptUnavailable",defaultMessage:"Transcript Unavailable"}});function wt(t){const{bufferType:o,isActivelyStreaming:a,messages:i,parts:s,...r}=t,l=i[i.length-1].id,[g,f]=h.useState(Je(s)),n=h.useRef(void 0);if(n.current===void 0)switch(o){case"Adaptive":n.current=new tt(s,f,a);break;case"ChunkedCatchup":n.current=new et(s,f,a);break;case"Punctuation":n.current=new Xe(s,f,a);break}return h.useEffect(()=>{n.current!=null&&(n.current.onMessagePartsUpdated(s,a),n.current.isBuffering()&&Z.addDelayedRenderingMessage(l))},[s,l,a]),h.useEffect(()=>{n.current!=null&&n.current.removeDelayedRender()&&Z.removeDelayedRenderingMessage(l)},[g,l]),h.useEffect(()=>()=>Z.removeDelayedRenderingMessage(l),[l]),h.useEffect(()=>()=>{n.current?.destroy(),n.current=void 0},[]),e.jsx(Me,{...r,messages:i,parts:s,displayParts:g,isActivelyStreaming:a||!!n.current?.isBuffering()})}function Nt({message:t,isCompletionInProgress:o,hasActiveRequest:a,clientThreadId:i,className:s,isUserTurn:r,isFinalUserTurn:l,turnIndex:g,isFeedbackEnabled:f,prevGroupedMessageType:n,prevGroupedMessages:x}){const j=h.useMemo(()=>"parts"in t.content?t.content.parts:[Mt(t)],[t]);return e.jsx(St,{parts:j,messages:[t],hasActiveRequest:a,isCompletionInProgress:o,className:s,citations:t.metadata?.citations,contentReferences:t.metadata?.content_references,attachments:t.metadata?.attachments,isUserTurn:r,isFinalUserTurn:l,turnIndex:g,id:t.id,isFeedbackEnabled:f,clientThreadId:i,prevGroupedMessageType:n,prevGroupedMessages:x})}const Qt=_e.memo(Nt),At=()=>null;function St(t){const o=At()!=null,a=t.messages.length>1,i=H.isLastActorMessage(ge(t.clientThreadId),t.messages[0].id),s=!!V(t.clientThreadId,R=>R?.sharedConversationMetadata),r=a?void 0:st(t.messages[0],i,o,t.isCompletionInProgress||t.hasActiveRequest,s),l=r?.flagSeverity!=="danger"&&t.isCompletionInProgress,g=!t.parts.some(R=>R!==""),{bufferType:f,wordFadeType:n}=at(),[x,j]=h.useState(()=>n!=="indexed"&&f!=="none"&&!t.isUserTurn&&(t.isCompletionInProgress||g&&!r));return r&&x&&j(!1),x?e.jsx(wt,{...t,bufferType:f,isActivelyStreaming:l,errorState:r}):e.jsx(Me,{...t,displayParts:nt({isUserTurn:t.isUserTurn,parts:t.parts}),isActivelyStreaming:l,errorState:r})}export{jt as M,St as T,Qt as a,Me as b,Dt as g};
//# sourceMappingURL=eg629yaevviy8e7x.js.map
