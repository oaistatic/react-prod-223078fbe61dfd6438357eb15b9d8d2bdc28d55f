import{a as v,r as n,j as c,e as A,i as k}from"./b8ijctzpgh0s7wpx.js";import{gb as R,gc as C,gd as h,ge as x,ej as V,j as M,aS as j,dr as B,ct as E,e as m,O as I}from"./citrwydz0bgriwlc.js";import{S as T}from"./jub8x4vtu4ve8tc3.js";import{S as _}from"./eq7m7kpdgo83dcz8.js";import{go as L,dj as O,fO as U,gp as G}from"./krbmwir12ubt4od1.js";import{u as W}from"./hf1qeqo8wh44t1id.js";import"./gy64pge8qevmvg7e.js";function q({audioAssetPointer:l,conversationId:e}){const s=v(),[i,a]=n.useState(!1),t=n.useRef(!0),[o,f]=n.useState(void 0),d=n.useRef(null),u=R(),p=C(r=>r.isPlaying&&r.sourceUrl===o),b=null,g=n.useCallback(()=>{const r=h();if(r)d.current?d.current.then(()=>{r.stop(),d.current=null}):r.stop();else return},[]);n.useEffect(()=>(t.current=!0,()=>{t.current=!1}),[]),n.useEffect(()=>()=>{x().isPlaying&&g()},[g]);const P=n.useCallback(async()=>{if(!u||!t.current)return;a(!0);const{url:r}=await L.fetch(s,{asset:l,conversationId:e});a(!1),f(r),u.changeSource(r),d.current=u.play()},[l,e,u,s,b]);return{togglePlayback:n.useCallback(()=>{if(u)p?g():(V.messagePlayback.click(),P());else return},[p,P,u,g]),isPlaying:p,isLoading:i}}const Y=n.memo(function(e){const s=M(),i=j(s),a=B(e.conversationId),t=O(e.message);if(!i||!a||t)return null;const o=E.getAudioAssetPointers(e.message)[0];return o?c.jsx(w,{audioAssetPointer:o,conversationId:a}):c.jsx(F,{...e,conversationId:a})});function w({audioAssetPointer:l,conversationId:e}){const{isLoading:s,isPlaying:i,togglePlayback:a}=q({audioAssetPointer:l,conversationId:e}),t=()=>{m.logEventWithStatsig("ChatGPT Turn Action Voice Replay Clicked","chatgpt_turn_action_voice_replay"),a()};return c.jsx(S,{onClick:t,isPlaying:i,isLoading:s,playText:y.replay,playIcon:U})}function F({conversationId:l,message:e}){const{isLoading:s,isPlaying:i,togglePlayback:a}=W({conversationId:l,messageId:e.id}),t=()=>{m.logEventWithStatsig("ChatGPT Turn Action Voice Read Aloud Clicked","chatgpt_turn_action_voice_read_aloud"),a()};return c.jsx(S,{onClick:t,isPlaying:i,isLoading:s,playText:y.play,playIcon:T})}function S({onClick:l,isPlaying:e,isLoading:s,playText:i,playIcon:a}){let t,o;const f=k();return s?(t=I,o=y.loading):e?(t=_,o=y.stop):(t=a,o=i),c.jsx(G,{icon:t,label:o?f.formatMessage(o):void 0,disabled:s,onClick:l,style:e||s?{visibility:"visible"}:void 0,testId:"voice-play-turn-action-button"})}const y=A({replay:{id:"VoiceReadOutLoudButton.replay",defaultMessage:"Replay"},play:{id:"VoiceReadOutLoudButton.play",defaultMessage:"Read aloud"},stop:{id:"VoiceReadOutLoudButton.stop",defaultMessage:"Stop"},loading:{id:"VoiceReadOutLoudButton.loading",defaultMessage:"Loading"}});export{S as PlayButton,w as VoiceMessagePlaybackButton,Y as VoicePlayButton,F as VoiceReadAloudButton};
//# sourceMappingURL=o146mt4hljz23377.js.map
