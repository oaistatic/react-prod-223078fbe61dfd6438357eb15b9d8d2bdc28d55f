const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/b4v20hsjdnh8a64d.js","assets/b8ijctzpgh0s7wpx.js","assets/krbmwir12ubt4od1.js","assets/citrwydz0bgriwlc.js","assets/root-gxczc0vy.css","assets/conversation-small-dfayqh3x.css","assets/ku4zsoy6w4wkp690.js","assets/k1h56nx2kjoqc52m.js","assets/exvo283q5zxd2q6r.js","assets/jekpe1ukp5thtucq.js","assets/dcml6fn13vfm1zv2.js","assets/nvghija6qp2cunds.js","assets/djd85tifm57yisqi.js","assets/jkznwfhp8ahnvlot.js","assets/megablgldkh4lap1.js","assets/hbpbckirom363mgh.js","assets/izdon3syh095bs23.js","assets/dweroubxngal4vlb.js","assets/i7jya7stlyvnzya0.js","assets/cb2t82g498wwhuc2.js","assets/ndwtlsjk3xm27wkq.js","assets/o0ebhsapkoy5qkg1.js","assets/k7nub2yuxq70se07.js","assets/k6ccgr4wxcppeg93.js","assets/dbalwdodzoo02ru2.js","assets/cfe0bfy5asp94vp2.js","assets/c2d9eukr2hh7n3q0.js"])))=>i.map(i=>d[i]);
import{Q as V,_ as B,j as X,l as D,m as $,ew as K,bl as r,fN as Y,cc as Z,e as k,bm as C,aN as j,aQ as J,ce as W,n as ee,au as te}from"./citrwydz0bgriwlc.js";import{r as n,i as A,j as a}from"./b8ijctzpgh0s7wpx.js";import{Z as se,$ as ae,a0 as oe,a1 as ne,a2 as re,a3 as ie,a4 as le,a5 as ue,a6 as de,a7 as ce,a8 as w,a9 as me,aa as fe,ab as ge,ac as pe,ad as P,ae as ye,af as he,ag as Se,ah as Ee,ai as Ce,aj as b,ak as Re}from"./krbmwir12ubt4od1.js";import{G as Te}from"./cfe0bfy5asp94vp2.js";const z=V(()=>B(()=>import("./b4v20hsjdnh8a64d.js").then(e=>e.n),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26])).then(e=>e.GizmoConversationOptionsDropdown)),xe=new Date(2024,9,11,0);function Ie(e){J.checkGate("3922476776")||W.abortAllRequests(),k.logEvent("Load Thread",{threadId:e})}function ke({conversation:e,onOpenChange:l,testId:f,inMainScreen:t=!1,isActiveConversation:g}){const p=A(),{isUnauthenticated:y}=te();return y?null:a.jsx(z,{conversation:e,onOpenChange:l,inMainScreen:t,isActiveConversation:g,children:a.jsx("button",{className:"text-token-text-secondary hover:text-token-text-primary radix-state-open:text-token-text-secondary flex items-center justify-center transition","data-testid":f,"aria-label":p.formatMessage({id:"idEcXk",defaultMessage:"Open conversation options"}),children:a.jsx(P,{className:"icon-md"})})})}const Ae=n.memo(_e);function _e({conversation:e,className:l,hideOverflowMenu:f=!1,isActive:t,elementRef:g,testId:p}){"use forget";const y=A(),N=X(),[i,h]=n.useState(!1),{value:R}=D("3922476776"),{value:u}=D("232791851"),M=se(e.id),{value:o=null,source:S=null}=M??{},L=$(e.id,ee.getRequestId),d=K(L),U=ae(new Date,new Date(e.update_time??0))<oe(ne.Standard),T=re(e.id),q=e.update_time&&ie(new Date(e.update_time),xe),x=(o===r.STREAMING||o===r.REALTIME)&&U,G=u&&!t&&!d&&q&&o===r.UNREAD,I=u&&!t&&(d||x),O=u&&!t,v=!I&&u&&!t&&(d||x),H=le(e.id)&&!t,E=n.useRef(!1);n.useEffect(()=>{E.current||R&&(async()=>(E.current=!0,t&&o===r.UNREAD&&(S===C.SERVER&&await j.setConversationStatus(e.id),b(e.id,null)),!t&&S===C.CLIENT&&o===r.UNREAD&&(await j.setConversationStatus(e.id,o),b(e.id,{value:r.UNREAD,source:C.SERVER})),E.current=!1))()},[R,t,e.id,o,S,d]),n.useEffect(()=>Y(Te,{editTitle:({serverThreadId:s})=>{(s?s===e.id:t)&&h(!0)}}),[e.id,t]);const F=Z(()=>e.conversation_template_id==null?void 0:Re(N)().data?.gizmos.find(c=>c.resource.gizmo.id===e.conversation_template_id)?.resource),_=n.useRef(null),Q=n.useRef(null);return a.jsxs(ue,{draggable:!i&&w(e.gizmo_id),onDragStart:s=>{if(!w(e.gizmo_id))return;const c=s.currentTarget,m=_.current;m&&(m.style.display="none"),c.style.opacity="0.99",m&&requestAnimationFrame(()=>{m.style.display="",c.style.opacity="0"}),s.dataTransfer.effectAllowed="move",Ce({kind:"conversation",conversation:e,gizmoId:e.gizmo_id})},onDragEnd:s=>{s.currentTarget.style.opacity="",Ee()},ref:ce(g,Q),active:t,className:l,to:de(e.id,F),onClick:s=>{s.metaKey||s.ctrlKey||!t&&!s.defaultPrevented&&Ie(e.id)},onDoubleClick:()=>{h(!0)},trailing:!t&&!i&&(G?a.jsx(ye,{color:"blue"}):O&&T.length>0?a.jsx(he,{task:T[0]}):I?a.jsx(Se,{size:16,className:"text-token-text-primary"}):null),highlightTrailing:!f&&!i&&a.jsx(z,{conversation:e,isActiveConversation:t,onOpenChange:s=>{s&&k.logEvent("Conversation History Item Open Menu",{conversationId:e.id})},children:a.jsx(pe,{ref:_,"data-testid":`${p}-options`,"aria-label":y.formatMessage({id:"idEcXk",defaultMessage:"Open conversation options"}),icon:P})}),label:!i&&a.jsx(ge,{clientThreadId:e.id,historyConversationResponse:e,shouldShowLoadingShimmer:v}),children:[H&&a.jsx(me,{threadId:e.id}),i&&a.jsx(fe,{conversationId:e.id,historyConversationResponse:e,onClose:()=>{h(!1)}})]})}export{ke as G,Ae as H};
//# sourceMappingURL=h3krx8dg2s8o2yh5.js.map
